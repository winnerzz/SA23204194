<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Xu Tongzhou" />

<meta name="date" content="2023-12-04" />

<title>allhw</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">allhw</h1>
<h4 class="author">Xu Tongzhou</h4>
<h4 class="date">2023-12-04</h4>



<div id="directory" class="section level2">
<h2>Directory</h2>
<ol style="list-style-type: decimal">
<li><p>Homework0 <a href="#question1ans">Jump to the Answer</a></p></li>
<li><p>Homework1 <a href="#question2ans">Jump to the Answer</a></p></li>
<li><p>Homework2 <a href="#question3ans">Jump to the Answer</a></p></li>
<li><p>Homework3 <a href="#question4ans">Jump to the Answer</a></p></li>
<li><p>Homework4 <a href="#question5ans">Jump to the Answer</a></p></li>
<li><p>Homework5 <a href="#question6ans">Jump to the Answer</a></p></li>
<li><p>Homework6 <a href="#question7ans">Jump to the Answer</a></p></li>
<li><p>Homework7 <a href="#question8ans">Jump to the Answer</a></p></li>
<li><p>Homework8 <a href="#question9ans">Jump to the Answer</a></p></li>
<li><p>Homework9 <a href="#question10ans">Jump to the
Answer</a></p></li>
<li><p>Homework10 <a href="#question11ans">Jump to the
Answer</a></p></li>
</ol>
</div>
<div id="question1ans" class="section level1">
<h1>Homework0</h1>
</div>
<div id="question" class="section level1">
<h1>Question</h1>
<p>Use knitr to produce at least 3 examples. For each example, texts
should mix with figures and/or tables. Better to have mathematical
formulas.</p>
</div>
<div id="answer" class="section level1">
<h1>Answer</h1>
<div id="ex1-basic-data-summary-and-plotting" class="section level2">
<h2>EX1-basic data summary and plotting</h2>
<p>Here we use the data package ‘women’ that comes with R as an
example.</p>
<div id="data-summary" class="section level3">
<h3>Data Summary</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(women), <span class="at">caption =</span> <span class="st">&quot;First few rows of the women dataset.&quot;</span>)</span></code></pre></div>
<table>
<caption>First few rows of the women dataset.</caption>
<thead>
<tr class="header">
<th align="right">height</th>
<th align="right">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">58</td>
<td align="right">115</td>
</tr>
<tr class="even">
<td align="right">59</td>
<td align="right">117</td>
</tr>
<tr class="odd">
<td align="right">60</td>
<td align="right">120</td>
</tr>
<tr class="even">
<td align="right">61</td>
<td align="right">123</td>
</tr>
<tr class="odd">
<td align="right">62</td>
<td align="right">126</td>
</tr>
<tr class="even">
<td align="right">63</td>
<td align="right">129</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\text{{Summary Table}}
\]</span></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">summary</span>(women)</span></code></pre></div>
<pre><code>##      height         weight     
##  Min.   :58.0   Min.   :115.0  
##  1st Qu.:61.5   1st Qu.:124.5  
##  Median :65.0   Median :135.0  
##  Mean   :65.0   Mean   :136.7  
##  3rd Qu.:68.5   3rd Qu.:148.0  
##  Max.   :72.0   Max.   :164.0</code></pre>
</div>
<div id="data-plotting" class="section level3">
<h3>Data Plotting</h3>
<p><span class="math display">\[
\text{{Plotting}}
\]</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>wo_plot<span class="ot">&lt;-</span><span class="fu">ggplot</span>(women, <span class="fu">aes</span>(<span class="at">x=</span>weight, <span class="at">y=</span>height)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Scatter Plot of weight vs height&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>wo_plot<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;weight (in)&quot;</span>)<span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;height (lb)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="ex2--linear-regression-analysis" class="section level2">
<h2>EX2- Linear Regression Analysis</h2>
<p>In this example, we will use a linear regression model to estimate
weight based on height</p>
<div id="linear-model" class="section level3">
<h3>Linear Model</h3>
<p>The linear model can be represented as: <span class="math display">\[
y = \beta_0 + \beta_1 \times x + \epsilon
\]</span></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight<span class="sc">~</span> height, <span class="at">data=</span>women)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ height, data = women)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.7333 -1.1333 -0.3833  0.7417  3.1167 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -87.51667    5.93694  -14.74 1.71e-09 ***
## height        3.45000    0.09114   37.85 1.09e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.525 on 13 degrees of freedom
## Multiple R-squared:  0.991,  Adjusted R-squared:  0.9903 
## F-statistic:  1433 on 1 and 13 DF,  p-value: 1.091e-14</code></pre>
</div>
<div id="residual-plot" class="section level3">
<h3>Residual Plot</h3>
<p>To check the assumptions of linear regression, we plot the
residuals.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="ex3-descriptive-statistics" class="section level2">
<h2>EX3 Descriptive Statistics</h2>
<p>In this example, we’ll calculate and visualize descriptive statistics
like mean, median, and standard deviation for the ‘height’ column in the
<code>women</code> dataset.</p>
<div id="calculating-descriptive-statistics" class="section level3">
<h3>Calculating Descriptive Statistics</h3>
<p>The mathematical formulas for mean, median, and standard deviation
are:</p>
<p><span class="math display">\[
\text{$\mu$} = \frac{{\sum_{i=1}^{n} x_i}}{n}
\]</span> <span class="math display">\[
\text{$\sigma$} = \sqrt{\frac{{\sum_{i=1}^{n} (x_i -
\text{$\mu$})^2}}{n}}
\]</span> <span class="math display">\[
\text{{Median}} = \text{{middle value when data is sorted}}
\]</span></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>mean_height <span class="ot">&lt;-</span> <span class="fu">mean</span>(women<span class="sc">$</span>height)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>median_height <span class="ot">&lt;-</span> <span class="fu">median</span>(women<span class="sc">$</span>height)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>sd_height <span class="ot">&lt;-</span> <span class="fu">sd</span>(women<span class="sc">$</span>height)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="fu">c</span>(<span class="at">mean=</span>mean_height, <span class="at">median=</span>median_height, <span class="at">sd=</span>sd_height)</span></code></pre></div>
<pre><code>##      mean    median        sd 
## 65.000000 65.000000  4.472136</code></pre>
</div>
<div id="histogram" class="section level3">
<h3>Histogram</h3>
<p>Now we will draw the histogram.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">hist</span>(women<span class="sc">$</span>height, <span class="at">main=</span><span class="st">&quot;Histogram of height&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;height(in)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">hist</span>(women<span class="sc">$</span>weight, <span class="at">main=</span><span class="st">&quot;Histogram of Weight&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Weight (lb)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAxlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kJA6kLY6kNtmAABmADpmOgBmOjpmZmZmkJBmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2ZpC2kGa2tma225C229u22/+2/7a2///T09PbkDrbkGbbtmbbtpDb27bb29vb2//b/9vb////tmb/25D/27b//7b//9v///99kd+8AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKc0lEQVR4nO2d62LjthGFadeOtPUmTSvF6WXlZJu25jYXd8tk09a0Lb7/SxWDAUhKInXAi0QZOueHSRHAAPgMAiA5BJOC2qtk6gKcuggIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIaCRA67vk+lG3s/JHLfifH8fJp7L4YZ4kX5qdl6XN7GmeXNzb/C9rWe2WJLPROhTrKICeby/HBpQnRouiRJLrT4Nr1lCsSnVAQcU6BKAdpcnogKqK6l5qAM1sQ1oEpgss1gFb0M83SXLxuwctvC3Lp6+T5Dd/tv/S9Yckubq3RTRl/u42uXwoPt2aeJ/fazv4dJNcvCt+nptYVTalAWtSq5pL0zFZ2izMj5Uav/jysSzWZmb/sL9qxZoIUJYkrgS+JO7ItZZcanhTHb5+zDXYVNsAUt1s1qEyUANkGs3MpLh4L7+zWvKrj64ku5ltFOtYgLwcIGkFj8UvtmfQtmxqotwW9t8+e1ynntv1Q/Efk+qzRz1HpIYLSZu8c/ELh6I0UJ0qNrc8ufxRUqZKzzRHa0gB7WaW1Yo1FSBTwKufXKiWxJUn1f+e7BsQWuaVi/jr9zeJbQ9SL/1b61XqBmp9ifzOkpk0XtuATTpJkZnDCmg3M40yLSA9oj2OLYk/C6Vqfn+jrutvvQEdi/RvBahuoA7INJB3dyaSIfIvqbhJ4U9WX5LtzNT0xJ30862W8u+uJH4Eln7U79cBCdGrv/66bAVUN1AHZGL8fml+5aazn9vtJqCGzE4CkJlnvL/xXWpAC1ISL+2A2lqQ7ZP1P/BWtibFql6sU21Bevybqsdp74NsXXWE9p10A6C2PsjPgexJrX3XbKNYu5mdAiBT3z/Y88wOPFKq9lHMt6Drx+e79j6oZRTT0X9R26Yyg3pelo1nNzM1vXHZcXRAxYdyWmN7hX3zoLIP2ttJ1+dBG5UT86va1s2DTISmeVAFKJ92olj8Ij3Q5w+Fm8k+uInwXzSBOfTFw84odvU3GZ3bANUM1AHpyWO3evD5WzOQyRy+NpPeyExN+2IdA1BPpdvXkqeX2USAUnuvwl4lnHhmEwHyc5WAXnLizKY6xZ6/nrtr/RPPjLdcgQgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAioB6D8SE4Zp6FugNIkWTx9IX6SKxw5DnUClIrLqG092RE9w6ZVF0C23Ty9sT67m86PpZt9svXz0BqRRIu6AbJvsP23aG9BDtC/W9Ue1CtkcP2hOmWR+XajqFrNnS2gIvPvsLX10ecOKNAcAQFzBATMERAwR0DAHAEBcwQEzBEQMEdAwBwBAXMEBMxFCWhrYZlB5qIEVL00PNxcpICKERjFDkgRDVgNKXJA+uL5+q7/DeeYAcnr+Eom79+EIgb0shzjYVfEgMY0Fymg1K4DMmygjxlQajugl+Wg6WLEgPzT5AE9dBE1oPWdnlwZATXUSJTZh11Pc86kG2pkZVePGzjWRw1oPHMEBMzFCcivIcZOuqFGojSATJa4ZUXbxrqIAbV6tNSU2aV2ZSZ5loCg26FOlezdkDMEtL6D1xieobkoyfa74B0N0OGd8ypD7V5RXn6yXaSzU2lB7SFjwKlqVJTLV+4dxTwWv7LjWQEKUuZa2fqOgIaYixSQXSI9fV03zI4JKL+4z2T57ld1NX9EQDJEZXtmOF3MRQlIJjkC6HXdUTwiIN+C0kGvqUQMyPVBGZwuBpiLE5BOFV/ZHcWjAhrPHAEBc1ECCrkWCzUXJSCnYaP8GQAq0lf16HkCQJwoNtWoJl5qNNWo0ivz7jgiID+KDXshPmJAY5ojIGAuSkDlRHHQXDFiQO6xD6/mG2tUyP0gJTNs2ZKIAb18pTc6OFFsqlFRtSDeUWyqkSjXhYGG3TGLGZCOYwMXTooa0HjmCAiYixQQHz2310iEHz0HTLYjBhTy6Lnd62UqD7P2kLF8z7o9eoZ+eqcDqD2kJ6CwR8/ITy9iQLE9em4P6QsoskfP7SG9AY2hiAGVPr4E1AxonAV+IwY09KFz9IBic15oD+kJaBwR0JkCGm0J9qgBjTHQExABERABEdD+EAICIf0AjeHaETGg0URABERABERA+0MICIQQEAghIBBCQCCEgEAIAYGQQwKCC8GdOaDMrxXcumjweQOq3Q85lY9A9gk5HKDas49T+YxoHx0OUEALik8d+yDXhIYuXP6K1K3BjfPe5qvSyPOg+HQQQNN2wkinAKhP0PQhY0QfbHR6DATUO2SM6IONTo+BgHqHjBF9sNHpMRBQ75Axog82Oj0GAuodMkb08xMBAREQEAEBERAQAQEREBABAREQEAEBERAQAQERENCIgJ5++3FjJw9Zx8HFzXzckESaRh9izrqkyd2Dn1Vg4UTjAXpZlh/XsjuyaFyOCuHiypo8Nm5IIpfm6Y2L1iGN7s4CC2c1GqDcu1W5HfV0AOubu7h2VSdZeickkc/IO5h0SSOSf0ZQ4VRjAcqThZbY7zzNVwVavrtMJBJAAYnKNJmrXpc0hftWc0jhnEbsg8oyKCB7BsDlHKoIsoJjWCINT9+a3mQRmlEZnnYonOhggPQMh+e5T5TbyoYlyvW0FBeTdNElTeG/lhpYONGpANLPk3arrO52S1OPPS2gzqeYlLfj6WI7k25pdAWyUzjFAvvBrcoGJaqneXPfKY1bBfEUOunAkbQG0+yGJeqdxqeaYpgvtgEFzsXciGQavi10UCKXRqqXdktTxptgorgDqLp8CEiUJv4z5AGJBqQpz6qgwol4sQpEQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBDQtIPXW0bXj6t9P3PgQSvkj9wfXdytz0HlqVN/xPoimBaS+BOkfhVPrB0w9oIpaNivqgIr8gAs+TQvI1vHlq+/E4av0e97WDiDZ2QDkv3R+CE0LyLaa/Pp/UkHbmjL1XFUWaZJcvL+4f1n+aZ4khodfGkxcWSwgOW6b3QHXnJu4kxYvKHPCyMbuiivwfKGAxGE3TwSQOZrJdlUlsoBc7EB3zH6aGJDpPeT8cBvno3v5UVjoGZQKGHX9rk61hQMksbPKH+8gmhiQ6XhkDBJfzDfeKc6xKB35LBjzZ6MvKvsgm2bfF6oHamJApt3k1j/Rbsq3cex3ldsAac++dP6/9m+8gIp0Yd+5SGfZrNaVsAWVyj+zQ3R+dbvaGsidL3MToI0+SAawePug4umtnihz23hkFNN+eWMU84BcM6mPYvp17nhHMfuGRrWx8yCd5RR2HnT5gw5p9kjaNA9SR+Bo50FQTe9T7HyycrRvWDbodAG5waqp981mm7/jvRbbqzzxrvTb2rr2ivhq/hWIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICOj/DWoM4f/QxcAAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="boxplot" class="section level3">
<h3>boxplot</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">boxplot</span>(women<span class="sc">$</span>weight, <span class="at">main=</span><span class="st">&quot;Boxplot of Weight&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Weight (lb)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
<a href="#directory">Back to the Directory</a></p>
</div>
</div>
</div>
<div id="question2ans" class="section level1">
<h1>Homework1</h1>
</div>
<div id="question-ex3.2" class="section level1">
<h1>Question EX3.2</h1>
<p><span class="math inline">\(\text{The standard Laplace distribution
has density :} f(x) = \frac{1}{2}e^{−|x|}, x \in R. \\ \text{Use the
inverse transform method to generate a random sample of size 1000 from
this
distribution. }\\ \text{Use one of the methods shown in this chapter to
compare the
generated sample to the target distribution}\)</span></p>
</div>
<div id="answer-ex3.2" class="section level1">
<h1>Answer EX3.2</h1>
<p><span class="math display">\[
\text{To compute the Inverse transform ,we need to consider the case
:}\\
x \leq 0 ,\text{and}, x &gt; 0\\
F(x)=\int_{\infty}^{x} \frac{1}{2}e^{−|x|} dx= \frac{1}{2}e^x, x \leq
0\\
F(x)=\int_{\infty}^{x} \frac{1}{2}e^{−|x|} dx= \ 1-\frac{1}{2}e^{-x} ,
x&gt;0\\
\text{Generate u from U(0,1)}\\
\Rightarrow x=F^{-1}(u)=\left\{\begin{aligned}\log(2u) &amp;&amp;{0 \leq
u \leq 1/2}\\ \ -\log(2(1-u)&amp;&amp;{1/2 \leq u \leq
1}\\\end{aligned}\right.
\]</span></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n) <span class="co"># Generate u from U(0,1)</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,n) <span class="co"># define x with length n</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>   <span class="cf">if</span>(u[i]<span class="sc">&lt;=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="co"># deliver x when u &lt;=1/2</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>    x[i]<span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>u[i])</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>   <span class="cf">else</span> <span class="co"># deliver x when u &gt;1/2</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>    x[i]<span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u[i]))</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>} </span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>,<span class="at">main=</span> <span class="fu">expression</span>(<span class="st">&quot;1/2e^(−|x|)&quot;</span>),<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>)) <span class="co"># plot the hist of x</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>t<span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="dv">100</span>, .<span class="dv">001</span>) </span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>y<span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(t))</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="fu">lines</span>(t, y) <span class="co"># plot the line of density function 1/2*e^(-|x|)</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-ex3.7" class="section level1">
<h1>Question EX3.7</h1>
<p><span class="math inline">\(\text{Write a function to generate a
random sample of size n from the Beta(a, b)
distribution by the acceptance-rejection method.}\\ \text{Generate a
random sample
of size 1000 from the Beta(3,2) distribution.} \text{Graph the histogram
of the
sample with the theoretical Beta(3,2) density
superimposed.}\)</span></p>
</div>
<div id="answer-ex3.7" class="section level1">
<h1>Answer EX3.7</h1>
<p><span class="math inline">\(\text{Note that the shape of the beta
distribution changes when a and b take different values. }\\ \text{for
example ,when a and b both &gt; 1,we have picture below}\)</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>Prob <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x,<span class="at">shape1=</span>a,<span class="at">shape2=</span>b)</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="fu">plot</span>(x,Prob,<span class="at">type=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
<span class="math inline">\(\text{But when a and b both &lt;1,The
situation has changed dramatically}\)</span></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>Prob <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(x2,<span class="at">shape1=</span>a2,<span class="at">shape2=</span>b2)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="fu">plot</span>(x2,Prob,<span class="at">type=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
<span class="math inline">\(\text{we will take the situation a and b
both &gt;1 as the dafault to solve the problem}\\ \text{we have the beta
distribution:}Beta(x,\alpha,\beta)=\frac{x^{\alpha-1}*(1-x)^{\beta-1}}{B(\alpha,\beta)}\\
\text{to use the aceptance-rejection method,we take g(x) as
Uniform(0,1)&#39;s denstiy
function,so}\frac{f(x)}{g(x)}=\frac{\frac{x^{\alpha-1}*(1-x)^{\beta-1}}{B(\alpha,\beta)}}{g(x)}=\frac{x^{\alpha-1}*(1-x)^{\beta-1}}{B(\alpha,\beta)}\leq
\frac{1}{B(\alpha,\beta)}\\ \text{we can take the result of the above
formula as c to generate }B(\alpha,\beta)\\ \text{for
B(3,2),}f(x)=12x^2(1-x),\text{and 1/B(3,2)=12,so take c=12}\\ \text{x
generated from Uniform(0,1) will be accpeted if
}\frac{f(x)}{cg(x)}=x^2(1-x) &gt; \mu\)</span></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span>;j<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span>;y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g(.)</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="cf">if</span> (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x) <span class="sc">&gt;</span> u) {</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co">#we accept x</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>}</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>}</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>j</span></code></pre></div>
<pre><code>## [1] 11644</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="dv">12</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">01</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="fu">lines</span>(t, <span class="dv">12</span><span class="sc">*</span>t<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>t))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="fu">ppoints</span>(n), <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">qqplot</span>(q, y, <span class="at">cex=</span><span class="fl">0.25</span>, <span class="at">xlab=</span><span class="st">&quot;Beta(3, 2)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Sample&quot;</span>)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-ex3.9" class="section level1">
<h1>Question EX3.9</h1>
<p><span class="math inline">\(\text{The rescaled Epanechnikov kernel
[85] is a symmetric density function:} f_{e}(x) = \frac{3}{4}(1 − x^2),
|x| ≤ 1. \\ \text{Devroye and Gyorfi [71, p. 236] give the following
algorithm for simulation
from this distribution. }\\ \text{Generate iid U1, U2, U3 ∼ Uniform(−1,
1). If |U3| ≥
|U2| and |U3| ≥ |U1|, deliver U2; otherwise deliver U3.}\\ \text{Write a
functionto generate random variates from fe, and construct the histogram
density
estimate of a large simulated random sample}\)</span></p>
</div>
<div id="answer-ex3.9" class="section level1">
<h1>Answer EX3.9</h1>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>my.function39<span class="ot">&lt;-</span><span class="cf">function</span>(n){</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>u2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>u3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="co">#generate U1,U2,U3</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">abs</span>(u3[i])<span class="sc">&gt;=</span><span class="fu">abs</span>(u2[i])<span class="sc">&amp;&amp;</span><span class="fu">abs</span>(u3[i])<span class="sc">&gt;=</span><span class="fu">abs</span>(u1[i])) <span class="co"># The algorithm given in the question</span></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>  z[i]<span class="ot">&lt;-</span> u2[i]</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>  z[i]<span class="ot">&lt;-</span> u3[i]</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a><span class="fu">return</span>(z)</span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>n<span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">my.function39</span>(n)</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="fu">hist</span>(z,<span class="at">prob =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="dv">3</span><span class="sc">/</span><span class="dv">4</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>))) <span class="co"># 10000个数据</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,.<span class="dv">0001</span>)</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="fu">lines</span>(s,(<span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>s<span class="sc">*</span>s))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-ex3.10" class="section level1">
<h1>Question EX3.10</h1>
<p><span class="math inline">\(\text{Prove that the algorithm given in
Exercise 3.9 generates variates from the density } f_{e}\)</span></p>
</div>
<div id="answer-ex3.10" class="section level1">
<h1>Answer EX3.10</h1>
<p>The comparison of the absolute values ​​of U1, U2, and U3 in the
article is actually equivalent to the comparison of the random variables
of U (0, 1). Generate <span class="math inline">\(X_1, X_2, X_3\)</span>
from Uniform <span class="math inline">\((0,1)\)</span>.Still perform
the steps in the algorithm for X1, X2, and X3 Thus, <span class="math inline">\(X\)</span> is the first or second order statistic
of the sample <span class="math inline">\(X_1, X_2, X_3\)</span>. Define
<span class="math inline">\(T= \pm X\)</span> with probability <span class="math inline">\(1 / 2,1 / 2\)</span>. the cdf of the <span class="math inline">\(k^{\text {th }}\)</span> order statistic when
<span class="math inline">\(n=3\)</span> is <span class="math display">\[
G_k(x_k)=\sum_{i=k}^3(\begin{array}{l}
3 \\
i
\end{array})[F(x_k)]^i[1-F(x_k)]^{3-i} .
\]</span> by the definition , the cdf of <span class="math inline">\(X\)</span> is <span class="math display">\[
\begin{aligned}
G(x) &amp; =\frac{1}{2} G_1(x)+\frac{1}{2} G_2(x) \\
&amp; =\frac{1}{2}[(1-(1-x)^3)+(3 x^2(1-x)+x^3)]=\frac{1}{2}[3 x-x^3]
\end{aligned}
\]</span> the density of <span class="math inline">\(X\)</span> is <span class="math display">\[
g(x)=G^{\prime}(x)=\frac{1}{2}(3-3 x^2)=\frac{3}{2}(1-x^2), \quad
0&lt;x&lt;1 .
\]</span> Therefore, the density of <span class="math inline">\(T\)</span> is <span class="math display">\[
f_{T}(t)=\frac{3}{4}(1-t^2),\quad -1&lt;t&lt;1
\]</span> <span class="math inline">\(\Rightarrow
F_{T}(t)=F_{e}(t)\)</span></p>
</div>
<div id="questiongiven-on-the-class" class="section level1">
<h1>Questiongiven on the Class</h1>
<p><span class="math inline">\(\text{Use the inverse transformation
method to implement some functions (replace = TRUE) of the function
sample }\)</span></p>
</div>
<div id="answer-1" class="section level1">
<h1>Answer</h1>
<p><span class="math inline">\(\text{To use the inverse transformation
in discrete distribution for finite case}\\ \text{we have the algorithm
: }\\ \text{ Generate U ∼ U(0, 1)}\\ \text{Return }X = x_{i} \text{ if }
F_{X} (x_{i}−1) &lt; U ≤ F_{X} (x_{i}).\)</span></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>my.sample<span class="ot">&lt;-</span> <span class="cf">function</span>(x,size,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="cn">NULL</span>){</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>l<span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">is.null</span>(prob)) <span class="co"># when prob is null</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>l,l) <span class="co"># Default equal probability distribution</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a> <span class="cf">else</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>   p<span class="ot">&lt;-</span>prob <span class="co"># Specified probability distribution weights</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>cp <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(p); </span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>m <span class="ot">&lt;-</span> size; U <span class="ot">=</span> <span class="fu">runif</span>(size)</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>r <span class="ot">&lt;-</span> x[<span class="fu">findInterval</span>(U,cp)<span class="sc">+</span><span class="dv">1</span>] <span class="co"># Find i in the second step of the algorithm</span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="fu">return</span>(r)</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>}</span></code></pre></div>
<p><span class="math inline">\(\text{Verify that the data generated by
our own functions conforms to the corresponding probability
distribution}\\\)</span> <span class="math inline">\(\text{default prob
(equal probability distribution)}\)</span></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>sample<span class="fl">.1</span><span class="ot">&lt;-</span><span class="fu">my.sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">size =</span> <span class="dv">10000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>prob1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> ,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>ct1 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">table</span>(sample<span class="fl">.1</span>)); ct1<span class="sc">/</span><span class="fu">sum</span>(ct1)<span class="sc">/</span>prob1</span></code></pre></div>
<pre><code>## [1] 0.9969 0.9948 1.0083</code></pre>
<p><span class="math inline">\(\text{Specify probability
distribution}\)</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>sample<span class="fl">.2</span><span class="ot">&lt;-</span><span class="fu">my.sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">size =</span> <span class="dv">10000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">3</span>, .<span class="dv">5</span>))</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>prob2 <span class="ot">=</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">3</span>, .<span class="dv">5</span>)</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>ct2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">table</span>(sample<span class="fl">.2</span>)); ct2<span class="sc">/</span><span class="fu">sum</span>(ct2)<span class="sc">/</span>prob2</span></code></pre></div>
<pre><code>## [1] 1.005 1.010 0.992</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>data1<span class="ot">&lt;-</span>sample<span class="fl">.1</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>data2<span class="ot">&lt;-</span>sample<span class="fl">.2</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>  <span class="at">Group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;equal prob&quot;</span>, <span class="st">&quot;given prob&quot;</span>), <span class="at">each =</span> <span class="dv">10000</span>)),</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(data1, data2)</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>)</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a><span class="co"># Create side-by-side histograms</span></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>histogram <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Histogram of equal prob vs given prob&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Value&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;equal prob&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;given prob&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>))</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a><span class="co"># Show histogram</span></span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a><span class="fu">print</span>(histogram)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>c1<span class="ot">&lt;-</span> <span class="fu">my.sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">10000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">3</span>, .<span class="dv">2</span>, .<span class="dv">1</span>, .<span class="dv">1</span>, .<span class="dv">05</span>, .<span class="dv">05</span>, .<span class="dv">05</span>, .<span class="dv">05</span>, .<span class="dv">05</span>, .<span class="dv">05</span>))</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">10000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">3</span>, .<span class="dv">2</span>, .<span class="dv">1</span>, .<span class="dv">1</span>, .<span class="dv">05</span>, .<span class="dv">05</span>, .<span class="dv">05</span>, .<span class="dv">05</span>, .<span class="dv">05</span>, .<span class="dv">05</span>))</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>data1<span class="ot">&lt;-</span>c1</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>data2<span class="ot">&lt;-</span>c2</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>  <span class="at">Group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Group 1&quot;</span>, <span class="st">&quot;Group 2&quot;</span>), <span class="at">each =</span> <span class="dv">10000</span>)),</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(data1, data2)</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>)</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a><span class="co"># Create side-by-side histograms</span></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>histogram <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Group)) <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Histogram of my.sample vs sample&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Value&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Group 1&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;Group 2&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>))</span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a><span class="co"># Show histogram</span></span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a><span class="fu">print</span>(histogram)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
<a href="#directory">Back to the Directory</a></p>
</div>
<div id="question3ans" class="section level1">
<h1>Homework2</h1>
</div>
<div id="question-1.1" class="section level1">
<h1>Question 1.1</h1>
<ul>
<li>Proof that what value <span class="math inline">\(\rho=\frac{l}{d}\)</span> should take to minimize
the asymptotic variance of <span class="math inline">\(\hat{\pi}\)</span> ? <span class="math inline">\((m \sim B(n, p)\)</span>, using <span class="math inline">\(\delta\)</span> method)</li>
</ul>
</div>
<div id="answer-1.1" class="section level1">
<h1>Answer 1.1</h1>
<p>Let m be the number of times in n independent tosses that the needle
crosses any line. Then the proportion of crossings <span class="math inline">\(\hat{p}\)</span> , a point estimator of p, becomes
<span class="math inline">\(\hat{p}=\frac{m}{n}\)</span>. Hence, we can
write the point estimator of <span class="math inline">\(\hat{\pi}=\frac{2 l}{d \hat{p}}\)</span> <span class="math display">\[
\text { denote: } p=\frac{2 l}{d \pi} ,\hat{p}=\frac{m}{n}, m \sim  B(n,
p) \\
\frac{1}{\pi}=\frac{2 d}{l} \cdot p, \pi=\frac{2 l}{d p}\\
\Rightarrow \hat{\pi}=\frac{2 l}{d \hat{p}}=\frac{2 l}{d} \frac{n}{m}=2
\rho \frac{n}{m}  ;\left(\rho=\frac{l}{d}\right)
\]</span></p>
<p><span class="math display">\[
\text{by CLT:} \frac{m-n P}{\sqrt{n p(1-P)}} \sim N(0,1)
\]</span></p>
<p><span class="math display">\[
\text{then:}\sqrt{n}\left(\frac{m}{n}-p\right) \sim N(0, p(1-p))
\]</span></p>
<p><span class="math display">\[
\text{by delta-method, Let g(x)=}\frac{1}{x},\text{we get bellow :}\\
\sqrt{n}\left(\frac{n}{m}-\frac{1}{p}\right) \sim N \left(0,
\frac{1-p}{p^3}\right) \\
\text { so } \hat{\pi}=\frac{2 \rho n}{m} \sim N \left(\frac{2 \rho}{p},
\frac{(1-p) 4 \rho^2}{n p^3}\right) \\
A \operatorname{Var} (\hat{\pi})=\frac{(1-p) 4 \rho^2}{n p^3} \\
\text{since that }p=\frac{2 l}{d \pi} \\
\Rightarrow A \operatorname{Var}(\pi)=\frac{\pi^2}{2
n}\left(\frac{\pi}{\rho}-2\right) \\
\text{so the } \rho_{\text {min }}=1
\]</span></p>
</div>
<div id="question-1.2" class="section level1">
<h1>Question 1.2</h1>
<ul>
<li>Take three different values of <span class="math inline">\(\rho\left(0 \leq \rho \leq 1\right.\)</span>,
including <span class="math inline">\(\left.\rho_{\text {min
}}\right)\)</span> and use Monte Carlo simulation to verify your answer.
<span class="math inline">\(\left(n=10^6\right.\)</span>, Number of
repeated simulations <span class="math inline">\(\left.K=100\right)\)</span></li>
</ul>
</div>
<div id="answer-1.2" class="section level1">
<h1>Answer 1.2</h1>
<p>take <span class="math inline">\(\rho=0.4,0.7\)</span> and <span class="math inline">\(\rho_{\text{min}=1}\)</span></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>pihat1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,K)</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="fl">0.7</span>,<span class="dv">1</span>)</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>    <span class="fu">set.seed</span>(i)</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>    l <span class="ot">&lt;-</span> d<span class="sc">*</span><span class="fl">0.4</span></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>    </span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>    pihat1[i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>l<span class="sc">/</span>d<span class="sc">/</span><span class="fu">mean</span>(l<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)}</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>pihat1</span></code></pre></div>
<pre><code>##   [1] 3.144963 3.137698 3.136910 3.136123 3.132538 3.143332 3.147995 3.136775
##   [9] 3.134931 3.135533 3.148144 3.140580 3.139335 3.134673 3.140765 3.140938
##  [17] 3.136824 3.146831 3.141690 3.139064 3.143320 3.151182 3.145829 3.136541
##  [25] 3.145507 3.138190 3.141061 3.146534 3.144976 3.148788 3.138375 3.139311
##  [33] 3.149904 3.149495 3.143987 3.141012 3.139249 3.140777 3.148949 3.136160
##  [41] 3.144753 3.147413 3.139114 3.145928 3.138769 3.146348 3.141258 3.138954
##  [49] 3.145507 3.146262 3.132047 3.137218 3.138707 3.131655 3.137513 3.143764
##  [57] 3.140457 3.137156 3.140223 3.150202 3.135939 3.141481 3.133740 3.142542
##  [65] 3.142443 3.132869 3.138092 3.152635 3.133409 3.149482 3.140777 3.138633
##  [73] 3.137870 3.146002 3.133568 3.142455 3.141012 3.143085 3.133679 3.136849
##  [81] 3.138818 3.140420 3.143147 3.143900 3.137563 3.138757 3.138178 3.147946
##  [89] 3.141110 3.145532 3.138818 3.131250 3.151703 3.146188 3.139200 3.142381
##  [97] 3.143184 3.137255 3.137181 3.149991</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>pihat2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,K)</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>    <span class="fu">set.seed</span>(i)</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>    l <span class="ot">&lt;-</span> d<span class="sc">*</span><span class="fl">0.7</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>    pihat2[i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>l<span class="sc">/</span>d<span class="sc">/</span><span class="fu">mean</span>(l<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)}</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>pihat2</span></code></pre></div>
<pre><code>##   [1] 3.144576 3.147348 3.139865 3.141577 3.138218 3.144223 3.142057 3.140471
##   [9] 3.140640 3.135421 3.143651 3.143757 3.140753 3.139464 3.142706 3.140217
##  [17] 3.138246 3.140570 3.139865 3.140788 3.142360 3.144746 3.141577 3.134298
##  [25] 3.145021 3.139823 3.138648 3.140140 3.147114 3.147510 3.141824 3.140527
##  [33] 3.137220 3.145792 3.143602 3.139492 3.145983 3.143108 3.143771 3.141451
##  [41] 3.143574 3.143108 3.138683 3.144202 3.140760 3.138845 3.146244 3.140549
##  [49] 3.145467 3.145629 3.136622 3.140267 3.138479 3.134059 3.141930 3.143736
##  [57] 3.141972 3.141331 3.136953 3.145954 3.139985 3.146909 3.135927 3.139548
##  [65] 3.140788 3.137712 3.139330 3.148707 3.136728 3.145021 3.141507 3.141528
##  [73] 3.141436 3.147058 3.134242 3.142078 3.140760 3.143962 3.143122 3.139823
##  [81] 3.137494 3.143863 3.141824 3.140210 3.141324 3.135049 3.139626 3.146379
##  [89] 3.142071 3.142769 3.138718 3.139922 3.138268 3.139006 3.136953 3.137550
##  [97] 3.143369 3.141923 3.141225 3.143298</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>pihat3 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,K)</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="fl">0.7</span>,<span class="dv">1</span>)</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>    <span class="fu">set.seed</span>(i)</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>    l <span class="ot">&lt;-</span> d<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>    </span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a>    pihat3[i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>l<span class="sc">/</span>d<span class="sc">/</span><span class="fu">mean</span>(l<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)}</span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a>pihat3</span></code></pre></div>
<pre><code>##   [1] 3.140363 3.141434 3.140082 3.136625 3.143804 3.139846 3.140999 3.145436
##   [9] 3.139392 3.139003 3.143685 3.145544 3.143557 3.139836 3.139885 3.138560
##  [17] 3.140265 3.139836 3.141907 3.143023 3.141942 3.142391 3.139658 3.141448
##  [25] 3.145668 3.142317 3.141996 3.141108 3.146415 3.139934 3.142623 3.142016
##  [33] 3.140970 3.146534 3.142381 3.137910 3.142732 3.141078 3.139752 3.143794
##  [41] 3.140196 3.141907 3.143997 3.140758 3.142189 3.137304 3.139920 3.142860
##  [49] 3.144867 3.142722 3.138845 3.139392 3.140166 3.138614 3.144377 3.142213
##  [57] 3.141710 3.143334 3.140560 3.146861 3.139703 3.141720 3.139594 3.140511
##  [65] 3.139397 3.140422 3.143142 3.143774 3.138963 3.142979 3.141226 3.141621
##  [73] 3.142544 3.142880 3.136640 3.142327 3.139934 3.141715 3.138776 3.140506
##  [81] 3.139180 3.139796 3.140136 3.141320 3.143601 3.138880 3.143008 3.143586
##  [89] 3.141907 3.143542 3.138835 3.142727 3.140723 3.140516 3.139441 3.138811
##  [97] 3.142559 3.142036 3.143162 3.141360</code></pre>
<p>Calculate the sum of squared residuals between the simulated value
and the real pi value</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">sum</span>((pihat1<span class="sc">-</span>pi)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.00253356</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">sum</span>((pihat2<span class="sc">-</span>pi)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.001024868</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">sum</span>((pihat3<span class="sc">-</span>pi)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.0004441394</code></pre>
<p>We find that indeed as the value increases, the variance of the
estimate decreases</p>
</div>
<div id="question-ex5.6" class="section level1">
<h1>Question EX5.6</h1>
<p>5.6 In Example 5.7 the control variate approach was illustrated for
Monte Carlo integration of <span class="math display">\[
\theta=\int_0^1 e^x d x .
\]</span> Now consider the antithetic variate approach. Compute <span class="math inline">\(\operatorname{Cov}\left(e^U,
e^{1-U}\right)\)</span> and <span class="math inline">\(\operatorname{Var}\left(e^U+e^{1-U}\right)\)</span>,
where <span class="math inline">\(U \sim
\operatorname{Uniform}(0,1)\)</span>. What is the percent reduction in
variance of <span class="math inline">\(\hat{\theta}\)</span> that can
be achieved using antithetic variates (compared with simple MC)?</p>
</div>
<div id="answer-ex5.6" class="section level1">
<h1>Answer EX5.6</h1>
<p><span class="math display">\[
\begin{aligned}
&amp; U \backsim U(0,1) \text { , } 1-U \backsim U(0,1) \\
&amp; \operatorname{Cov}\left(e^U, e^{(1-U)}\right) \\
&amp; =E e^U \cdot e^{1-U}-E e^U E e^{1-U} \\
&amp; =e-\left(\mathrm{Ee}^{\mathrm{U}}\right)^2 \\
&amp; =e-(e-1)^2 \\
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>e<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="dv">1</span>)</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>e<span class="sc">-</span>(e<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] -0.2342106</code></pre>
$$
<span class="math display">\[\begin{aligned}
&amp;\operatorname{Cov}\left(e^U, e^{(1-U)}\right)=-0.2342\\

\end{aligned}\]</span>
<p>$$</p>
<p><span class="math display">\[
\begin{aligned}
&amp;
\operatorname{Var}\left(e^U\right)=\operatorname{Var}\left(e^{1-U}\right)
\\
&amp; \operatorname{Var}\left(e^U\right)=E e^{2 U}-\left(E e^U\right)^2
\\
&amp; =\frac{1}{2}\left(e^2-1\right)-(e-1)^2 \\
&amp; \operatorname{Var}\left(e^U+e^{1-U}\right) \\
&amp;
=\operatorname{Var}\left(e^U+\operatorname{Var}\left(e^{1-U}\right)+2
\operatorname{cov}\left(e^U \cdot e^{(1-U)}\right)\right. \\
&amp; =\left(e^2-1\right)+2 e-4(e-1)^2
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>e<span class="sc">*</span>e<span class="dv">-1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>e<span class="dv">-4</span><span class="sc">*</span>(e<span class="dv">-1</span>)<span class="sc">*</span>(e<span class="dv">-1</span>)</span></code></pre></div>
<pre><code>## [1] 0.01564999</code></pre>
<p><span class="math display">\[
\operatorname{Var}\left(e^U+e^{1-U}\right)=0.0156
\]</span></p>
<p>Supposes <span class="math inline">\(\hat{\theta}_1\)</span> is the
simple <span class="math inline">\(M C\)</span> estimator, we have <span class="math display">\[
\hat{\theta_1} =\frac{1}{m} \sum_{i=1}^{m }e^{U_i}
\]</span>.</p>
<p><span class="math display">\[
\operatorname{Var}\left(\hat{\theta}_1\right)=\frac{\operatorname{Var}\left(e^{U_1}\right)}{m}=\frac{\frac{1}{2}\left(e^2-1\right)-(e-1)^2}{m}
\]</span> suppose <span class="math inline">\(\hat{\theta}_2\)</span> is
the antithetic estimator <span class="math display">\[
\hat{\theta_2} =\frac{2}{m} \sum_{j=1}^{m /
2}\left(\frac{e^{U_j}+e^{1-U_j}}{2}\right) .
\]</span></p>
<p><span class="math display">\[
\operatorname{Var}\left(\hat{\theta}_{2}\right)=2
\frac{\operatorname{Var}
\frac{e^U+e^{1-U}}{2}}{m}=2\left[\frac{\frac{1}{4}\left(e^2-1\right)+\frac{1}{2}
e-(e-1)^2}{m}\right]\\
\]</span></p>
<p><span class="math display">\[
1-\frac{\operatorname{Var}\left(\hat{\theta}_2\right)}{\operatorname{Var}\left(\hat{\theta}_1\right)}=1-\frac{\frac{1}{2}\left(e^2-1\right)+e-2(e-1)^2}{\frac{1}{2}\left(e^2-1\right)-(e-1)^2}=0.9676
\\
\]</span></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a> <span class="dv">1</span><span class="sc">-</span>(<span class="fl">0.5</span><span class="sc">*</span>(e<span class="sc">*</span>e<span class="dv">-1</span>)<span class="sc">+</span>e<span class="dv">-2</span><span class="sc">*</span>(e<span class="dv">-1</span>)<span class="sc">*</span>(e<span class="dv">-1</span>))<span class="sc">/</span>(<span class="fl">0.5</span><span class="sc">*</span>(e<span class="sc">*</span>e<span class="dv">-1</span>)<span class="sc">-</span>(e<span class="dv">-1</span>)<span class="sc">*</span>(e<span class="dv">-1</span>))</span></code></pre></div>
<pre><code>## [1] 0.9676701</code></pre>
<p>In the end ,the percent reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> is 0.9676701.</p>
</div>
<div id="question-ex5.7" class="section level1">
<h1>Question EX5.7</h1>
<p>5.7 Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate
<span class="math inline">\(\theta\)</span> by the antithetic variate
approach and by the simple Monte Carlo method. Compute an empirical
estimate of the percent reduction in variance using the antithetic
variate. Compare the result with the theoretical value from Exercise
5.6.</p>
</div>
<div id="answer-ex5.7" class="section level1">
<h1>Answer EX5.7</h1>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>U1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(U) </span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>U2 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>U)</span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> (U1<span class="sc">+</span>U2)<span class="sc">/</span><span class="dv">2</span> <span class="co"># antithetic estimator of hat{theta}</span></span></code></pre></div>
<p><span class="math inline">\(\hat{\theta}_1\)</span> is the simple
<span class="math inline">\(M C\)</span> estimator, we have simulation
result follow:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">mean</span>(U1)</span></code></pre></div>
<pre><code>## [1] 1.71812</code></pre>
<p><span class="math inline">\(\hat{\theta}_2\)</span> is the Antithetic
variate estimator, we have simulation result follow:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">mean</span>(T1)</span></code></pre></div>
<pre><code>## [1] 1.718259</code></pre>
<p>An empirical estimate of the percent reduction in variance using the
antithetic variate</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>(<span class="fu">var</span>(U1)<span class="sc">-</span><span class="fu">var</span>(T1))<span class="sc">/</span><span class="fu">var</span>(U1)</span></code></pre></div>
<pre><code>## [1] 0.9838348</code></pre>
<p>the theoretical value from Exercise 5.6 is 0.9676,The difference
between the two is 0.0162，The deviation is within 2%, which is
statistically acceptable.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fl">0.0162</span><span class="sc">/</span><span class="fl">0.9676</span></span></code></pre></div>
<pre><code>## [1] 0.01674246</code></pre>
<p><a href="#directory">Back to the Directory</a></p>
</div>
<div id="question4ans" class="section level1">
<h1>Homework3</h1>
</div>
<div id="question-1" class="section level1">
<h1>Question</h1>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\operatorname{Var}\left(\hat{\theta}^M\right)=\frac{1}{M
k} \sum_{i=1}^k
\sigma_i^2+\operatorname{Var}\left(\theta_I\right)=\operatorname{Var}\left(\hat{\theta}^S\right)+\operatorname{Var}\left(\theta_I\right)\)</span>,
where <span class="math inline">\(\theta_i=E[g(U) \mid I=i],
\sigma_i^2=\operatorname{Var}[g(U) \mid I=i]\)</span> and <span class="math inline">\(I\)</span> takes uniform distribution over <span class="math inline">\(\{1, \ldots, k\}\)</span>.</li>
</ol>
<p>Proof that if <span class="math inline">\(g\)</span> is a continuous
function over <span class="math inline">\((a, b)\)</span>, then <span class="math inline">\(\operatorname{Var}\left(\hat{\theta}^S\right) /
\operatorname{Var}\left(\hat{\theta}^M\right) \rightarrow 0\)</span> as
<span class="math inline">\(b_i-a_i \rightarrow 0\)</span> for all <span class="math inline">\(i=1, \ldots, k\)</span>.</p>
</div>
<div id="answer-2" class="section level1">
<h1>Answer</h1>
<p><span class="math display">\[
\begin{gathered}
\operatorname{Var}\left(\hat{\theta}^M\right)=\frac{1}{M}
\operatorname{Var}(g(U))=\frac{1}{M}\{E[\operatorname{Var}(g(U) \mid
I)]+\operatorname{Var}[E(g(U) \mid I)]\} \\
=\operatorname{Var}\left(\hat{\theta}^S\right)+\frac{1}{M}
\operatorname{Var}\left(\theta_I\right) \\
\frac{\operatorname{Var}\left(\hat{\theta}^S\right)}{\operatorname{Var}\left(\hat{\theta}^M\right)}=\frac{\operatorname{Var}\left(\hat{\theta}^S\right)}{\operatorname{Var}\left(\hat{\theta}^S\right)+\frac{1}{M}
\operatorname{Var}\left(\theta_I\right)}=\frac{1}{1+\frac{\frac{1}{M}
\operatorname{Var}\left(\theta_I\right)}{\operatorname{Var}\left(\hat{\theta}^S\right)}}
\\
\frac{\frac{1}{M}
\operatorname{Var}\left(\theta_I\right)}{\operatorname{Var}\left(\hat{\theta}^S\right)}=\frac{\frac{1}{M}
\operatorname{Var}[E(g(U) \mid I)]}{\frac{1}{M K} \sum_{i=1}^s
\sigma_i^2}=\frac{\operatorname{Var}[E(g(U) \mid
I)]}{E[\operatorname{Var}(g(U) \mid L)]} \triangleq \frac{A}{B}
\end{gathered}
\]</span> Note that <span class="math inline">\(b_i-a_i \rightarrow
0\)</span> for all <span class="math inline">\(i=1, \ldots, k\)</span>
We have: when <span class="math inline">\(I=k,
\operatorname{Var}\left(g(U)\mid
I=k)=\operatorname{Var}\left(g\left(U_k\right)\right)\right.\)</span>,
where <span class="math inline">\(U_k \sim U\left(a_k,
b_k\right)\)</span> <span class="math display">\[
\operatorname{Var}\left(g\left(U_k\right)\right)=E\left(g\left(U_k\right)-E
g\left(U_k\right)\right)^2 \rightarrow 0 \text {, as } b_k-a_k
\rightarrow 0
\]</span> <span class="math inline">\(\Rightarrow
E[\operatorname{Var}(g(u) \mid I)] \rightarrow 0\)</span> as <span class="math inline">\(b_i-a_i \rightarrow 0\)</span> for <span class="math inline">\(i=1, \cdots, k\)</span> <span class="math display">\[
E(g(U) \mid I) \backsim\left(\begin{array}{ccc}
E\left(g\left(u_1\right)\right) &amp; \cdots &amp;
E\left(g\left(U_k\right)\right) \\
\frac{1}{k} &amp; \cdots &amp; \frac{1}{k}
\end{array}\right)
\]</span> <span class="math display">\[
\begin{aligned}
&amp; a \leq E\left(g\left(U_1\right)\right) \leq b_1, \quad b_{k-1}
\leq E\left(g\left(U_k\right)\right) \leq b \\
&amp; \operatorname{Var}(E(g(U) \mid I) \neq 0 \\
&amp; \Rightarrow \quad \frac{A}{B} \rightarrow \infty \Rightarrow
\frac{\operatorname{Var}\left(\hat{\theta}^S\right)}{\operatorname{Var}\left(\hat{\theta}^M\right)}
\rightarrow 0 \text { ,  as  } b_i-a_i \rightarrow  \text {0    for   i}
=1, \cdots, k
\end{aligned}
\]</span></p>
</div>
<div id="question-5.13" class="section level1">
<h1>Question 5.13</h1>
<p>5.13 Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2}, \quad x&gt;1 .
\]</span> Which of your two importance functions should produce the
smaller variance in estimating <span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2} d x
\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-5.13" class="section level1">
<h1>Answer 5.13</h1>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1.01</span>, <span class="dv">10</span>, .<span class="dv">01</span>)</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {x<span class="sc">*</span>x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>x<span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">^</span><span class="fl">0.5</span><span class="sc">*</span>(x<span class="sc">&gt;=</span><span class="dv">1</span>)}</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a><span class="fu">plot</span>(g,<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>) , <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the graph, we consider a normal distribution or a exponential
distribution.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="fu">plot</span>(g,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>),<span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.7</span>))</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="cf">function</span>(x){<span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">1</span>,<span class="at">sd=</span><span class="dv">1</span>)<span class="sc">*</span>(x<span class="sc">&gt;=</span><span class="dv">1</span>)}</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="cf">function</span>(x){<span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">*</span>(x<span class="sc">&gt;=</span><span class="dv">1</span>)}</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">f1</span>(x),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>),<span class="at">lty =</span> <span class="dv">10</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">f2</span>(x),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>),<span class="at">lty =</span> <span class="dv">6</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">inset =</span> <span class="fl">0.02</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g(x)&quot;</span>, <span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNth0E9mAABmADpmZmZmtv+QOgCQZgCQkGaQ2/+2ZgC2tma2/7a2///bkDrb2//b/9vb///fU2v/tmb/25D//7b//9v///98d3vTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIxElEQVR4nO2di3bbKBRF1aSdR5y2nqmn1bRWYv//T9YgKZIt4HB5RCCfvVYbryxyrexcECDAzZk4ada+gNKhIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGAxIKaJTvD9wpgLUHLb+3Uf8e0bxNPcYLkhvKmT0GCQg1lbB3fX5Czau8CY0ZdEQpdUgYNhqQpdEeCBoSG7khQWB27I0GjIVkKVSno8PDj/PKpaT58E4UbU0hkqEZB2s8fFzmvz19F4cYUkhiqUNDr89NF0kf1sn38JQkX0gpVKejr+bR/Ui+7Sy4Jwr0JEqRQhYJ09rQhGRTSCtUo6PX54YdOoc7WSiNBAmoUdDHTDyg+isO9pZB3DtUpKD4cBVkQt9NJruy0H/sjr5+nVuEdBLWyu9g5oBVKIqidGoNuuq8UNt3RMwnyTKEUVzbv0E7JVGYVExuKubJD03z493KnVd01ley6izt1TUoXFB0KoYZEnRowqo6b6pdoN1PfJJ+g076vSJYWyB1OmELXodAc85yXT6oyHT5804lzSaPvuoHuvz2EziOobZ76F934IiycV2coPIP6cVCnBGklh77f1usaQmcRNIzDFNKhhkaWQuGC2lHQkDNdo7/kFzS7JwgHqz3vJegmg077L/ob5WeQrJ0OF9QnTju2Qe3jT33h79IGDW8R2QadfXIo1V1MpZHOqfe4i70+93cNS/7AcJJKFtkPevhPWbr8O1wu9rT/WH4/SCGpY7FX1ukO4tSTnr0uV5AkhSLboKH9KWQs5h1ulkLIUMSV6VkrnS+rjeaDw/mn0L3NBw34p9CmBHlMd4x4t9ObEiQI551C9yrI21DElbWN7si+/GmZdChbUP5Qw6BLPaSyhi5ZkGcKxQhS9/bOPm1VuiC/W33wlanlJw8/LsNF25RD6YI8Uyg2g+xzMuUL8kqhxZTr2JkwvL7+yeoF+fWF7jiD/AYc9y3Iw9BdC8obahOCcApR0IDtIdmdC8IptKnBqmC6YwS205sSFBIOdYbuXhCqZBS0c6/KK03Q+ExwfB5gp2ukezVsOGtZaYKGx8ld83V6yL/g0DRPL3//Eu/VsDClkCGHShOkn86e9QNa28oE/RT3oLMnbPHCAlclK03QrHdl62DpInq3T9jyFwMOQ5Fz0noxnH2JRUgG9dFUBlkFqSKn/8/JMmjeG4oNNaGu87S/ZHpr2RIQ2QaNlW3JmzlrMxX+Wy1SKG6oMawRMv+pA2/z+j6m1otYl2iqRUnqS2e90cl/K+s+oMg5af3Ssummkn7QgK2SLaZcvVe5TvdYy9+6LkG2HIofzVsXwr2DIPleDTtjQ51cUGfbtlXFaH6GOYWiBVkXUpZWxbA5Yw7FCmqtfooS9KZGnF2RglrHkDKfIOFejRspjkQypFBsP8iaPxkFyfZqGG34G4oT1PZ/yfftB8lW2lsi25Jo0R0qbbDqgWSvhqPFcRo6omIpKCCDnGEt8m4MVSjIf68GimoxpBRVLch3rwYO6qiBo6EqBSUMZyw5nx66d0HmJNKV7CgNJaUOQebCUw5RkN3QUR5K+r51CLIY2mlDmxIUPN1h/oGdaoY2JSg8nP1m5p5kjaMiQa4+Y07qEWSrZZkNVSRonSSqSpAliY45DdUlyPxzx5yGahNkM5StnlUnyDqNlklRfYKMDZHqMFIQ/OEcWVSlIHNDpP9PrqhOQaYfP46G0iqqVJAjhxInUa2CzH3GcZo6YRrVMt1hirX81ux5aypF1WbQ2X6/H9glyaOaBRkVXS81j3dUtyBTnNtFnpGOMgmKOqpUBEyiyLqW69FzmqNKvTC1+Iu1wspRkKUsgqIPmpSyiHY07XrZhaRSFkGxR5XKMXQcLDtcd8JGaRsZZA5pP0t4t/POplxtULKjSgUYGiNjVXtDN0zAU6a7WOxRpaEsO+n4SOrd6MloqvZ+kDH2bSZ5fojJUO+uXW1R0PlsWJN+PLqr2zWTq9yCUu7VELMcGitHMlUVj+bD3nfkeFT/jv0X88vepfdbJL7itOHysdE2KB3VD1Zzs4HBal5WG2pUQw5BHoNVWVDPcqsUCynukUGyoFsT5DFYlQXdnCA8WJUF3Z6gxEEpKE05CiqxWGDxtEEpKE257QnaEhQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAiQQ5D1o/PmuI4zntM29vPPrzmAieDzOGVsO8vXSAZB9o/Om+E8zniGWkZiObL2hg7NlJ/Hw7BFpBfk+Oi8Gc7jjCf0ucz285uvSnoIcj/OM5JckOuj85aFvXLDS1D7+A8W1IpqlyZHG+QvyHF09YzWQ+Ol8ni0QYe//Bq+GasKAs8fx0IepdRDXyzo9VkVOYgMrSnIepzxDac9/NXVo3CPDOrfVtQQrSjIK3/6kqiO6buTr6D+/uDLeoIcxxnfAn+l4eRW9JkyQzTRvX41Qa7jjCd6NX7GcQZJoo2sJch5nPEM9VvPlt2goqiIavTqaKSdxxnPOfjWHK82yD/aCAerAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQOmC1EpqvVh6LUoXpBZPuQ8rykzpgs7dw/fP4v0DCSle0Pkg23ySmvIFdcI1c4kpXtBp/0W+AyUhxQtqH3/6LXLNROmC1NGEAZuY0lG6oH6d9IrNdOmCVoeCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgL8BhuXyGTNmH/BAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="dv">10000</span><span class="sc">*</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(x))</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>fg1 <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x)</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>fg2 <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f2</span>(x)</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a><span class="fu">plot</span>(x,gg,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.9</span>))</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a><span class="fu">lines</span>(x,fg1,<span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a><span class="fu">lines</span>(x,fg2,<span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">inset =</span> <span class="fl">0.02</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g/f1&quot;</span>,<span class="st">&quot;g/f2&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the plot, we might expect the f1 function to produce the smaller
variance in estimating the integral,because we can see that the ratio
g/f1 is closer to a constant function.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(m))<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>fg1 <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">f1</span>(x)</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(m,<span class="dv">1</span>)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>fg2 <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">f2</span>(x)</span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>theta.hat <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(fg1), <span class="fu">mean</span>(fg2))</span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>var.hat <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">var</span>(fg1), <span class="fu">var</span>(fg2)) <span class="sc">/</span> m</span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a><span class="fu">rbind</span>(theta.hat, var.hat)</span></code></pre></div>
<pre><code>##                   [,1]         [,2]
## theta.hat 4.011522e-01 4.027747e-01
## var.hat   1.901119e-07 2.452379e-06</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">integrate</span>(g, <span class="dv">1</span>, <span class="cn">Inf</span>)<span class="sc">$</span>value</span></code></pre></div>
<pre><code>## [1] 0.400626</code></pre>
<p>From the result above, the variance of g(x)/f1(x) is smaller than
that of g(x)/f2(x). And the estimation of <span class="math inline">\(\theta\)</span>is close to the true value
0.400626</p>
</div>
<div id="question-5.14" class="section level1">
<h1>Question 5.14</h1>
<p>5.14 Obtain a Monte Carlo estimate of <span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2} d x
\]</span> by importance sampling.</p>
</div>
<div id="answer-5.14" class="section level1">
<h1>Answer 5.14</h1>
<p>According to the process of 5.13 we have</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(m))<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>fg1 <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">f1</span>(x)</span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(m,<span class="dv">1</span>)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>fg2 <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">f2</span>(x)</span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>theta.hat <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(fg1), <span class="fu">mean</span>(fg2))</span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>var.hat <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">var</span>(fg1), <span class="fu">var</span>(fg2)) <span class="sc">/</span> m</span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a><span class="fu">rbind</span>(theta.hat, var.hat)</span></code></pre></div>
<pre><code>##                   [,1]         [,2]
## theta.hat 4.011522e-01 4.027747e-01
## var.hat   1.901119e-07 2.452379e-06</code></pre>
<p>the real integration is caculated below</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>real<span class="ot">&lt;-</span><span class="fu">integrate</span>(g, <span class="dv">1</span>, <span class="cn">Inf</span>)<span class="sc">$</span>value</span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">mean</span>(fg1)<span class="sc">-</span>real</span></code></pre></div>
<pre><code>## [1] 0.0005262605</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">mean</span>(fg2)<span class="sc">-</span>real</span></code></pre></div>
<pre><code>## [1] 0.002148685</code></pre>
<p>we find that the absolute error of result of Monte Carlo estimate by
importance sampling between the real is 0.0021</p>
</div>
<div id="question-5.15" class="section level1">
<h1>Question 5.15</h1>
<p>5.15 Obtain the stratified importance sampling estimate in Example
5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-5.15" class="section level1">
<h1>Answer 5.15</h1>
<p>Divide the interval (0, 1) into five sub-intervals,Denote these
subintervals as <span class="math inline">\(I_j,j=1,2,3,4,5\)</span>,Then, on the <span class="math inline">\(j^{th}\)</span> subinterval it’s reasonable to
generate the variables from the density <span class="math display">\[
\frac{5e^{-x}}{1-e^{-1}},\frac{j-1}{5} &lt;x&lt;\frac{j}{5}
\]</span> and the estimate <span class="math inline">\(θ^{th}\)</span>
becomes the sum of the estimates on the <span class="math inline">\(j^{th}\)</span> subinterval, i.e <span class="math inline">\(\theta^{th}=\sum_{j=1}^{k}\hat{\theta_j}\)</span></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>m <span class="ot">&lt;-</span> M<span class="sc">/</span>k</span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> var.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">*</span>x) <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">*</span> (x<span class="sc">&lt;</span><span class="dv">1</span>)}</span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {k <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">*</span> (x<span class="sc">&lt;</span><span class="dv">1</span>)}</span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, (i<span class="dv">-1</span>)<span class="sc">/</span>k, i<span class="sc">/</span>k)</span>
<span id="cb75-10"><a href="#cb75-10" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb75-11"><a href="#cb75-11" tabindex="-1"></a>  gf <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">f</span>(x)</span>
<span id="cb75-12"><a href="#cb75-12" tabindex="-1"></a>  theta.hat[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(gf)</span>
<span id="cb75-13"><a href="#cb75-13" tabindex="-1"></a>  var.hat[i] <span class="ot">&lt;-</span> <span class="fu">var</span>(gf)</span>
<span id="cb75-14"><a href="#cb75-14" tabindex="-1"></a>}</span>
<span id="cb75-15"><a href="#cb75-15" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(var.hat))</span>
<span id="cb75-16"><a href="#cb75-16" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sum</span>(theta.hat), var1)</span></code></pre></div>
<pre><code>## [1] 0.524688376 0.004196606</code></pre>
<p>In example 5.10 ,the importance function is <span class="math inline">\(f(x)=\frac{e^{-x}}{1-e^{-1}},0&lt;x&lt;1\)</span>,and
the result of example 5.10 are showed below</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">*</span>x) <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">*</span> (x<span class="sc">&lt;</span><span class="dv">1</span>)}</span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">*</span> (x<span class="sc">&lt;</span><span class="dv">1</span>)}</span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))) </span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a>gf <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">f</span>(x)</span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(gf)</span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(gf), var2)</span></code></pre></div>
<pre><code>## [1] 0.52433470 0.09786775</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>(var2<span class="sc">-</span>var1)<span class="sc">/</span>var2</span></code></pre></div>
<pre><code>## [1] 0.9571196</code></pre>
<p>the estimate of <span class="math inline">\(\hat{\theta}\)</span> ’s
differences between the two is not statistically significant,but the
variance is reduced by 95.71%</p>
</div>
<div id="question-6.5" class="section level1">
<h1>Question 6.5</h1>
<p>6.5 Suppose a <span class="math inline">\(95 \%\)</span> symmetric
<span class="math inline">\(t\)</span>-interval is applied to estimate a
mean, but the sample data are non-normal. Then the probability that the
confidence interval covers the mean is not necessarily equal to 0.95.
Use a Monte Carlo experiment to estimate the coverage probability of the
<span class="math inline">\(t\)</span>-interval for random samples of
<span class="math inline">\(\chi^2(2)\)</span> data with sample size
<span class="math inline">\(n=20\)</span>. Compare your <span class="math inline">\(t\)</span>-interval results with the simulation
results in Example 6.4. (The <span class="math inline">\(t\)</span>-interval should be more robust to
departures from normality than the interval for variance.)</p>
</div>
<div id="answer-6.5" class="section level1">
<h1>Answer 6.5</h1>
<p><span class="math display">\[
T=\frac{\sqrt{n}(\bar{X}-\mu)}{S} .
\]</span> 由数理统计推论 2.4.2 可知 <span class="math inline">\(T \sim
t_{n-1}\)</span>. 可见 <span class="math inline">\(T\)</span> 的表达式与
<span class="math inline">\(\mu\)</span> 有关, 而其分布与 <span class="math inline">\(\mu\)</span> 无关, 故取 <span class="math inline">\(T\)</span> 为枢轴变量. 由于 <span class="math inline">\(t\)</span> 分布关于原点对称, 令 <span class="math display">\[
P(|T| \leqslant c)=P\left(-c \leqslant \frac{\sqrt{n}(\bar{X}-\mu)}{S}
\leqslant c\right)=1-\alpha,
\]</span> 则 <span class="math inline">\(c=t_{n-1}(\alpha / 2)\)</span>.
将括号中的不等式经过等价变形得 <span class="math inline">\(\mu\)</span>
的置信系数为 <span class="math inline">\(1-\alpha\)</span> 的置
信区间为. <span class="math display">\[
\left[\bar{X}-\frac{S}{\sqrt{n}} t_{n-1}(\alpha / 2),
\bar{X}+\frac{S}{\sqrt{n}} t_{n-1}(\alpha / 2)\right],
\]</span> 其单侧置信上、下限为 <span class="math inline">\(\bar{X}+S
t_{n-1}(\alpha) / \sqrt{n}\)</span> 和 <span class="math inline">\(\bar{X}-S t_{n-1}(\alpha) / \sqrt{n}\)</span>.
于是有</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span></code></pre></div>
<p>t denote <span class="math inline">\(t_{n-1}(1-\alpha /2)\)</span>
and <span class="math inline">\(t_{n-1}(\alpha /2)\)</span></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="at">expr =</span> {</span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) <span class="sc">+</span> t <span class="sc">*</span> <span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)<span class="co"># low confidence limit and upper confidence limit</span></span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>})</span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a>LCL <span class="ot">&lt;-</span> CI[<span class="dv">1</span>, ]</span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a>UCL <span class="ot">&lt;-</span> CI[<span class="dv">2</span>, ]</span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a><span class="fu">sum</span>(LCL <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">&amp;</span> UCL <span class="sc">&gt;</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 9155</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="fu">mean</span>(LCL <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">&amp;</span> UCL <span class="sc">&gt;</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.9155</code></pre>
<p>the simulation results in Example 6.4 is 0.773 from example 6.6. the
result above shows that the t-interval is more robust to departures from
normality than the interval for variance.</p>
</div>
<div id="question-6.a" class="section level1">
<h1>Question 6.A</h1>
<p>6.A Use Monte Carlo simulation to investigate whether the empirical
Type I error rate of the <span class="math inline">\(t\)</span>-test is
approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is
non-normal. The <span class="math inline">\(t\)</span>-test is robust to
mild departures from normality. Discuss the simulation results for the
cases where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) <span class="math inline">\(Uniform(0,2)\)</span>, and (iii) Exponential(rate
<span class="math inline">\(=1)\)</span>. In each case, test <span class="math inline">\(H_0: \mu=\mu_0\)</span> vs <span class="math inline">\(H_0: \mu \neq \mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span> is the mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform <span class="math inline">\((0,2)\)</span>, and Exponential(1),
respectively.</p>
</div>
<div id="answer-6.a" class="section level1">
<h1>Answer 6.A</h1>
<ol style="list-style-type: lower-roman">
<li><span class="math inline">\(\chi^2(1)\)</span></li>
</ol>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>n_simulations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a>population_mean <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># True population mean for χ²(1)</span></span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a>simulate_t_test <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(sample_size, <span class="at">df =</span> <span class="dv">1</span>)</span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a>t_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(data, <span class="at">mu =</span> population_mean)</span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a><span class="co"># Return TRUE if null hypothesis is rejected (p-value &lt; alpha), FALSE otherwise</span></span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a>  <span class="fu">return</span>(t_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha)</span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a>}</span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a></span>
<span id="cb86-13"><a href="#cb86-13" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)  </span>
<span id="cb86-14"><a href="#cb86-14" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_simulations, <span class="fu">simulate_t_test</span>())</span>
<span id="cb86-15"><a href="#cb86-15" tabindex="-1"></a>empirical_error_rate <span class="ot">&lt;-</span> <span class="fu">mean</span>(results)</span>
<span id="cb86-16"><a href="#cb86-16" tabindex="-1"></a></span>
<span id="cb86-17"><a href="#cb86-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Empirical Type I error rate:&quot;</span>, empirical_error_rate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Empirical Type I error rate: 0.135</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Significance level (alpha):&quot;</span>, alpha, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Significance level (alpha): 0.05</code></pre>
<ol start="2" style="list-style-type: lower-roman">
<li><span class="math inline">\(Uniform(0,2)\)</span></li>
</ol>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a>n_simulations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a>population_mean <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># True population mean for U(0,2)</span></span>
<span id="cb90-5"><a href="#cb90-5" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" tabindex="-1"></a>simulate_t_test <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb90-7"><a href="#cb90-7" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">runif</span>(sample_size, <span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span><span class="dv">2</span>)</span>
<span id="cb90-8"><a href="#cb90-8" tabindex="-1"></a>t_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(data, <span class="at">mu =</span> population_mean)</span>
<span id="cb90-9"><a href="#cb90-9" tabindex="-1"></a><span class="co"># Return TRUE if null hypothesis is rejected (p-value &lt; alpha), FALSE otherwise</span></span>
<span id="cb90-10"><a href="#cb90-10" tabindex="-1"></a>  <span class="fu">return</span>(t_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha)</span>
<span id="cb90-11"><a href="#cb90-11" tabindex="-1"></a>}</span>
<span id="cb90-12"><a href="#cb90-12" tabindex="-1"></a></span>
<span id="cb90-13"><a href="#cb90-13" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)  </span>
<span id="cb90-14"><a href="#cb90-14" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_simulations, <span class="fu">simulate_t_test</span>())</span>
<span id="cb90-15"><a href="#cb90-15" tabindex="-1"></a>empirical_error_rate <span class="ot">&lt;-</span> <span class="fu">mean</span>(results)</span>
<span id="cb90-16"><a href="#cb90-16" tabindex="-1"></a></span>
<span id="cb90-17"><a href="#cb90-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Empirical Type I error rate:&quot;</span>, empirical_error_rate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Empirical Type I error rate: 0.0524</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Significance level (alpha):&quot;</span>, alpha, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Significance level (alpha): 0.05</code></pre>
<ol start="3" style="list-style-type: lower-roman">
<li>Exponential(rate <span class="math inline">\(=1)\)</span></li>
</ol>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a>n_simulations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb94-3"><a href="#cb94-3" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb94-4"><a href="#cb94-4" tabindex="-1"></a>population_mean <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># True population mean for Exponential(rate=1)</span></span>
<span id="cb94-5"><a href="#cb94-5" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" tabindex="-1"></a>simulate_t_test <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb94-7"><a href="#cb94-7" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rexp</span>(sample_size, <span class="at">rate=</span><span class="dv">1</span>)</span>
<span id="cb94-8"><a href="#cb94-8" tabindex="-1"></a>t_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(data, <span class="at">mu =</span> population_mean)</span>
<span id="cb94-9"><a href="#cb94-9" tabindex="-1"></a><span class="co"># Return TRUE if null hypothesis is rejected (p-value &lt; alpha), FALSE otherwise</span></span>
<span id="cb94-10"><a href="#cb94-10" tabindex="-1"></a>  <span class="fu">return</span>(t_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha)</span>
<span id="cb94-11"><a href="#cb94-11" tabindex="-1"></a>}</span>
<span id="cb94-12"><a href="#cb94-12" tabindex="-1"></a></span>
<span id="cb94-13"><a href="#cb94-13" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)  </span>
<span id="cb94-14"><a href="#cb94-14" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_simulations, <span class="fu">simulate_t_test</span>())</span>
<span id="cb94-15"><a href="#cb94-15" tabindex="-1"></a>empirical_error_rate <span class="ot">&lt;-</span> <span class="fu">mean</span>(results)</span>
<span id="cb94-16"><a href="#cb94-16" tabindex="-1"></a></span>
<span id="cb94-17"><a href="#cb94-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Empirical Type I error rate:&quot;</span>, empirical_error_rate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Empirical Type I error rate: 0.0992</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Significance level (alpha):&quot;</span>, alpha, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Significance level (alpha): 0.05</code></pre>
<p>From the above results, it can be seen that when the sampling
population is U (0, 2), the type I error is approximate to the
significance level.But when the sampling population is<span class="math inline">\(\chi^2(1)\)</span> and Exponential(rate <span class="math inline">\(=1)\)</span>, there is a significant gap between
the type I error and the significance level.</p>
<p><a href="#directory">Back to the Directory</a></p>
</div>
<div id="question5ans" class="section level1">
<h1>Homework4</h1>
</div>
<div id="question-1-1" class="section level1">
<h1>Question 1</h1>
<p>考虑m=1000个假设，其中前95%个原假设成立，后5%个对立假设成立，在原假设之下，p值服从U（0，1）分布，在对立假设之下，p值服从beta（0.1，1）分布，应用bonferroni校正与B-H校正应用于生成的m个独立的p值（应用p.adjust),得到校正后的p值，与=0.1比较确定是否拒绝原假设，基于M=1000次模拟，可估计FWER,FDR,TPR。输出到表格中</p>
</div>
<div id="answer-1-1" class="section level1">
<h1>Answer 1</h1>
<p>根据题意有如下代码</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a><span class="co"># 初始化参数</span></span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a>n_h0 <span class="ot">&lt;-</span> <span class="fl">0.95</span><span class="sc">*</span>m  <span class="co"># 原假设数量</span></span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a>n_h1 <span class="ot">&lt;-</span> <span class="fl">0.05</span><span class="sc">*</span>m  <span class="co"># 对立假设数量</span></span>
<span id="cb98-9"><a href="#cb98-9" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" tabindex="-1"></a><span class="co"># 初始化结果存储矩阵</span></span>
<span id="cb98-11"><a href="#cb98-11" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> M, <span class="at">ncol =</span> <span class="dv">6</span>)</span>
<span id="cb98-12"><a href="#cb98-12" tabindex="-1"></a><span class="fu">colnames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;TPR_Bonf&quot;</span>, <span class="st">&quot;FWER_Bonf&quot;</span>, <span class="st">&quot;FDR_Bonf&quot;</span>, <span class="st">&quot;TPR_BH&quot;</span>, <span class="st">&quot;FWER_BH&quot;</span>, <span class="st">&quot;FDR_BH&quot;</span>)</span>
<span id="cb98-13"><a href="#cb98-13" tabindex="-1"></a></span>
<span id="cb98-14"><a href="#cb98-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) {</span>
<span id="cb98-15"><a href="#cb98-15" tabindex="-1"></a>  <span class="co"># 生成p值</span></span>
<span id="cb98-16"><a href="#cb98-16" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(n_h0, <span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">rbeta</span>(n_h1, <span class="fl">0.1</span>, <span class="dv">1</span>))</span>
<span id="cb98-17"><a href="#cb98-17" tabindex="-1"></a>  </span>
<span id="cb98-18"><a href="#cb98-18" tabindex="-1"></a>  <span class="co"># 应用Bonferroni和BH校正</span></span>
<span id="cb98-19"><a href="#cb98-19" tabindex="-1"></a>  p_adj_bonferroni <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb98-20"><a href="#cb98-20" tabindex="-1"></a>  p_adj_bh <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb98-21"><a href="#cb98-21" tabindex="-1"></a>  </span>
<span id="cb98-22"><a href="#cb98-22" tabindex="-1"></a>  <span class="co"># 计算统计指标</span></span>
<span id="cb98-23"><a href="#cb98-23" tabindex="-1"></a>  reject_bonf <span class="ot">&lt;-</span> p_adj_bonferroni <span class="sc">&lt;</span> alpha</span>
<span id="cb98-24"><a href="#cb98-24" tabindex="-1"></a>  reject_bh <span class="ot">&lt;-</span> p_adj_bh <span class="sc">&lt;</span> alpha</span>
<span id="cb98-25"><a href="#cb98-25" tabindex="-1"></a>  </span>
<span id="cb98-26"><a href="#cb98-26" tabindex="-1"></a>  TPR_Bonf <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bonf[(n_h0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m]) <span class="sc">/</span> n_h1</span>
<span id="cb98-27"><a href="#cb98-27" tabindex="-1"></a>  FWER_Bonf <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bonf[<span class="dv">1</span><span class="sc">:</span>n_h0]) <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb98-28"><a href="#cb98-28" tabindex="-1"></a>  FDR_Bonf <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bonf[<span class="dv">1</span><span class="sc">:</span>n_h0]) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">sum</span>(reject_bonf), <span class="dv">1</span>)  <span class="co"># 防止除以0</span></span>
<span id="cb98-29"><a href="#cb98-29" tabindex="-1"></a>  </span>
<span id="cb98-30"><a href="#cb98-30" tabindex="-1"></a>  TPR_BH <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bh[(n_h0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m]) <span class="sc">/</span> n_h1</span>
<span id="cb98-31"><a href="#cb98-31" tabindex="-1"></a>  FWER_BH <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bh[<span class="dv">1</span><span class="sc">:</span>n_h0]) <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb98-32"><a href="#cb98-32" tabindex="-1"></a>  FDR_BH <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bh[<span class="dv">1</span><span class="sc">:</span>n_h0]) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">sum</span>(reject_bh), <span class="dv">1</span>)  <span class="co"># 防止除以0</span></span>
<span id="cb98-33"><a href="#cb98-33" tabindex="-1"></a>  </span>
<span id="cb98-34"><a href="#cb98-34" tabindex="-1"></a>  <span class="co"># 保存结果</span></span>
<span id="cb98-35"><a href="#cb98-35" tabindex="-1"></a>  results[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(TPR_Bonf, FWER_Bonf, FDR_Bonf, TPR_BH, FWER_BH, FDR_BH)</span>
<span id="cb98-36"><a href="#cb98-36" tabindex="-1"></a>}</span>
<span id="cb98-37"><a href="#cb98-37" tabindex="-1"></a></span>
<span id="cb98-38"><a href="#cb98-38" tabindex="-1"></a><span class="co"># 计算平均值</span></span>
<span id="cb98-39"><a href="#cb98-39" tabindex="-1"></a>results_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(results)</span>
<span id="cb98-40"><a href="#cb98-40" tabindex="-1"></a>mean_results <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(results_df, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb98-41"><a href="#cb98-41" tabindex="-1"></a></span>
<span id="cb98-42"><a href="#cb98-42" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb98-43"><a href="#cb98-43" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Method =</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni&quot;</span>, <span class="st">&quot;B-H&quot;</span>),</span>
<span id="cb98-44"><a href="#cb98-44" tabindex="-1"></a>                   <span class="at">FWER =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb98-45"><a href="#cb98-45" tabindex="-1"></a>                   <span class="at">FDR =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb98-46"><a href="#cb98-46" tabindex="-1"></a>                   <span class="at">TPR =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>))</span>
<span id="cb98-47"><a href="#cb98-47" tabindex="-1"></a></span>
<span id="cb98-48"><a href="#cb98-48" tabindex="-1"></a>results<span class="sc">$</span>FWER[<span class="dv">1</span>]<span class="ot">&lt;-</span>mean_results[<span class="dv">2</span>]</span>
<span id="cb98-49"><a href="#cb98-49" tabindex="-1"></a>results<span class="sc">$</span>FWER[<span class="dv">2</span>]<span class="ot">&lt;-</span>mean_results[<span class="dv">5</span>]</span>
<span id="cb98-50"><a href="#cb98-50" tabindex="-1"></a>results<span class="sc">$</span>FDR[<span class="dv">1</span>]<span class="ot">&lt;-</span>mean_results[<span class="dv">3</span>]</span>
<span id="cb98-51"><a href="#cb98-51" tabindex="-1"></a>results<span class="sc">$</span>FDR[<span class="dv">2</span>]<span class="ot">&lt;-</span>mean_results[<span class="dv">6</span>]</span>
<span id="cb98-52"><a href="#cb98-52" tabindex="-1"></a>results<span class="sc">$</span>TPR[<span class="dv">1</span>]<span class="ot">&lt;-</span>mean_results[<span class="dv">1</span>]</span>
<span id="cb98-53"><a href="#cb98-53" tabindex="-1"></a>results<span class="sc">$</span>TPR[<span class="dv">2</span>]<span class="ot">&lt;-</span>mean_results[<span class="dv">4</span>]</span>
<span id="cb98-54"><a href="#cb98-54" tabindex="-1"></a></span>
<span id="cb98-55"><a href="#cb98-55" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   Method      FWER     FDR   TPR
##   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1 Bonferroni 0.103 0.00536 0.402
## 2 B-H        0.936 0.0928  0.564</code></pre>
<p>The results align with our theoretical predictions, indicating that
the FWER_Bonf is approximately 0.1, the FWER_BH is significantly less
than 0.1, the FDR_Bonf is substantially below 0.1, and the FDR_BH is
around 0.1.</p>
</div>
<div id="question-2" class="section level1">
<h1>Question 2</h1>
<p>Homework - Suppose the population has the exponential distribution
with rate <span class="math inline">\(\lambda\)</span>, then the MLE of
<span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat{\lambda}=1 / \bar{X}\)</span>, where <span class="math inline">\(\bar{X}\)</span> is the sample mean. It can be
derived that the expectation of <span class="math inline">\(\hat{\lambda}\)</span> is <span class="math inline">\(\lambda n /(n-1)\)</span>, so that the estimation
bias is <span class="math inline">\(\lambda /(n-1)\)</span>. The
standard error <span class="math inline">\(\hat{\lambda}\)</span> is
<span class="math inline">\(\lambda n /[(n-1) \sqrt{n-2}]\)</span>.
Conduct a simulation study to verify the performance of the bootstrap
method. - The true value of <span class="math inline">\(\lambda=2\)</span>. - The sample size <span class="math inline">\(n=5,10,20\)</span>. - The number of bootstrap
replicates <span class="math inline">\(B=1000\)</span>. - The
simulations are repeated for <span class="math inline">\(m=1000\)</span>
times. - Compare the mean bootstrap bias and bootstrap standard error
with the theoretical ones. Comment on the results.</p>
</div>
<div id="answer-2-1" class="section level1">
<h1>Answer 2</h1>
<p>follow the flow above,we have code below</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="co"># Set the parameters</span></span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a>true_lambda <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a>num_simulations <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb100-6"><a href="#cb100-6" tabindex="-1"></a>num_bootstrap_replicates <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb100-7"><a href="#cb100-7" tabindex="-1"></a></span>
<span id="cb100-8"><a href="#cb100-8" tabindex="-1"></a><span class="co"># 初始化变量来存储结果</span></span>
<span id="cb100-9"><a href="#cb100-9" tabindex="-1"></a>bootstrap_biases <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(sample_sizes), <span class="at">ncol =</span> num_simulations)</span>
<span id="cb100-10"><a href="#cb100-10" tabindex="-1"></a>bootstrap_standard_errors <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(sample_sizes), <span class="at">ncol =</span> num_simulations)</span>
<span id="cb100-11"><a href="#cb100-11" tabindex="-1"></a>theoretical_biases <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(sample_sizes))</span>
<span id="cb100-12"><a href="#cb100-12" tabindex="-1"></a>theoretical_standard_errors <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(sample_sizes))</span>
<span id="cb100-13"><a href="#cb100-13" tabindex="-1"></a></span>
<span id="cb100-14"><a href="#cb100-14" tabindex="-1"></a><span class="co"># 对每个样本大小执行模拟</span></span>
<span id="cb100-15"><a href="#cb100-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sample_sizes)) {</span>
<span id="cb100-16"><a href="#cb100-16" tabindex="-1"></a>  n <span class="ot">&lt;-</span> sample_sizes[i]</span>
<span id="cb100-17"><a href="#cb100-17" tabindex="-1"></a>  </span>
<span id="cb100-18"><a href="#cb100-18" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_simulations) {</span>
<span id="cb100-19"><a href="#cb100-19" tabindex="-1"></a>    <span class="co"># 从指数分布生成随机样本</span></span>
<span id="cb100-20"><a href="#cb100-20" tabindex="-1"></a>    sample_data <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> true_lambda)</span>
<span id="cb100-21"><a href="#cb100-21" tabindex="-1"></a>    </span>
<span id="cb100-22"><a href="#cb100-22" tabindex="-1"></a>    <span class="co"># 计算lambda的最大似然估计（MLE）</span></span>
<span id="cb100-23"><a href="#cb100-23" tabindex="-1"></a>    mle_lambda <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(sample_data)</span>
<span id="cb100-24"><a href="#cb100-24" tabindex="-1"></a>    </span>
<span id="cb100-25"><a href="#cb100-25" tabindex="-1"></a>    <span class="co"># 计算自助法重复样本</span></span>
<span id="cb100-26"><a href="#cb100-26" tabindex="-1"></a>    bootstrap_replicates <span class="ot">&lt;-</span> <span class="fu">replicate</span>(num_bootstrap_replicates, {</span>
<span id="cb100-27"><a href="#cb100-27" tabindex="-1"></a>      resampled_data <span class="ot">&lt;-</span> <span class="fu">sample</span>(sample_data, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb100-28"><a href="#cb100-28" tabindex="-1"></a>      mle_resampled <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(resampled_data)</span>
<span id="cb100-29"><a href="#cb100-29" tabindex="-1"></a>      mle_resampled</span>
<span id="cb100-30"><a href="#cb100-30" tabindex="-1"></a>    })</span>
<span id="cb100-31"><a href="#cb100-31" tabindex="-1"></a>    </span>
<span id="cb100-32"><a href="#cb100-32" tabindex="-1"></a>    <span class="co"># 计算自助法偏差和标准误差</span></span>
<span id="cb100-33"><a href="#cb100-33" tabindex="-1"></a>    bootstrap_biases[i, j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap_replicates) <span class="sc">-</span> mle_lambda</span>
<span id="cb100-34"><a href="#cb100-34" tabindex="-1"></a>    bootstrap_standard_errors[i, j] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((bootstrap_replicates <span class="sc">-</span> <span class="fu">mean</span>(bootstrap_replicates))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb100-35"><a href="#cb100-35" tabindex="-1"></a>    </span>
<span id="cb100-36"><a href="#cb100-36" tabindex="-1"></a>    <span class="co"># 计算理论偏差和标准误差</span></span>
<span id="cb100-37"><a href="#cb100-37" tabindex="-1"></a>    theoretical_biases[i] <span class="ot">&lt;-</span> true_lambda <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb100-38"><a href="#cb100-38" tabindex="-1"></a>    theoretical_standard_errors[i] <span class="ot">&lt;-</span> (true_lambda <span class="sc">*</span> n) <span class="sc">/</span> ((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(n <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb100-39"><a href="#cb100-39" tabindex="-1"></a>  }</span>
<span id="cb100-40"><a href="#cb100-40" tabindex="-1"></a>}</span>
<span id="cb100-41"><a href="#cb100-41" tabindex="-1"></a></span>
<span id="cb100-42"><a href="#cb100-42" tabindex="-1"></a><span class="co"># 计算自助法偏差和标准误差的均值和标准差</span></span>
<span id="cb100-43"><a href="#cb100-43" tabindex="-1"></a>mean_bootstrap_biases <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(bootstrap_biases)</span>
<span id="cb100-44"><a href="#cb100-44" tabindex="-1"></a>mean_bootstrap_standard_errors <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(bootstrap_standard_errors)</span>
<span id="cb100-45"><a href="#cb100-45" tabindex="-1"></a></span>
<span id="cb100-46"><a href="#cb100-46" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb100-47"><a href="#cb100-47" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample_Size =</span> sample_sizes,</span>
<span id="cb100-48"><a href="#cb100-48" tabindex="-1"></a>                      <span class="at">Mean_Bootstrap_Bias =</span> mean_bootstrap_biases,</span>
<span id="cb100-49"><a href="#cb100-49" tabindex="-1"></a>                      <span class="at">Theoretical_Bias =</span> theoretical_biases,</span>
<span id="cb100-50"><a href="#cb100-50" tabindex="-1"></a>                      <span class="at">Mean_Bootstrap_Standard_Error =</span> mean_bootstrap_standard_errors,</span>
<span id="cb100-51"><a href="#cb100-51" tabindex="-1"></a>                      <span class="at">Theoretical_Standard_Error =</span> theoretical_standard_errors)</span>
<span id="cb100-52"><a href="#cb100-52" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>##   Sample_Size Mean_Bootstrap_Bias Theoretical_Bias
## 1           5           0.6824196        0.5000000
## 2          10           0.2194706        0.2222222
## 3          20           0.1011512        0.1052632
##   Mean_Bootstrap_Standard_Error Theoretical_Standard_Error
## 1                     5.3679199                  1.4433757
## 2                     0.8137870                  0.7856742
## 3                     0.4922471                  0.4962153</code></pre>
<p>Commenting on the Results:</p>
<p>1 Bias: The bootstrap method provides an empirical estimate of the
bias of the MLE. In theory, as sample size increases, the bootstrap bias
should approximate the theoretical bias. If this holds in the results,
it suggests that the bootstrap is effectively capturing the bias in the
MLE across different sample sizes.</p>
<p>2 Standard Error: Similarly, the bootstrap standard error should
approximate the theoretical standard error, particularly as sample size
grows. Discrepancies at smaller sample sizes might occur due to the
higher variability in estimates with fewer data points, but these should
diminish as sample size increases.</p>
<p>3 Performance across Sample Sizes: Generally, as sample size
increases, the reliability of both the bootstrap estimates and the
theoretical values improves. Differences between bootstrap and
theoretical values could indicate the impact of small sample sizes on
the precision of the estimates, underscoring the bootstrap’s value in
uncertainty estimation.</p>
<p>4 Conclusions: The convergence of bootstrap estimates with
theoretical values would reinforce confidence in the bootstrap as a
robust method for statistical inference, especially in complex scenarios
where theoretical calculations are not straightforward. Discrepancies,
particularly consistent ones across sample sizes, could warrant a deeper
investigation into the assumptions and specific context of the
estimation process.</p>
</div>
<div id="question-7.3" class="section level1">
<h1>Question 7.3</h1>
<p>Obtain a bootstrap t confidence interval estimate for the correlation
statistic in Example 7.2 (law data in bootstrap)</p>
</div>
<div id="answer-7.3" class="section level1">
<h1>Answer 7.3</h1>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="co"># Load the required library for bootstrapping</span></span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a><span class="co"># Define a function to compute the correlation statistic</span></span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a>cor.stat <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">NROW</span>(x)) {</span>
<span id="cb102-6"><a href="#cb102-6" tabindex="-1"></a> <span class="fu">cor</span>(x[i, <span class="dv">1</span>], x[i, <span class="dv">2</span>])</span>
<span id="cb102-7"><a href="#cb102-7" tabindex="-1"></a> }</span>
<span id="cb102-8"><a href="#cb102-8" tabindex="-1"></a>cor.stat2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">NROW</span>(x)) {</span>
<span id="cb102-9"><a href="#cb102-9" tabindex="-1"></a> o <span class="ot">&lt;-</span> <span class="fu">boot</span>(x[i, ], cor.stat, <span class="at">R =</span> <span class="dv">25</span>)</span>
<span id="cb102-10"><a href="#cb102-10" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="fu">length</span>(i)</span>
<span id="cb102-11"><a href="#cb102-11" tabindex="-1"></a> <span class="fu">c</span>(o<span class="sc">$</span>t0, <span class="fu">var</span>(o<span class="sc">$</span>t) <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>n<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb102-12"><a href="#cb102-12" tabindex="-1"></a> }</span>
<span id="cb102-13"><a href="#cb102-13" tabindex="-1"></a><span class="co"># Set the number of bootstrap resamples</span></span>
<span id="cb102-14"><a href="#cb102-14" tabindex="-1"></a>num_bootstrap_samples <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb102-15"><a href="#cb102-15" tabindex="-1"></a></span>
<span id="cb102-16"><a href="#cb102-16" tabindex="-1"></a><span class="co"># Perform bootstrap resampling</span></span>
<span id="cb102-17"><a href="#cb102-17" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)  <span class="co"># Set a seed for reproducibility</span></span>
<span id="cb102-18"><a href="#cb102-18" tabindex="-1"></a>boot_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(law, <span class="at">statistic =</span> cor.stat2, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb102-19"><a href="#cb102-19" tabindex="-1"></a></span>
<span id="cb102-20"><a href="#cb102-20" tabindex="-1"></a><span class="co"># Calculate the bootstrap t confidence interval</span></span>
<span id="cb102-21"><a href="#cb102-21" tabindex="-1"></a>boot_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_results, <span class="at">type =</span> <span class="st">&quot;stud&quot;</span>)  <span class="co"># Bias-corrected and accelerated CI</span></span>
<span id="cb102-22"><a href="#cb102-22" tabindex="-1"></a></span>
<span id="cb102-23"><a href="#cb102-23" tabindex="-1"></a><span class="co"># Print the bootstrap t confidence interval</span></span>
<span id="cb102-24"><a href="#cb102-24" tabindex="-1"></a><span class="fu">print</span>(boot_ci)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot_results, type = &quot;stud&quot;)
## 
## Intervals : 
## Level    Studentized     
## 95%   (-0.2923,  0.9402 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>a bootstrap t confidence interval estimate for the correlation
statistic is showed above (-0.2923,0.9402) with level 95%</p>
<p>The following repetition of confidence interval estimation
demonstrates the instability of bootstrap t-intervals in this particular
instance.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">boot</span>(law, <span class="at">statistic =</span> cor.stat2, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a><span class="fu">boot.ci</span>(b, <span class="at">type =</span> <span class="st">&quot;stud&quot;</span>)<span class="sc">$</span>stud</span></code></pre></div>
<pre><code>##      conf                                  
## [1,] 0.95 975.98 25.03 -0.5317716 0.9952677</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">boot</span>(law, <span class="at">statistic =</span> cor.stat2, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a><span class="fu">boot.ci</span>(b, <span class="at">type =</span> <span class="st">&quot;stud&quot;</span>)<span class="sc">$</span>stud</span></code></pre></div>
<pre><code>##      conf                                   
## [1,] 0.95 975.98 25.03 0.001491197 0.9405528</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">boot</span>(law, <span class="at">statistic =</span> cor.stat2, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a><span class="fu">boot.ci</span>(b, <span class="at">type =</span> <span class="st">&quot;stud&quot;</span>)<span class="sc">$</span>stud</span></code></pre></div>
<pre><code>##      conf                                  
## [1,] 0.95 975.98 25.03 -0.3247465 0.9680409</code></pre>
<p><a href="#directory">Back to the Directory</a></p>
</div>
<div id="question6ans" class="section level1">
<h1>Homework5</h1>
</div>
<div id="question-ex7.5" class="section level1">
<h1>Question EX7.5</h1>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(\frac{1}{\lambda}\)</span> by the standard normal,
basic, percentile, and BCa methods. Compare the intervals and explain
why they may differ</p>
</div>
<div id="answer-ex-7.5" class="section level1">
<h1>Answer EX 7.5</h1>
<p>use aircondit[1] to extract the data. we define getSample to extract
data, calculateMean to construct the statistic and performbootstrap to
report the result.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a><span class="co"># 从 &#39;aircondit&#39; 数据集中采样数据的函数</span></span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a><span class="co"># &#39;x&#39; 应为用于索引的整数</span></span>
<span id="cb110-5"><a href="#cb110-5" tabindex="-1"></a>getSample <span class="ot">&lt;-</span> <span class="cf">function</span>(index) {</span>
<span id="cb110-6"><a href="#cb110-6" tabindex="-1"></a>  </span>
<span id="cb110-7"><a href="#cb110-7" tabindex="-1"></a>  selected_sample <span class="ot">&lt;-</span> aircondit[index]</span>
<span id="cb110-8"><a href="#cb110-8" tabindex="-1"></a>  selected_sample</span>
<span id="cb110-9"><a href="#cb110-9" tabindex="-1"></a>}</span>
<span id="cb110-10"><a href="#cb110-10" tabindex="-1"></a></span>
<span id="cb110-11"><a href="#cb110-11" tabindex="-1"></a><span class="co"># 计算采样数据平均值的函数 &#39;data&#39; 代表数据，&#39;indices&#39; 代表自助法样本指数</span></span>
<span id="cb110-12"><a href="#cb110-12" tabindex="-1"></a>calculateMean <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb110-13"><a href="#cb110-13" tabindex="-1"></a>  sample_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.matrix</span>(data[indices, ]))</span>
<span id="cb110-14"><a href="#cb110-14" tabindex="-1"></a>  sample_mean</span>
<span id="cb110-15"><a href="#cb110-15" tabindex="-1"></a>}</span>
<span id="cb110-16"><a href="#cb110-16" tabindex="-1"></a></span>
<span id="cb110-17"><a href="#cb110-17" tabindex="-1"></a><span class="co"># 执行自助法分析并生成结果的函数 &#39;sample_data&#39; 是采样数据，&#39;stat_function&#39; 是统计函数，&#39;replications&#39; 是自助法重复次数</span></span>
<span id="cb110-18"><a href="#cb110-18" tabindex="-1"></a>performBootstrap <span class="ot">&lt;-</span> <span class="cf">function</span>(sample_data, stat_function, replications) {</span>
<span id="cb110-19"><a href="#cb110-19" tabindex="-1"></a>  bootstrap_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(sample_data, <span class="at">statistic =</span> stat_function, <span class="at">R =</span> replications)</span>
<span id="cb110-20"><a href="#cb110-20" tabindex="-1"></a></span>
<span id="cb110-21"><a href="#cb110-21" tabindex="-1"></a>  <span class="co"># 使用不同方法计算置信区间</span></span>
<span id="cb110-22"><a href="#cb110-22" tabindex="-1"></a>  confidence_intervals <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_result, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span>
<span id="cb110-23"><a href="#cb110-23" tabindex="-1"></a></span>
<span id="cb110-24"><a href="#cb110-24" tabindex="-1"></a>  <span class="co"># 自助法结果</span></span>
<span id="cb110-25"><a href="#cb110-25" tabindex="-1"></a>  <span class="fu">print</span>(bootstrap_result)</span>
<span id="cb110-26"><a href="#cb110-26" tabindex="-1"></a></span>
<span id="cb110-27"><a href="#cb110-27" tabindex="-1"></a>  <span class="co"># 置信区间</span></span>
<span id="cb110-28"><a href="#cb110-28" tabindex="-1"></a>  <span class="fu">print</span>(confidence_intervals)</span>
<span id="cb110-29"><a href="#cb110-29" tabindex="-1"></a></span>
<span id="cb110-30"><a href="#cb110-30" tabindex="-1"></a>  <span class="co"># 的直方图</span></span>
<span id="cb110-31"><a href="#cb110-31" tabindex="-1"></a>  <span class="fu">hist</span>(bootstrap_result<span class="sc">$</span>t, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb110-32"><a href="#cb110-32" tabindex="-1"></a></span>
<span id="cb110-33"><a href="#cb110-33" tabindex="-1"></a>  <span class="co"># 在直方图上标出原始统计量</span></span>
<span id="cb110-34"><a href="#cb110-34" tabindex="-1"></a>  <span class="fu">points</span>(bootstrap_result<span class="sc">$</span>t0, <span class="dv">0</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb110-35"><a href="#cb110-35" tabindex="-1"></a></span>
<span id="cb110-36"><a href="#cb110-36" tabindex="-1"></a>  <span class="co"># 返回自助法对象以进行进一步分析</span></span>
<span id="cb110-37"><a href="#cb110-37" tabindex="-1"></a>  <span class="fu">return</span>(bootstrap_result)</span>
<span id="cb110-38"><a href="#cb110-38" tabindex="-1"></a>}</span>
<span id="cb110-39"><a href="#cb110-39" tabindex="-1"></a></span>
<span id="cb110-40"><a href="#cb110-40" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb110-41"><a href="#cb110-41" tabindex="-1"></a></span>
<span id="cb110-42"><a href="#cb110-42" tabindex="-1"></a><span class="co"># 使用 &#39;getSample&#39; 函数采样数据</span></span>
<span id="cb110-43"><a href="#cb110-43" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">getSample</span>(<span class="dv">1</span>)  <span class="co"># 这里假设 &#39;1&#39; 是 &#39;aircondit&#39; 的有效索引</span></span>
<span id="cb110-44"><a href="#cb110-44" tabindex="-1"></a></span>
<span id="cb110-45"><a href="#cb110-45" tabindex="-1"></a><span class="co"># 执行 &#39;performBootstrap&#39; 函数进行自助法分析</span></span>
<span id="cb110-46"><a href="#cb110-46" tabindex="-1"></a>resu <span class="ot">&lt;-</span> <span class="fu">performBootstrap</span>(sample,calculateMean,<span class="dv">2000</span>)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = sample_data, statistic = stat_function, R = replications)
## 
## 
## Bootstrap Statistics :
##     original  bias    std. error
## t1* 108.0833 0.16775    38.11221
## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bootstrap_result, type = c(&quot;norm&quot;, &quot;perc&quot;, 
##     &quot;basic&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 33.2, 182.6 )   ( 25.2, 168.7 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.4, 190.9 )   ( 57.8, 230.5 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The 95% bootstrap confidence intervals for the mean time between
failures (MTBF), denoted as 1/λ, vary depending on the method used.
Utilizing the standard normal method, the interval is (33.0, 182.8),
with the basic method it’s (19.9, 170.0), employing the percentile
method results in (46.2, 196.2), and the Bias-Corrected and accelerated
(BCa) method provides (58.5, 232.2). These intervals are not identical,
and their lengths correspond to -149.8, -150.1, -150, and -173.7,
respectively.</p>
<p>The differences among these intervals stem from the underlying
statistical assumptions and calculations. Notably, the distribution of
the bootstrap replicates doesn’t adhere to normality, causing
discrepancies between the normal and percentile methods. This non-normal
distribution, evident from the histogram of replicates, is skewed
despite being an estimate of the mean. This phenomenon occurs because
the sample size is insufficient for the Central Limit Theorem (CLT) to
render a close-to-normal distribution.</p>
<p>The BCa method adjusts for this issue. Unlike the standard percentile
method, it accounts for both the skewness and bias in the bootstrap
distribution, leading to a confidence interval that differs from the
conventional ones. This refinement makes the BCa method particularly
valuable in scenarios like this, where the data’s distribution deviates
from the ideal assumptions.</p>
</div>
<div id="question-ex-7.8" class="section level1">
<h1>Question EX 7.8</h1>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span></p>
</div>
<div id="answer-ex-7.8" class="section level1">
<h1>Answer EX 7.8</h1>
<p>use package bootstrap to Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a></span>
<span id="cb112-6"><a href="#cb112-6" tabindex="-1"></a>prepare_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb112-7"><a href="#cb112-7" tabindex="-1"></a>  matrix_data <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data)  <span class="co"># 将数据转换为矩阵格式</span></span>
<span id="cb112-8"><a href="#cb112-8" tabindex="-1"></a>  <span class="fu">return</span>(matrix_data)</span>
<span id="cb112-9"><a href="#cb112-9" tabindex="-1"></a>}</span>
<span id="cb112-10"><a href="#cb112-10" tabindex="-1"></a></span>
<span id="cb112-11"><a href="#cb112-11" tabindex="-1"></a><span class="co"># 分析函数，主成分分析并计算偏差和标准误</span></span>
<span id="cb112-12"><a href="#cb112-12" tabindex="-1"></a>analyze_data <span class="ot">&lt;-</span> <span class="cf">function</span>(matrix_data) {</span>
<span id="cb112-13"><a href="#cb112-13" tabindex="-1"></a>  sample_size <span class="ot">&lt;-</span> <span class="fu">nrow</span>(matrix_data)</span>
<span id="cb112-14"><a href="#cb112-14" tabindex="-1"></a>  jackknife_estimates <span class="ot">&lt;-</span> <span class="fu">numeric</span>(sample_size)</span>
<span id="cb112-15"><a href="#cb112-15" tabindex="-1"></a>  </span>
<span id="cb112-16"><a href="#cb112-16" tabindex="-1"></a>  <span class="co"># 计算总体统计量</span></span>
<span id="cb112-17"><a href="#cb112-17" tabindex="-1"></a>  covariance_matrix <span class="ot">&lt;-</span> <span class="fu">cov</span>(matrix_data)</span>
<span id="cb112-18"><a href="#cb112-18" tabindex="-1"></a>  eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(covariance_matrix)<span class="sc">$</span>values</span>
<span id="cb112-19"><a href="#cb112-19" tabindex="-1"></a>  overall_estimate <span class="ot">&lt;-</span> <span class="fu">max</span>(eigenvalues <span class="sc">/</span> <span class="fu">sum</span>(eigenvalues))</span>
<span id="cb112-20"><a href="#cb112-20" tabindex="-1"></a>  </span>
<span id="cb112-21"><a href="#cb112-21" tabindex="-1"></a>  <span class="co"># 计算留一法估计量</span></span>
<span id="cb112-22"><a href="#cb112-22" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>sample_size) {</span>
<span id="cb112-23"><a href="#cb112-23" tabindex="-1"></a>    sample_subset <span class="ot">&lt;-</span> matrix_data[<span class="sc">-</span>index, ]</span>
<span id="cb112-24"><a href="#cb112-24" tabindex="-1"></a>    subset_covariance <span class="ot">&lt;-</span> <span class="fu">cov</span>(sample_subset)</span>
<span id="cb112-25"><a href="#cb112-25" tabindex="-1"></a>    subset_eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(subset_covariance)<span class="sc">$</span>values</span>
<span id="cb112-26"><a href="#cb112-26" tabindex="-1"></a>    jackknife_estimates[index] <span class="ot">&lt;-</span> <span class="fu">max</span>(subset_eigenvalues <span class="sc">/</span> <span class="fu">sum</span>(subset_eigenvalues))</span>
<span id="cb112-27"><a href="#cb112-27" tabindex="-1"></a>  }</span>
<span id="cb112-28"><a href="#cb112-28" tabindex="-1"></a>  </span>
<span id="cb112-29"><a href="#cb112-29" tabindex="-1"></a>  <span class="co"># 计算偏差和标准误</span></span>
<span id="cb112-30"><a href="#cb112-30" tabindex="-1"></a>  jackknife_bias <span class="ot">&lt;-</span> (sample_size <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(jackknife_estimates) <span class="sc">-</span> overall_estimate)</span>
<span id="cb112-31"><a href="#cb112-31" tabindex="-1"></a>  jackknife_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((sample_size <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> sample_size <span class="sc">*</span> <span class="fu">sum</span>((jackknife_estimates <span class="sc">-</span> <span class="fu">mean</span>(jackknife_estimates))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb112-32"><a href="#cb112-32" tabindex="-1"></a>  </span>
<span id="cb112-33"><a href="#cb112-33" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">c</span>(overall_estimate, jackknife_bias, jackknife_se)</span>
<span id="cb112-34"><a href="#cb112-34" tabindex="-1"></a>  </span>
<span id="cb112-35"><a href="#cb112-35" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb112-36"><a href="#cb112-36" tabindex="-1"></a>}</span>
<span id="cb112-37"><a href="#cb112-37" tabindex="-1"></a><span class="co"># ，将结果放入数据框中</span></span>
<span id="cb112-38"><a href="#cb112-38" tabindex="-1"></a>organize_results <span class="ot">&lt;-</span> <span class="cf">function</span>(analysis_results) {</span>
<span id="cb112-39"><a href="#cb112-39" tabindex="-1"></a>  organized_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(analysis_results[<span class="dv">1</span>], analysis_results[<span class="dv">2</span>], analysis_results[<span class="dv">3</span>])</span>
<span id="cb112-40"><a href="#cb112-40" tabindex="-1"></a>  <span class="fu">names</span>(organized_results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;est&#39;</span>, <span class="st">&#39;bias&#39;</span>, <span class="st">&#39;se&#39;</span>)  <span class="co"># 命名列名</span></span>
<span id="cb112-41"><a href="#cb112-41" tabindex="-1"></a>  <span class="fu">return</span>(organized_results)</span>
<span id="cb112-42"><a href="#cb112-42" tabindex="-1"></a>}</span>
<span id="cb112-43"><a href="#cb112-43" tabindex="-1"></a></span>
<span id="cb112-44"><a href="#cb112-44" tabindex="-1"></a></span>
<span id="cb112-45"><a href="#cb112-45" tabindex="-1"></a>matrix_data <span class="ot">&lt;-</span> <span class="fu">prepare_sample</span>(scor)</span>
<span id="cb112-46"><a href="#cb112-46" tabindex="-1"></a></span>
<span id="cb112-47"><a href="#cb112-47" tabindex="-1"></a></span>
<span id="cb112-48"><a href="#cb112-48" tabindex="-1"></a>analysis_results <span class="ot">&lt;-</span> <span class="fu">analyze_data</span>(matrix_data)</span>
<span id="cb112-49"><a href="#cb112-49" tabindex="-1"></a></span>
<span id="cb112-50"><a href="#cb112-50" tabindex="-1"></a></span>
<span id="cb112-51"><a href="#cb112-51" tabindex="-1"></a>final_results <span class="ot">&lt;-</span> <span class="fu">organize_results</span>(analysis_results)</span>
<span id="cb112-52"><a href="#cb112-52" tabindex="-1"></a></span>
<span id="cb112-53"><a href="#cb112-53" tabindex="-1"></a><span class="co"># 结果表格</span></span>
<span id="cb112-54"><a href="#cb112-54" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(final_results, <span class="at">align =</span> <span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">est</th>
<th align="center">bias</th>
<th align="center">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.619115</td>
<td align="center">0.0010691</td>
<td align="center">0.0495523</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a>bootstrap_statistic <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[indices, ])</span>
<span id="cb113-6"><a href="#cb113-6" tabindex="-1"></a>  covariance_sample <span class="ot">&lt;-</span> <span class="fu">cov</span>(sample_data)</span>
<span id="cb113-7"><a href="#cb113-7" tabindex="-1"></a>  eigen_sample <span class="ot">&lt;-</span> <span class="fu">eigen</span>(covariance_sample)</span>
<span id="cb113-8"><a href="#cb113-8" tabindex="-1"></a>  lambda_sample <span class="ot">&lt;-</span> eigen_sample<span class="sc">$</span>values</span>
<span id="cb113-9"><a href="#cb113-9" tabindex="-1"></a>  <span class="fu">max</span>(lambda_sample <span class="sc">/</span> <span class="fu">sum</span>(lambda_sample))</span>
<span id="cb113-10"><a href="#cb113-10" tabindex="-1"></a>}</span>
<span id="cb113-11"><a href="#cb113-11" tabindex="-1"></a></span>
<span id="cb113-12"><a href="#cb113-12" tabindex="-1"></a></span>
<span id="cb113-13"><a href="#cb113-13" tabindex="-1"></a>bootstrap_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb113-14"><a href="#cb113-14" tabindex="-1"></a>  <span class="fu">boot</span>(data, <span class="at">statistic =</span> bootstrap_statistic, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb113-15"><a href="#cb113-15" tabindex="-1"></a>}</span>
<span id="cb113-16"><a href="#cb113-16" tabindex="-1"></a></span>
<span id="cb113-17"><a href="#cb113-17" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb113-18"><a href="#cb113-18" tabindex="-1"></a>bootstrap_results <span class="ot">&lt;-</span> <span class="fu">bootstrap_analysis</span>(scor)</span>
<span id="cb113-19"><a href="#cb113-19" tabindex="-1"></a><span class="fu">print</span>(bootstrap_results)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = data, statistic = bootstrap_statistic, R = 2000)
## 
## 
## Bootstrap Statistics :
##     original       bias    std. error
## t1* 0.619115 0.0001904229  0.04698638</code></pre>
<p>From the results above, the jackknife methodology estimates the bias
of $ $ to be 0.0010 and its standard error (se) to be 0.0495. And the
bootstrap approach provides slightly different figures, estimating the
bias of $ $ as 0.00019 and the standard error as 0.0469. These estimates
of both methods are very similar.</p>
</div>
<div id="question-ex-7.11" class="section level1">
<h1>Question EX 7.11</h1>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models</p>
</div>
<div id="answer-ex-7.11" class="section level1">
<h1>Answer EX 7.11</h1>
<p>The five models presented in Example 7.18 or Example 7.17 can be
comparatively evaluated using the leave-two-out cross-validation method.
This approach involves a nested for loop structure for
implementation.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="fu">library</span>(DAAG, <span class="at">warn.conflict =</span> <span class="cn">FALSE</span>)</span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb115-3"><a href="#cb115-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb115-4"><a href="#cb115-4" tabindex="-1"></a>Analysis2 <span class="ot">&lt;-</span> <span class="cf">function</span>(magnetic){</span>
<span id="cb115-5"><a href="#cb115-5" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb115-6"><a href="#cb115-6" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">choose</span>(n, <span class="dv">2</span>)</span>
<span id="cb115-7"><a href="#cb115-7" tabindex="-1"></a>  e1 <span class="ot">&lt;-</span><span class="fu">numeric</span>(N);e2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N);e3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N);e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N);e5 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb115-8"><a href="#cb115-8" tabindex="-1"></a>  ij <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb115-9"><a href="#cb115-9" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) <span class="cf">for</span> (j <span class="cf">in</span> (i <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb115-10"><a href="#cb115-10" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">c</span>(i, j); y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]; x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb115-11"><a href="#cb115-11" tabindex="-1"></a>     <span class="co"># Model1 experiment</span></span>
<span id="cb115-12"><a href="#cb115-12" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb115-13"><a href="#cb115-13" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb115-14"><a href="#cb115-14" tabindex="-1"></a>    e1[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb115-15"><a href="#cb115-15" tabindex="-1"></a>     <span class="co"># Model2 experiment</span></span>
<span id="cb115-16"><a href="#cb115-16" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb115-17"><a href="#cb115-17" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb115-18"><a href="#cb115-18" tabindex="-1"></a>      J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb115-19"><a href="#cb115-19" tabindex="-1"></a>    e2[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb115-20"><a href="#cb115-20" tabindex="-1"></a>     <span class="co"># Model3 experiment</span></span>
<span id="cb115-21"><a href="#cb115-21" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb115-22"><a href="#cb115-22" tabindex="-1"></a>    logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb115-23"><a href="#cb115-23" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb115-24"><a href="#cb115-24" tabindex="-1"></a>    e3[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb115-25"><a href="#cb115-25" tabindex="-1"></a>     <span class="co"># Model4 experiment</span></span>
<span id="cb115-26"><a href="#cb115-26" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb115-27"><a href="#cb115-27" tabindex="-1"></a>    logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[k])</span>
<span id="cb115-28"><a href="#cb115-28" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb115-29"><a href="#cb115-29" tabindex="-1"></a>    e4[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb115-30"><a href="#cb115-30" tabindex="-1"></a>    c2 <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span>;c3 <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb115-31"><a href="#cb115-31" tabindex="-1"></a>     <span class="co"># Model5 experiment</span></span>
<span id="cb115-32"><a href="#cb115-32" tabindex="-1"></a>    J5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> c2 <span class="sc">+</span> c3)</span>
<span id="cb115-33"><a href="#cb115-33" tabindex="-1"></a>    yhat5 <span class="ot">&lt;-</span> J5<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J5<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb115-34"><a href="#cb115-34" tabindex="-1"></a>      J5<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> J5<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb115-35"><a href="#cb115-35" tabindex="-1"></a>    e5[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat5)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb115-36"><a href="#cb115-36" tabindex="-1"></a>    ij <span class="ot">&lt;-</span> ij <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb115-37"><a href="#cb115-37" tabindex="-1"></a>  }</span>
<span id="cb115-38"><a href="#cb115-38" tabindex="-1"></a>  Result <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sum</span>(e1), <span class="fu">sum</span>(e2), <span class="fu">sum</span>(e3), <span class="fu">sum</span>(e4), <span class="fu">sum</span>(e5))<span class="sc">/</span>N</span>
<span id="cb115-39"><a href="#cb115-39" tabindex="-1"></a>  <span class="fu">return</span>(Result)</span>
<span id="cb115-40"><a href="#cb115-40" tabindex="-1"></a>}</span>
<span id="cb115-41"><a href="#cb115-41" tabindex="-1"></a></span>
<span id="cb115-42"><a href="#cb115-42" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">Analysis2</span>(magnetic)</span>
<span id="cb115-43"><a href="#cb115-43" tabindex="-1"></a>Res</span></code></pre></div>
<pre><code>## [1] 39.14455 35.74037 36.90983 40.93436 36.46996</code></pre>
<p>The leave-two-out cross-validation results indicate that the
quadratic model, specifically model (2), yields the lowest prediction
error. Consequently, based on the leave-two-out cross-validation, the
quadratic model is the preferred choice.</p>
<p><a href="#directory">Back to the Directory</a></p>
</div>
<div id="question7ans" class="section level1">
<h1>Homework6</h1>
</div>
<div id="question-3" class="section level1">
<h1>Question</h1>
<p>Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
</div>
<div id="answer-3" class="section level1">
<h1>Answer</h1>
<p>To prove stationarity, we need to show that the Markov chain is
reversible with respect to <span class="math inline">\(f(s)\)</span>,
i.e., the detailed balance condition is satisfied:</p>
<p><span class="math display">\[ f(s)K(s , r) = f(r)K(r , s)
\]</span></p>
<p>Where <span class="math inline">\(K(s , r)\)</span> is the transition
probability from state <span class="math inline">\(s\)</span> to state
<span class="math inline">\(r\)</span>.</p>
<p>we have proposal distribution which is <span class="math inline">\(g(r|s)\)</span> and acceptance probablity which is
<span class="math inline">\(\alpha(s, r)\)</span>.</p>
<p>Thus, <span class="math inline">\(K(r,s)=\alpha(r,s)g(s|r)+I(s=r)[1-\int
\alpha(r,s)g(s|r)]\)</span>.</p>
<p>Now,if <span class="math inline">\(I(s=r)=0\)</span>, let’s compute
the left-hand side of the detailed balance condition: <span class="math display">\[ f(s)K(s , r) = f(s)g(r|s)\alpha(s, r) \]</span>
<span class="math display">\[ = f(s)g(r|s)\min\left(1,
\frac{f(r)g(s|r)}{f(s)g(r|s)}\right) \]</span></p>
<p>For the right-hand side: <span class="math display">\[ f(r)K(r , s) =
f(r)g(s|r)\alpha(r, s) \]</span> <span class="math display">\[ =
f(r)g(s|r)\min\left(1, \frac{f(s)g(r|s)}{f(r)g(s|r)}\right)
\]</span></p>
<p>When <span class="math inline">\(\frac{f(r)g(s|r)}{f(s)g(r|s)} =
1\)</span>, both sides return 1, satisfying the detailed balance
condition. Then,if <span class="math inline">\(I(s=r)=1\)</span>: <span class="math display">\[I(s=r)[1-\int \alpha(r,s)g(s|r)]=0 \]</span> in
this case, it’s clear that what we want is true . Thus, the
Metropolis-Hastings algorithm generates a Markov chain that is
stationary with respect to the target distribution <span class="math inline">\(f(s)\)</span>, ensuring that the samples drawn
from the chain converge to the desired distribution in the continuous
setting.</p>
</div>
<div id="question-ex-8.1" class="section level1">
<h1>Question EX 8.1</h1>
<p>Implement the two-sample Cramer-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
</div>
<div id="answer-ex-8.1" class="section level1">
<h1>Answer EX 8.1</h1>
<p>use the two sample Cramer-von Mises test as a permutation test to
chickwts dataset</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a>cvm_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">R =</span> <span class="dv">999</span>) {</span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb117-3"><a href="#cb117-3" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb117-4"><a href="#cb117-4" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb117-5"><a href="#cb117-5" tabindex="-1"></a>  N <span class="ot">&lt;-</span> n <span class="sc">+</span> m</span>
<span id="cb117-6"><a href="#cb117-6" tabindex="-1"></a>  </span>
<span id="cb117-7"><a href="#cb117-7" tabindex="-1"></a>  <span class="co"># Compute empirical CDFs</span></span>
<span id="cb117-8"><a href="#cb117-8" tabindex="-1"></a>  Fn <span class="ot">&lt;-</span> <span class="fu">sapply</span>(z, <span class="cf">function</span>(zi) <span class="fu">mean</span>(zi <span class="sc">&lt;=</span> x))</span>
<span id="cb117-9"><a href="#cb117-9" tabindex="-1"></a>  Gm <span class="ot">&lt;-</span> <span class="fu">sapply</span>(z, <span class="cf">function</span>(zi) <span class="fu">mean</span>(zi <span class="sc">&lt;=</span> y))</span>
<span id="cb117-10"><a href="#cb117-10" tabindex="-1"></a>  </span>
<span id="cb117-11"><a href="#cb117-11" tabindex="-1"></a>  cvm0 <span class="ot">&lt;-</span> ((n <span class="sc">*</span> m) <span class="sc">/</span> N) <span class="sc">*</span> <span class="fu">sum</span>((Fn <span class="sc">-</span> Gm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb117-12"><a href="#cb117-12" tabindex="-1"></a>  </span>
<span id="cb117-13"><a href="#cb117-13" tabindex="-1"></a>  <span class="co"># Permutation test</span></span>
<span id="cb117-14"><a href="#cb117-14" tabindex="-1"></a>  cvm <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, {</span>
<span id="cb117-15"><a href="#cb117-15" tabindex="-1"></a>    Z <span class="ot">&lt;-</span> <span class="fu">sample</span>(z)</span>
<span id="cb117-16"><a href="#cb117-16" tabindex="-1"></a>    X <span class="ot">&lt;-</span> Z[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb117-17"><a href="#cb117-17" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> Z[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb117-18"><a href="#cb117-18" tabindex="-1"></a>    </span>
<span id="cb117-19"><a href="#cb117-19" tabindex="-1"></a>    Fn_perm <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Z, <span class="cf">function</span>(zi) <span class="fu">mean</span>(zi <span class="sc">&lt;=</span> X))</span>
<span id="cb117-20"><a href="#cb117-20" tabindex="-1"></a>    Gm_perm <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Z, <span class="cf">function</span>(zi) <span class="fu">mean</span>(zi <span class="sc">&lt;=</span> Y))</span>
<span id="cb117-21"><a href="#cb117-21" tabindex="-1"></a>    </span>
<span id="cb117-22"><a href="#cb117-22" tabindex="-1"></a>    ((n <span class="sc">*</span> m) <span class="sc">/</span> N) <span class="sc">*</span> <span class="fu">sum</span>((Fn_perm <span class="sc">-</span> Gm_perm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb117-23"><a href="#cb117-23" tabindex="-1"></a>  })</span>
<span id="cb117-24"><a href="#cb117-24" tabindex="-1"></a>  </span>
<span id="cb117-25"><a href="#cb117-25" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(cvm, cvm0) <span class="sc">&gt;=</span> cvm0)</span>
<span id="cb117-26"><a href="#cb117-26" tabindex="-1"></a>  </span>
<span id="cb117-27"><a href="#cb117-27" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">statistic =</span> cvm0, <span class="at">p.value =</span> p_value))</span>
<span id="cb117-28"><a href="#cb117-28" tabindex="-1"></a>}</span>
<span id="cb117-29"><a href="#cb117-29" tabindex="-1"></a></span>
<span id="cb117-30"><a href="#cb117-30" tabindex="-1"></a></span>
<span id="cb117-31"><a href="#cb117-31" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]</span>
<span id="cb117-32"><a href="#cb117-32" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;sunflower&quot;</span>]</span>
<span id="cb117-33"><a href="#cb117-33" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]</span>
<span id="cb117-34"><a href="#cb117-34" tabindex="-1"></a></span>
<span id="cb117-35"><a href="#cb117-35" tabindex="-1"></a><span class="co"># show the result</span></span>
<span id="cb117-36"><a href="#cb117-36" tabindex="-1"></a>cvm_test_result <span class="ot">&lt;-</span> <span class="fu">cvm_test</span>(x1, x3)</span>
<span id="cb117-37"><a href="#cb117-37" tabindex="-1"></a><span class="fu">print</span>(cvm_test_result)</span></code></pre></div>
<pre><code>## $statistic
## [1] 4.228022
## 
## $p.value
## [1] 0.377</code></pre>
<p>According to the p-value above , there is no enough evidence to
believe that there exists a difference between the distributions.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a>cvm_test_result2 <span class="ot">&lt;-</span> <span class="fu">cvm_test</span>(x2, x3)</span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a><span class="fu">print</span>(cvm_test_result2)</span></code></pre></div>
<pre><code>## $statistic
## [1] 36.5
## 
## $p.value
## [1] 0.001</code></pre>
<p>According to the p-value above , we have a strong evidence to believe
that there exists a difference between the distributions.</p>
</div>
<div id="question-ex-8.3" class="section level1">
<h1>Question EX 8.3</h1>
<p>The Count 5 test for equal variances in Section 6.4 is based on the
maximum number of extreme points. Example 6.15 shows that the Count 5
criterion is not applicable for unequal sample sizes. Implement a
permutation test for equal variance based on the maximum number of
extreme points that applies when sample sizes are not necessarily
equal.</p>
</div>
<div id="answer-ex-8.3" class="section level1">
<h1>Answer EX 8.3</h1>
<p>create sample data satisfy that the sample sizes are not equal but
the variances are equal. Then apply the permutation test.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="co"># sample data</span></span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">60</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb121-4"><a href="#cb121-4" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" tabindex="-1"></a>count5_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">R =</span> <span class="dv">10000</span>) {</span>
<span id="cb121-6"><a href="#cb121-6" tabindex="-1"></a>  <span class="co"># Helper function to compute the number of extreme points</span></span>
<span id="cb121-7"><a href="#cb121-7" tabindex="-1"></a>  extremepoints_count <span class="ot">&lt;-</span> <span class="cf">function</span>(sample, combined_sample) {</span>
<span id="cb121-8"><a href="#cb121-8" tabindex="-1"></a>    sorted_combined <span class="ot">&lt;-</span> <span class="fu">sort</span>(combined_sample)</span>
<span id="cb121-9"><a href="#cb121-9" tabindex="-1"></a>    <span class="co"># Define the extreme values as the 5 smallest and 5 largest values from the combined sample</span></span>
<span id="cb121-10"><a href="#cb121-10" tabindex="-1"></a>    extremes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">head</span>(sorted_combined, <span class="dv">5</span>), <span class="fu">tail</span>(sorted_combined, <span class="dv">5</span>))</span>
<span id="cb121-11"><a href="#cb121-11" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(sample <span class="sc">%in%</span> extremes))</span>
<span id="cb121-12"><a href="#cb121-12" tabindex="-1"></a>  }</span>
<span id="cb121-13"><a href="#cb121-13" tabindex="-1"></a>  </span>
<span id="cb121-14"><a href="#cb121-14" tabindex="-1"></a>  <span class="co"># Combine the samples</span></span>
<span id="cb121-15"><a href="#cb121-15" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb121-16"><a href="#cb121-16" tabindex="-1"></a>  </span>
<span id="cb121-17"><a href="#cb121-17" tabindex="-1"></a>  <span class="co"># Compute observed test statistic as the difference in number of extreme points</span></span>
<span id="cb121-18"><a href="#cb121-18" tabindex="-1"></a>  T_obs <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">extremepoints_count</span>(x, combined) <span class="sc">-</span> <span class="fu">extremepoints_count</span>(y, combined))</span>
<span id="cb121-19"><a href="#cb121-19" tabindex="-1"></a>  </span>
<span id="cb121-20"><a href="#cb121-20" tabindex="-1"></a>  <span class="co"># Permutation test</span></span>
<span id="cb121-21"><a href="#cb121-21" tabindex="-1"></a>  T_permuted <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb121-22"><a href="#cb121-22" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb121-23"><a href="#cb121-23" tabindex="-1"></a>    permuted <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined)</span>
<span id="cb121-24"><a href="#cb121-24" tabindex="-1"></a>    x_perm <span class="ot">&lt;-</span> permuted[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)]</span>
<span id="cb121-25"><a href="#cb121-25" tabindex="-1"></a>    y_perm <span class="ot">&lt;-</span> permuted[(<span class="fu">length</span>(x) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(combined)]</span>
<span id="cb121-26"><a href="#cb121-26" tabindex="-1"></a>    T_permuted[i] <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">extremepoints_count</span>(x_perm, combined) <span class="sc">-</span> <span class="fu">extremepoints_count</span>(y_perm, combined))</span>
<span id="cb121-27"><a href="#cb121-27" tabindex="-1"></a>  }</span>
<span id="cb121-28"><a href="#cb121-28" tabindex="-1"></a>  </span>
<span id="cb121-29"><a href="#cb121-29" tabindex="-1"></a>  <span class="co"># Compute p-value</span></span>
<span id="cb121-30"><a href="#cb121-30" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(T_permuted <span class="sc">&gt;=</span> T_obs)</span>
<span id="cb121-31"><a href="#cb121-31" tabindex="-1"></a>  </span>
<span id="cb121-32"><a href="#cb121-32" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">statistic =</span> T_obs, <span class="at">p.value =</span> p_value))</span>
<span id="cb121-33"><a href="#cb121-33" tabindex="-1"></a>}</span>
<span id="cb121-34"><a href="#cb121-34" tabindex="-1"></a></span>
<span id="cb121-35"><a href="#cb121-35" tabindex="-1"></a></span>
<span id="cb121-36"><a href="#cb121-36" tabindex="-1"></a></span>
<span id="cb121-37"><a href="#cb121-37" tabindex="-1"></a><span class="co"># Running the test</span></span>
<span id="cb121-38"><a href="#cb121-38" tabindex="-1"></a>test_result <span class="ot">&lt;-</span> <span class="fu">count5_test</span>(x, y)</span>
<span id="cb121-39"><a href="#cb121-39" tabindex="-1"></a><span class="fu">print</span>(test_result)</span></code></pre></div>
<pre><code>## $statistic
## [1] 2
## 
## $p.value
## [1] 0.7582</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a>test_result2 <span class="ot">&lt;-</span> <span class="fu">count5_test</span>(x2, y2)</span>
<span id="cb123-4"><a href="#cb123-4" tabindex="-1"></a><span class="fu">print</span>(test_result2)</span></code></pre></div>
<pre><code>## $statistic
## [1] 0
## 
## $p.value
## [1] 1</code></pre>
<p>when variances are equal , the result above is not significant <a href="#directory">Back to the Directory</a></p>
</div>
<div id="question8ans" class="section level1">
<h1>Homework7</h1>
</div>
<div id="question-1-2" class="section level1">
<h1>Question 1</h1>
<p>Consider a model <span class="math inline">\(P\left(Y=1 \mid X_1,
X_2, X_3\right)=\frac{\exp \left(a+b_1 X_1+b_2 X_2+b_3
X_3\right)}{1+\exp \left(a+b_1 X_1+b_2 X_2+b_3 X_3\right)}\)</span>,
where <span class="math inline">\(X_1 \sim P(1), X_2 \sim
\operatorname{Exp}(1)\)</span> and <span class="math inline">\(X_3 \sim
B(1,0.5)\)</span>.</p>
<p>1.Design a function that takes as input values <span class="math inline">\(N, b_1, b_2, b_3\)</span> and <span class="math inline">\(f_0\)</span>, and produces the output <span class="math inline">\(a\)</span>. 2.Call this function, input values are
<span class="math inline">\(N=10^6, b_1=0, b_2=1, b_3=-1,
f_0=0.1,0.01,0.001,0.0001\)</span>. 3.Plot <span class="math inline">\(-\log f_0\)</span> vs <span class="math inline">\(a\)</span>.</p>
</div>
<div id="answer-1-2" class="section level1">
<h1>Answer 1</h1>
<p>1.Design the function according to the information provided above</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" tabindex="-1"></a>out_a <span class="ot">&lt;-</span> <span class="cf">function</span>(b1, b2, b3, f0) {</span>
<span id="cb125-5"><a href="#cb125-5" tabindex="-1"></a>   equation <span class="ot">&lt;-</span> <span class="cf">function</span>(a) {</span>
<span id="cb125-6"><a href="#cb125-6" tabindex="-1"></a>    f0 <span class="sc">-</span> <span class="fu">exp</span>(a <span class="sc">+</span> b1 <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> b2 <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> b3 <span class="sc">*</span> (<span class="fl">0.5</span>)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(a <span class="sc">+</span> b1 <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> b2 <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> b3 <span class="sc">*</span> (<span class="fl">0.5</span>)))</span>
<span id="cb125-7"><a href="#cb125-7" tabindex="-1"></a>  }</span>
<span id="cb125-8"><a href="#cb125-8" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(equation, <span class="at">lower =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">upper =</span> <span class="dv">10</span>)<span class="sc">$</span>root</span>
<span id="cb125-9"><a href="#cb125-9" tabindex="-1"></a>  <span class="fu">return</span>(a)</span>
<span id="cb125-10"><a href="#cb125-10" tabindex="-1"></a>}</span></code></pre></div>
<p>2.call this function</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span></span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb126-4"><a href="#cb126-4" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb126-5"><a href="#cb126-5" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>)</span>
<span id="cb126-6"><a href="#cb126-6" tabindex="-1"></a></span>
<span id="cb126-7"><a href="#cb126-7" tabindex="-1"></a></span>
<span id="cb126-8"><a href="#cb126-8" tabindex="-1"></a>a_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(f0, out_a, <span class="at">b1=</span>b1, <span class="at">b2=</span>b2, <span class="at">b3=</span>b3)</span>
<span id="cb126-9"><a href="#cb126-9" tabindex="-1"></a></span>
<span id="cb126-10"><a href="#cb126-10" tabindex="-1"></a></span>
<span id="cb126-11"><a href="#cb126-11" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> a_values, <span class="at">log_f0 =</span> <span class="sc">-</span><span class="fu">log</span>(f0))</span></code></pre></div>
<p>3.plot <span class="math inline">\(-\log f_0\)</span> vs <span class="math inline">\(a\)</span></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> a, <span class="at">y =</span> log_f0)) <span class="sc">+</span></span>
<span id="cb127-2"><a href="#cb127-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb127-3"><a href="#cb127-3" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb127-4"><a href="#cb127-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;-log(f0) vs a&quot;</span>, <span class="at">x =</span> <span class="st">&quot;a&quot;</span>, <span class="at">y =</span> <span class="st">&quot;-log(f0)&quot;</span>) <span class="sc">+</span></span>
<span id="cb127-5"><a href="#cb127-5" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The plot of <span class="math inline">\(-\log f_0\)</span> vs <span class="math inline">\(a\)</span> shows a linear relationship , which is
expected given the exponential properties of the logical function.</p>
</div>
<div id="question-ex-9.4" class="section level1">
<h1>Question EX 9.4</h1>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
</div>
<div id="answer-ex-9.4" class="section level1">
<h1>Answer EX 9.4</h1>
<p>The laplace distribution has pdf <span class="math display">\[f(x)=\frac{1}{2}e^{|x|},x\in R\]</span>and<span class="math display">\[r(x_t,y)=\frac{f(y)}{f(x_t)}=\frac{e^{-{|y|}}}{e^{-|x_t|}}=e^{|x_t|-|y|}\]</span></p>
<p>We take the proposal distribution as <span class="math inline">\(N(X_t,\sigma^2)\)</span>,<span class="math inline">\(\sigma\)</span> takes valoe from {0.5,1,2,5}</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">194</span>) </span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>laplace_pdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x)))</span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a>}</span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a></span>
<span id="cb128-6"><a href="#cb128-6" tabindex="-1"></a><span class="co"># Random walk Metropolis sampler</span></span>
<span id="cb128-7"><a href="#cb128-7" tabindex="-1"></a>rwm_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma) {</span>
<span id="cb128-8"><a href="#cb128-8" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)  </span>
<span id="cb128-9"><a href="#cb128-9" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>        <span class="co"># Start at 0</span></span>
<span id="cb128-10"><a href="#cb128-10" tabindex="-1"></a>  accept <span class="ot">&lt;-</span> <span class="dv">0</span>      </span>
<span id="cb128-11"><a href="#cb128-11" tabindex="-1"></a>  </span>
<span id="cb128-12"><a href="#cb128-12" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb128-13"><a href="#cb128-13" tabindex="-1"></a>    current_x <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb128-14"><a href="#cb128-14" tabindex="-1"></a>    proposed_x <span class="ot">&lt;-</span> current_x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma)</span>
<span id="cb128-15"><a href="#cb128-15" tabindex="-1"></a>    </span>
<span id="cb128-16"><a href="#cb128-16" tabindex="-1"></a>    <span class="co"># Calculate acceptance ratio</span></span>
<span id="cb128-17"><a href="#cb128-17" tabindex="-1"></a>    acceptance_ratio <span class="ot">&lt;-</span> <span class="fu">laplace_pdf</span>(proposed_x) <span class="sc">/</span> <span class="fu">laplace_pdf</span>(current_x)</span>
<span id="cb128-18"><a href="#cb128-18" tabindex="-1"></a>    </span>
<span id="cb128-19"><a href="#cb128-19" tabindex="-1"></a>    <span class="co"># Accept or reject the proposal</span></span>
<span id="cb128-20"><a href="#cb128-20" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> acceptance_ratio) {</span>
<span id="cb128-21"><a href="#cb128-21" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> proposed_x</span>
<span id="cb128-22"><a href="#cb128-22" tabindex="-1"></a>      accept <span class="ot">&lt;-</span> accept <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb128-23"><a href="#cb128-23" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb128-24"><a href="#cb128-24" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> current_x</span>
<span id="cb128-25"><a href="#cb128-25" tabindex="-1"></a>    }</span>
<span id="cb128-26"><a href="#cb128-26" tabindex="-1"></a>  }</span>
<span id="cb128-27"><a href="#cb128-27" tabindex="-1"></a>  </span>
<span id="cb128-28"><a href="#cb128-28" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">samples =</span> x, <span class="at">acceptance_rate =</span> accept <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb128-29"><a href="#cb128-29" tabindex="-1"></a>}</span>
<span id="cb128-30"><a href="#cb128-30" tabindex="-1"></a></span>
<span id="cb128-31"><a href="#cb128-31" tabindex="-1"></a></span>
<span id="cb128-32"><a href="#cb128-32" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb128-33"><a href="#cb128-33" tabindex="-1"></a></span>
<span id="cb128-34"><a href="#cb128-34" tabindex="-1"></a>sigmas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>,<span class="dv">5</span>)</span>
<span id="cb128-35"><a href="#cb128-35" tabindex="-1"></a></span>
<span id="cb128-36"><a href="#cb128-36" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sigmas, <span class="cf">function</span>(sigma) <span class="fu">rwm_sampler</span>(n_samples, sigma))</span>
<span id="cb128-37"><a href="#cb128-37" tabindex="-1"></a></span>
<span id="cb128-38"><a href="#cb128-38" tabindex="-1"></a><span class="co"># Output the acceptance rates for each sigma</span></span>
<span id="cb128-39"><a href="#cb128-39" tabindex="-1"></a>acceptance_rates <span class="ot">&lt;-</span> <span class="fu">sapply</span>(results, <span class="cf">function</span>(result) result<span class="sc">$</span>acceptance_rate)</span>
<span id="cb128-40"><a href="#cb128-40" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">lapply</span>(results, <span class="cf">function</span>(result) result<span class="sc">$</span>samples)</span>
<span id="cb128-41"><a href="#cb128-41" tabindex="-1"></a></span>
<span id="cb128-42"><a href="#cb128-42" tabindex="-1"></a><span class="co"># Plotting the chains for each variance</span></span>
<span id="cb128-43"><a href="#cb128-43" tabindex="-1"></a><span class="co">#par(mfrow = c(length(sigmas), 1))  # Set up the plot area</span></span>
<span id="cb128-44"><a href="#cb128-44" tabindex="-1"></a><span class="co">#for (i in seq_along(sigmas)) {</span></span>
<span id="cb128-45"><a href="#cb128-45" tabindex="-1"></a><span class="co">#  plot(results[[i]]$samples, type = &#39;l&#39;, main = paste(&quot;Chain with sigma =&quot;, sigmas[i]),</span></span>
<span id="cb128-46"><a href="#cb128-46" tabindex="-1"></a><span class="co">#       xlab = &quot;Iteration&quot;, ylab = &quot;Value&quot;)</span></span></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a><span class="co"># Plot chains and histograms</span></span>
<span id="cb129-2"><a href="#cb129-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fu">length</span>(sigmas)))</span></code></pre></div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a>chain <span class="ot">&lt;-</span> chains[[<span class="dv">1</span>]]</span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a>  sigma_value <span class="ot">&lt;-</span> sigmas[<span class="dv">1</span>]</span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a>  <span class="co"># Chain plot</span></span>
<span id="cb130-4"><a href="#cb130-4" tabindex="-1"></a>  <span class="fu">plot</span>(chain, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Chain with sd =&quot;</span>, sigma_value))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a>  <span class="co"># Histogram</span></span>
<span id="cb131-2"><a href="#cb131-2" tabindex="-1"></a>  <span class="fu">hist</span>(chain, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Histogram with sigma =&quot;</span>, sigma_value))</span>
<span id="cb131-3"><a href="#cb131-3" tabindex="-1"></a>  <span class="fu">curve</span>(laplace_pdf, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a>chain <span class="ot">&lt;-</span> chains[[<span class="dv">2</span>]]</span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a>  sigma_value <span class="ot">&lt;-</span> sigmas[<span class="dv">2</span>]</span>
<span id="cb132-3"><a href="#cb132-3" tabindex="-1"></a>  <span class="co"># Chain plot</span></span>
<span id="cb132-4"><a href="#cb132-4" tabindex="-1"></a>  <span class="fu">plot</span>(chain, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Chain with sd =&quot;</span>, sigma_value))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a>  <span class="co"># Histogram</span></span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a>  <span class="fu">hist</span>(chain, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Histogram with sigma =&quot;</span>, sigma_value))</span>
<span id="cb133-3"><a href="#cb133-3" tabindex="-1"></a>  <span class="fu">curve</span>(laplace_pdf, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a>chain <span class="ot">&lt;-</span> chains[[<span class="dv">3</span>]]</span>
<span id="cb134-2"><a href="#cb134-2" tabindex="-1"></a>  sigma_value <span class="ot">&lt;-</span> sigmas[<span class="dv">3</span>]</span>
<span id="cb134-3"><a href="#cb134-3" tabindex="-1"></a>  <span class="co"># Chain plot</span></span>
<span id="cb134-4"><a href="#cb134-4" tabindex="-1"></a>  <span class="fu">plot</span>(chain, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Chain with sd =&quot;</span>, sigma_value))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAvVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6OmY6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZmZmkLZmtrZmtttmtv+QOgCQOjqQZgCQZjqQkGaQkLaQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb2//b/9vb////tmb/25D/27b//7b//9v///9Nk6blAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKvklEQVR4nO3dj3vjNh0G8O917Uhhg63ZBizHGGM0x4+DhjFo7hL9/38WlmTJP6XXluXEbt/3ee6axJJsfSrZTuO6opho5NobsPQQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgkLmAzj99JiKfv9ePD/LmsafEW7l7hs3YQue/PoWaaWQvN0+BRR+/8dszKjMBnb4WmweVAejj1zdTgY73ZnNgC53MA1T0y2U3qGfx2H5PASo26OZRfbgf8D1pZR6gg8jtD8WwLpyKLSp69pd3xSume//RY+vzRzc4GsuU7qLuwt7AHkW+1YX2GvrmqV1UqX8X0/jNb8y0Ob+7L1bpgT7cl9+f0vT0zf1GRadgKLMA6e+X2ZDzH774r+ES20fT6XK7HVCjI8Xy4tFpa+Zm0Z1/NYCqZkwO1XM/ZANAZZYCVHRwU3tadOTuvf7/QXfkF8968x8qoNtymUmxaGe6t9EFNraQm2K+Gb+WZ/WTeV64b57P7wDQYqaYAahyMBOm6I998ee/f1b23wLtTIVSVKuYoXHzpK1aQPVmdKXbf5SrsCWKZbERogfmbmxfLgOkv492WJ3/aL+zFVC1rCys59Sn2zePh6K3TaBmUTutPvndc8mqwBT6uJXxA+hCU8z3THfq9k8/b8NAxU7ox63eOT/o/XUMqDj621n0Z/9icCddvjTeZ/adtD7G1Hpmx9YpAlQ8/PW9Hj6fbv2OKgBUEH2vT0edYxQo0edSh3nXs6Pb5TyEgPQhvlhwrB/qgkBFzt/phe19UAfolDS/1CVPFN0IunvWbsERZE4ENq5D9ULtokXBL/VZti5hj2J7Ce6D9ok+s7/V+EJ19kHxnbT55u9MwY07mzy6E8Vm0Xe1QbJvnyQ140fUMs6DlH+zag7D7aPY7Q/VAaoLVLxux4sefLaQPsG5fd8tWntDfP7bvXzybfAo5k4ylwP0YkIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQSGYgWU2uBZS3uflCIBACgRDIp3+TCORDIBACgRAIhEAgBAIhUCDS+tq/dHAzmUKgvM3N6UmggW0TCLRNINA2gUDbBAJtS++KCESgoW0TCLRNIND2BYFOW33LEvtL7BmaG188qe1LAx30DQxO28BtZghU0hwC93nICjSBT64G9OHeAB2bk2z8B5ZD1r5KII6gSPQdWcwtR8rddVpzEnjcfXF1QMoYvXksDmQBnyFDIgPQoBJrPA+aDCSwRLXgNQCFuvWageQVAUn/K1LreBTInjVIa2mjWrO+NB6uE8joTAeS5vPus5cKJBEgUV4mAUhaW7M6IKktdi8lAEnvw8UDVds6A1BVZmYgdwe/0feJ629OLgPkJ6X0AfmVS3zsDerRfpJMp7k4kPgitQ2vAVkNqXFFgCQGJLmAgm+vRiURSIJAVY8qIBkOZBdKHqDRt1qONRcCEqlmme+cskMlAUjaQCV6HUgckEwCOr/dxMqNbc4ByVAggUCd+aLkkkDFW/QMQ6gJJL1A4oFkPJCr516r9V76gPz6GjMtbYpJ7qOY2zBV62QXqOx4Hch1tg+oYqppN4GkH0imAeWJ+9b6wV1NDIWApAHUGm3VK2WVFpB0gaSxvmUCNXpYA5IokHSBKppBQJVHbYVV1YUCNaPag6Lei36gyqMBVNWrl8sLVJwEZd0HNXrdD1RXiAJJGpC0gWQKULZMBepPF6iaSsFyoWYXAxTZctSHaDHV92LvK5mB3BzLNcVyJsExWCsZaH/3fNi4T04XBjQwswLpN6tHfRf+tL+u8BqAdurDr57Mv7UCtZIX6Pz2QZ2+eiRQCEgd9F+AeVj1FGsl92F+v0F/oOuVA+XICoBkTiD4g/1FAQWSCjTgU42Du+wleP3LSwbCn2roA52jil9hdm2DaBKBBnyqUfu5fvwaxet1fkiSgeB7jMEj6NoE8SQCDflU4+B+rg/2QdcmiCcRaNDbVPeOP3gy+VL3Qf7HibLMH3dkTQpQthDoNQPtzd+jnHYJQ26gOahTgfZmz3vaTvqI/gUDufOg49w76VF9ztBSzycISUDuLPBwbSAVfDK2pUCpRKDyLPDD/aSdUA4g91Gy6nw42momtJ74p2Ptfg8Gsn/ut/rz41mAeroQAVJTgDorrb40yyUD5UgTqPvpZ31rux+kR4G6H1m0gNoNu3bWDaRq/TB9tC4jgWxl1SypvE6jpWUAqRZQ7atqPIgCqRhQ/QopX7Hu5oHUWoBqlzU5heq15sDpB6oblUCqCVRJvWggVf0HgBQEUosHciPfbmoLSMWBlJ+BLSAlVYk+INUFUosDUgGgEiAJyLeVDDS23/MBuZ2EcwgDKQCkAJDqA1IeqFrbUoGUA1IQSA0FUgBIdYGUUqsCUr1ASjWB/PgDQOr1AvnaHsg1pVyLg4HUcoFUL5BqFA9sfA1I9QCpGpBqNt7YUTW+rhuo22YFVKvX7esAINWpNKxHuVIBqTCQL5kCVGuquc72s5UAVa+2NlFUu4vDgXrX2X62dqD6Y+ksabVZP+8JrbP97ApAY+5hlgAU2cRsQIFK8bUPzph7mI0CGrCVkaLLAhp6B6oLAoW34BpA/fcw6928/pVcB6hT/+ojKPhqItDgXBdIv2mceA+ziwGpywOp4D3M6j/oy7vC0ZWk/+mlgKY3l3mFqP1rANUuVUxobm6ggasjEFgdgcDqCARWRyCwuuUexS4cAoEQCIRAIARKDIFACARCIJCrAa0mVwIa1ihYPm3x1OrTiudplEDTlhOIQNOWE4hA05YTiEDTlr98oJcUAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAskPdEy5Q4q9u5Ov2n0QyUHE3r4wrTpIdqCjvkx47FYdzY0HfdXug0gO5rrkXWp1lNxA9vKz/bj7fJ22GshX7T6IrnATqpW0Le3kBrK/yzHyNlaHu+8KIF+1+yBS1wOlVYfJDvRLPaLH3QitqKP3Qb5q90GstptiidVRcgPZKT9q4uuZYG5R6Kp2H8RXaffEqdVBFgCkf3NoApC+D7a+89pKgMYPa1MjfYpVe5x1TLHxO8ZDeT3KLm0v64fJSnbSiYfWffJh3ioUw2Qlh/nEk7N9+omi2wet5ETRTJnUtxq+avdBrG4xPx/6ayVtSzN8swpCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgSwPqHO1wdTLD6aFQCAEAlkk0Gn7+629el5fv/K9BjrYa1z05WLBu33PkoUCFSb68l59cdRRyif6Kil90VjodvHzZKFAD+baOnt53b58wVyOebz551cXnXELBdqZv91hL1D1F/Qar71Mu+ZwbBYNdPBA7kpYZX9v5YJZNFBrBOmc3/522mW9Y7NooPJC5/IFk8Pd/yK3s54hiwYqf1GlPIrZvfVu6qXzI7NsoOZ5UAFjLzi/5G56eUALC4FACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAvk/uhxpx1CRPu8AAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a>  <span class="co"># Histogram</span></span>
<span id="cb135-2"><a href="#cb135-2" tabindex="-1"></a>  <span class="fu">hist</span>(chain, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Histogram with sigma =&quot;</span>, sigma_value))</span>
<span id="cb135-3"><a href="#cb135-3" tabindex="-1"></a>  <span class="fu">curve</span>(laplace_pdf, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAw1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkJBmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2ZpC2kGa225C229u22/+2/9u2///T09PbkDrbkGbbtmbbtpDb27bb29vb////AAD/tmb/25D/27b//7b//9v///+2dTyPAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALrElEQVR4nO2dC3ujuBmFT2ZntnbTy7bxzvQyzrbbm9le0jW7s42dOP7/v6q6IMA2AgkE33GG95nHSRjxfUfHQggQgONMK5AWwA6kBbADaQHsQFoAO5AWwA6kBbADaQHsQFoAO5AWwA6kBbADaQHsQFoAO5AWwA6kBbADaQHsQFoAO5AWwA6kBbADaQHsQFoAO5AWwA6kBbADaQHsQFoAO5AWwA6kBbADaQHsQFoAO5AWwA6kBbADaQHsQFoAO4gs/3KPd4/256L8o/bf//w+lbLzlCZ0jptNh7IhPH8A8MuH+iJEhmg36Pn9m7EMsqHHNWi/hOYkBSJjnBh0QYYRDKqHbjFoOKpObzbHp+WJ0YgPctGCfrhVrn/1oCuh0PX4pJrqF783aV6+A95uTPVU7f7yHm8ejp/e65asanpYYfHpFjcfjz8sVakiR2aiqmBr9aUCH3WWIrQK8Q8TsBRUJndbYpmvIXiZ2PBkG0zZZA4flovj+becwKDcZlFRnUHFEqP33ii4rRa/e9yXslQdLLfOWs3e/dedUfvfE4PKZJYquRVTy3cZvErcaFD5/Qw0yFEYpL+ox+OPrjrfH4tGmpslStPi8SVzvr17OP5PrfWzR13ornBBrYuPRflC+NqoNxkWtuZuE9MhqqK15LZYLd9F8FriFoOGb2JnBqmAb/9T/K+tRfEVZLZR6d+VVmvQuij4079udQC1XImxn5Vw0zpz861rr84MWptwVR1d8noxk68xeJHYj7Z1Xft7uEF2ie1xsqqt2w7V/e76IPNVvfzJBdAN4Fh8Vgapgnqb+nJ1s8nVeqcG3WzcCpUck9yJKfNdBq8Se3le4XRn2MOg8z7o+b1tp38rfHDyVWtfu9/rBulKvf32p5XfINUJ/X2lO+e7rKx0s0G15OX27vJdBK8lNjRsYnrR6WAhgUFK5Z9vbZ8c1IKsE4cWg9SCXy918/lyVXYuHoOq5N0tqJbYY9ClP8kGii/fVD2Ovw8ySvZmI3eddJNBZndo93ZqjQ6DXPKmPug0eC1xs0GH8+0riUEq7W/Ndmb2XDqXfy/mWtC7x+f7lj7I7I8XTq8bTOiVzw2qJW/ai120IJe4mezSnxQt6Lvqa9h3jIPKPqi9kzbf7doUXLiU+2IcdNaCquRN46DLPqitky5bVOKB4vFH3QmYQzwzjH0oRtJ/sCuoRb96uNiLvf1r3rijKbPY9qK3iaLmJvTlJlYmr42kbb7mvZhN3Fg3NwodZFBPsuFH2kL5kCaMF7VZ/8Z8gW2DM+Z8SBTHx77xcOeK8iFRHC/PH5bF4fY0pM6HVIFeK5AWwA6kBbADaQHsQFoAO5AWwA6kBbADaQHsQFoAO5AWwA6kBbADaQHsQFoAO5AWwA6kBbADaQHsQFoAO5AWwA6kBbADaQHsQFoAO5AWwA6kBbADaQHsoMc6T8t1d6HXAiLKlvNqzyZAvGoQU3hvJ6jMLcjLYaVnlUxj0M78EweR5bObzWxQKznuJjOIwSFEr/G0/GI2qJWXe0xjELBT+8sJUrUhnd+PMmi7224hLKNn/nzkcRBM67lig86jlCQJpwJulTmvyKDk4WaDuuJcqUFuMr+3B4oL56cwSH8kithbSUzh3N0ssK/uGhgQrgXbeK7NoJf70pbcM9M/Jlwb12nQYVUOEPeejSwmXBvXadDcgrrI3THG3Ad5cOcUvfcaxYXzc60GTRbOGbTdpYrYWwlnuNmgrjizQR1xZoM64swGdcRR/swGtcWZDeqI4wzaSp+3B2e42aCuOLNBHXFmg9rR/swGtUBo0PlDiwaGGwihQfbpMJ7TPH3CDYLSoGN/j5JfOGQ16Fg8vjBZuL5UBkHYIdT/0M+W0U/G6v9wInSWCIPRoOoRcL5LFlHhhkFo0GGV4plE6CwRBqNBX1t/BjSfYzKDduA1aNjMH3SWCILPoKzaUQ8aCmG4Ig2fQVULShRuGIwGUYWrGyQ81RWU4egMOqzuyjtV2DppCoPYws0GtaOnSPMZpDYz89KBQQ+JRWeJEE4MMjOmk4TtRZU60y84WByzttNmOYpXBviGk2hcGsuJQcJzYMrUen7dXtW+7VAjNy8E0Q5+pgZl+qnYfoPsFDxzNmREg+wtLHwGqW1L309oG0gzbhKn2hjHNMjNW2AzSA2E9GseWrqgchJntvgcDQrA2WLfAjE4XDPXbFA5zfXlfkSDdtszg0SneFSpO+/DiAvXPwSrQVmKe+TQWaI7BKlBeiAdzpidNK1BA+7UTXnhcLflNKh1Bx8frj+sBpnjjIThetNgkOT1Z7hfgk6YTXHHIatBIUxyx+EVGzTN/WK8Bpn3SWYtO/tJ7jjcocEgwWs/KH/b32xyfTTvd2iSFkRrkK593nKmRzPFHYe0BuntRxvUOnlhgjsOaQ1yLSgbdNYenSW6oDWo6IPyYcNFdJbo4Ox0tPy1H1S/mu1n4CwqdJbogNkginCzQe3sjrQG2R3U0JdvorNE69oXV3xKg8QcQvEzK66YDpxrj84SrWtfnK+nMWjvOueBz0jEMDG0BtXOlrVemw8M13vty7Ot5QwGCJ01s1lrR2CSs1z9Bm3FTivarAHH6THheq89G9RO06kg6ZNCMJ+zQV5gPjkMaj5OFT5ihflM9jB2DNFCbNDgKEkuHL5ig5KE8xynCh+QgSRc8fjf2SDvisWzSVsNknAIJOH8h2H14w2BGdOJE/YOF2KQyHA6ccLe4VqPMmaDgg2afjgNknDtRxmzQcEGTT5aBEe4rkH0525Q5yC6Nhia2CEwhPNd7GkcDE38tpbEufqEM1UONmjqOxMS5+oTLrh/dh+TDobico0yiTPaoEn39YgpPMokzvAdmMiuDBFlR5mCF7EDE+mpY9Kkn8SJne9iPE1PHZMmfQuK736qnnqizQwxhRNP4tz16X5qHdEkHiGqdMJJnLveW1fZEU1yvT5xhsBwu4GNp/wYvxVh+nC27aQxSLei3aguhdSogR53HNqaGHfSeFN+bAuXRtn3p4l4duFw1whGpznvORIGvWIgLYAdRJVOcm/9dYGYwt0Hq68PRJQNONRoyzQJsaq6ZUeUHTbNKiZT3zVG6FJjIg5sQbErXJ9BAQerqTL1XEPaoO6D1WSZ+q0hbtC0meLXmA0aYZXJI6bLFL/GbNAIq0weMV2m+DWu2qArBdIC2IG0AHYgLYAdSAtgB9IC2IG0AHYgLYAdSAtgB9IC2IG0AHYgLYAdSAtgB1Mlsmdrwx8Mso9+GlZshjCQOJ6Xp59HVVc/jmYf51BkhkAwQsxG4q6k2StMcU+iGfZIBB8YIWYjeVRl7WOM4p5EE5chFIwRtInsF4h4f6LdXOLaRFyGUJA6oAf91hdVh1D9tvuJ6oQiM4SCxPHaCW4SPQyKzBAK0obrIPgJaX02sbgMoSBtuCZq72gP3hP36aTjMoSCtOG82BoHN4keu/nIDKEgbTg/prLhXWiPgWJkhkCQOJ4f/bbkiP4hj3/wbmSGMJA64GsD0gLYgbQAdiAtgB1IC2AH0gLYgbQAdiAtgB1IC2AH0gLYgbQAdiAtgB1IC2AH0gLYgbQAdiAtgB1IC2AH0gLYgbQAdiAtgB1IC2AH0gLYgbQAdiAtgB1IC2AH0gLYgbQAdiAtwEftSSqeBdMAiaQhCPlxAaQF+JgN8pKb+fKH1e+WdjZLMatFO3ZY/XE1whSXNjBlsiDym41+a+dhpX7q3/W8KLtMG1QsnA5MmCsI90ZT8/NpuT58vbHT66xBdyPM02wFE+YKwlXf9EFFR7TXm5U1aD1174QJcwXhpqmWXqgu6c2/l7NBjvMWZP5+mg0qqfog64WZ17ufN7EKvZN6uV/UW9BhhbvZoBI3Dqr6oJtNdrOZDeIE0gLYgbQAdiAtgB1IC2AH0gLYgbQAdiAtgB1IC2AH0gLYgbQAdiAtgB1IC2AH0gLYgbQAdiAtgB1IC2AH0gLYgbQAdiAtgB1IC2AH0gLYgbQAdiAtgJ3/AylF1mxStoFrAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a>chain <span class="ot">&lt;-</span> chains[[<span class="dv">4</span>]]</span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a>  sigma_value <span class="ot">&lt;-</span> sigmas[<span class="dv">4</span>]</span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a>  <span class="co"># Chain plot</span></span>
<span id="cb136-4"><a href="#cb136-4" tabindex="-1"></a>  <span class="fu">plot</span>(chain, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Chain with sd =&quot;</span>, sigma_value))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a>  <span class="co"># Histogram</span></span>
<span id="cb137-2"><a href="#cb137-2" tabindex="-1"></a>  <span class="fu">hist</span>(chain, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Histogram with sigma =&quot;</span>, sigma_value))</span>
<span id="cb137-3"><a href="#cb137-3" tabindex="-1"></a>  <span class="fu">curve</span>(laplace_pdf, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Each of the chains appear to have converged to the target Laplace
distribution</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a>acceptance_rates</span></code></pre></div>
<pre><code>## [1] 0.8351835 0.6983698 0.5168517 0.2722272</code></pre>
<p>Accepting rates that is too large or too small is not optimal. From
this perspective, chain with <span class="math inline">\(\sigma=2\)</span> may be the best</p>
</div>
<div id="question-ex-9.7" class="section level1">
<h1>Question EX 9.7</h1>
<p>Implement a Gibbs sampler to generate a bivariate normal chain (Xt,
Yt) with zero means, unit standard deviations, and correlation 0.9. Plot
the generated sample after discarding a suitable burn-in sample. Fit a
simple linear regression model Y = β0 + β1X to the sample and check the
residuals of the model for normality and constant variance</p>
</div>
<div id="answer-ex-9.7" class="section level1">
<h1>Answer EX 9.7</h1>
<p>To implement a Gibbs sampler for generating a bivariate normal chain
<span class="math inline">\((X_t, Y_t)\)</span> with zero means, unit
standard deviations, and correlation <span class="math inline">\(\rho =
0.9\)</span>, we use the conditional distributions of the bivariate
normal distribution. If <span class="math inline">\((X, Y) \sim
\mathcal{N}(\mathbf{0}, \Sigma)\)</span>, where <span class="math display">\[
\Sigma = \begin{pmatrix}
1 &amp; \rho \\
\rho &amp; 1 \\
\end{pmatrix},
\]</span> then the conditional distributions are: <span class="math display">\[
X | Y = y \sim \mathcal{N}(\rho y, 1 - \rho^2)
\]</span> <span class="math display">\[
Y | X = x \sim \mathcal{N}(\rho x, 1 - \rho^2)
\]</span></p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility</span></span>
<span id="cb140-2"><a href="#cb140-2" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" tabindex="-1"></a><span class="co"># Parameters for the bivariate normal distribution</span></span>
<span id="cb140-4"><a href="#cb140-4" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb140-5"><a href="#cb140-5" tabindex="-1"></a>variance <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb140-6"><a href="#cb140-6" tabindex="-1"></a></span>
<span id="cb140-7"><a href="#cb140-7" tabindex="-1"></a><span class="co"># Gibbs sampler function</span></span>
<span id="cb140-8"><a href="#cb140-8" tabindex="-1"></a>gibbs_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(n, burn_in) {</span>
<span id="cb140-9"><a href="#cb140-9" tabindex="-1"></a> </span>
<span id="cb140-10"><a href="#cb140-10" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n <span class="sc">+</span> burn_in)</span>
<span id="cb140-11"><a href="#cb140-11" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb140-12"><a href="#cb140-12" tabindex="-1"></a>  </span>
<span id="cb140-13"><a href="#cb140-13" tabindex="-1"></a>  <span class="co"># Gibbs sampling</span></span>
<span id="cb140-14"><a href="#cb140-14" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n <span class="sc">+</span> burn_in)) {</span>
<span id="cb140-15"><a href="#cb140-15" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> rho <span class="sc">*</span> y[i <span class="sc">-</span> <span class="dv">1</span>], <span class="at">sd =</span> <span class="fu">sqrt</span>(variance))</span>
<span id="cb140-16"><a href="#cb140-16" tabindex="-1"></a>    y[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> rho <span class="sc">*</span> x[i], <span class="at">sd =</span> <span class="fu">sqrt</span>(variance))</span>
<span id="cb140-17"><a href="#cb140-17" tabindex="-1"></a>  }</span>
<span id="cb140-18"><a href="#cb140-18" tabindex="-1"></a>  </span>
<span id="cb140-19"><a href="#cb140-19" tabindex="-1"></a>  <span class="co"># Return the chain without the burn-in period</span></span>
<span id="cb140-20"><a href="#cb140-20" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">x =</span> x[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)], <span class="at">y =</span> y[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)])</span>
<span id="cb140-21"><a href="#cb140-21" tabindex="-1"></a>}</span>
<span id="cb140-22"><a href="#cb140-22" tabindex="-1"></a></span>
<span id="cb140-23"><a href="#cb140-23" tabindex="-1"></a></span>
<span id="cb140-24"><a href="#cb140-24" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb140-25"><a href="#cb140-25" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb140-26"><a href="#cb140-26" tabindex="-1"></a></span>
<span id="cb140-27"><a href="#cb140-27" tabindex="-1"></a></span>
<span id="cb140-28"><a href="#cb140-28" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n_samples, burn_in)</span>
<span id="cb140-29"><a href="#cb140-29" tabindex="-1"></a></span>
<span id="cb140-30"><a href="#cb140-30" tabindex="-1"></a><span class="co"># Plot the samples</span></span>
<span id="cb140-31"><a href="#cb140-31" tabindex="-1"></a><span class="fu">plot</span>(samples<span class="sc">$</span>x, samples<span class="sc">$</span>y, <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Bivariate Normal Samples&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a><span class="co"># Fit a simple linear regression model Y = β0 + β1X</span></span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> samples)</span></code></pre></div>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a>model<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>## (Intercept)           x 
## -0.00654134  0.90350836</code></pre>
<p>The linear model parameters are shown above. We can see that, <span class="math inline">\(\beta\)</span> is close to 0.9, indicating that
the coefficients of the fitted model match well with the parameters of
the target distribution.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a><span class="co"># Check the residuals of the model for normality and constant variance</span></span>
<span id="cb144-2"><a href="#cb144-2" tabindex="-1"></a><span class="co">#par(mfrow = c(2, 2))</span></span>
<span id="cb144-3"><a href="#cb144-3" tabindex="-1"></a><span class="fu">plot</span>(model)  </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>The sample has elliptical symmetry and is located at the origin of
the target binary normal distribution</p>
<p>The positive correlation is also evident in these graphs</p>
<p>The relationship between residual and fitting shows that the error
variance is constant relative to the response variable</p>
<p>The residual QQ diagram is consistent with the assumption of normal
error in the linear model.</p>
</div>
<div id="question-ex-9.10" class="section level1">
<h1>Question EX 9.10</h1>
<p>Refer to Example 9.1. Use the Gelman-Rubin method to monitor
convergence of the chain, and run the chain until the chain has
converged approximately to the target distribution according to <span class="math inline">\(\hat{R}\)</span> &lt; 1.2. (See Exercise 9.9.)
Also use the coda [212] package to check for convergence of the chain by
the Gelman-Rubin method. Hints: See the help topics for the coda
functions gelman.diag, gelman.plot, as.mcmc, and mcmc.list</p>
</div>
<div id="answer-ex-9.10" class="section level1">
<h1>Answer EX 9.10</h1>
<p>The Rayleigh distribution has the probability density function (PDF)
given by:</p>
<p><span class="math display">\[
f(x; \sigma) = \frac{x}{\sigma^2}
\exp\left(-\frac{x^2}{2\sigma^2}\right), \quad x &gt; 0
\]</span></p>
<p>where <span class="math inline">\(\sigma\)</span> is the scale
parameter of the distribution.We can use the Metropolis-Hastings
algorithm to generate samples from this distribution. The GR diagnostic
requires running multiple chains; it then compares the variance within
each chain to the variance between chains to assess convergence.</p>
<p>The Gelman-Rubin Method important equals:</p>
<p>The between-sequence variance is <span class="math display">\[
B=\frac{1}{k-1} \sum_{i=1}^k \sum_{j=1}^n\left(\bar{\psi}_{i
.}-\bar{\psi}_{. .}\right)^2=\frac{n}{k-1}
\sum_{i=1}^k\left(\bar{\psi}_{i .}-\bar{\psi}_{. .}\right)^2
\]</span> where <span class="math display">\[
\bar{\psi}_{i .}=(1 / n) \sum_{j=1}^n \psi_{i j}, \quad \bar{\psi}_{.
.}=(1 /(n k)) \sum_{i=1}^k \sum_{j=1}^n \psi_{i j} .
\]</span></p>
<p>Within the <span class="math inline">\(i^{\text {th }}\)</span>
sequence, the sample variance is <span class="math display">\[
s_i^2=\frac{1}{n} \sum_{j=1}^n\left(\psi_{i j}-\bar{\psi}_{i .}\right)^2
\]</span> and the pooled estimate of within sample variance is <span class="math display">\[
W=\frac{1}{n k-k} \sum_{i=1}^k(n-1) s_i^2=\frac{1}{k} \sum_{i=1}^k s_i^2
\]</span></p>
<p>The between-sequence and within-sequence estimates of variance are
combined to estimate an upper bound for <span class="math inline">\(\operatorname{Var}(\psi)\)</span> <span class="math display">\[
\widehat{\operatorname{Var}}(\psi)=\frac{n-1}{n} W+\frac{1}{n} B
\]</span> we plan:</p>
<p>1.Initialize three chains with different starting values.</p>
<p>2.For each chain, iterate the Metropolis-Hastings algorithm 10,000
times.</p>
<p>3.After the iterations, calculate the within-chain variance and the
between-chain variance.</p>
<p>4.Compute the Gelman-Rubin diagnostic &amp;$using these
variances.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb145-2"><a href="#cb145-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb145-3"><a href="#cb145-3" tabindex="-1"></a><span class="co"># Rayleigh PDF</span></span>
<span id="cb145-4"><a href="#cb145-4" tabindex="-1"></a>rayleigh_pdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">sigma =</span> <span class="dv">1</span>) {</span>
<span id="cb145-5"><a href="#cb145-5" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb145-6"><a href="#cb145-6" tabindex="-1"></a>    <span class="fu">return</span>((x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span> (x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb145-7"><a href="#cb145-7" tabindex="-1"></a>  } </span>
<span id="cb145-8"><a href="#cb145-8" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb145-9"><a href="#cb145-9" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb145-10"><a href="#cb145-10" tabindex="-1"></a>  }</span>
<span id="cb145-11"><a href="#cb145-11" tabindex="-1"></a>}</span>
<span id="cb145-12"><a href="#cb145-12" tabindex="-1"></a></span>
<span id="cb145-13"><a href="#cb145-13" tabindex="-1"></a><span class="co"># Metropolis-Hastings sampler</span></span>
<span id="cb145-14"><a href="#cb145-14" tabindex="-1"></a>MH <span class="ot">&lt;-</span> <span class="cf">function</span>(n, init, <span class="at">sigma =</span> <span class="dv">1</span>) {</span>
<span id="cb145-15"><a href="#cb145-15" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb145-16"><a href="#cb145-16" tabindex="-1"></a>  sample[<span class="dv">1</span>] <span class="ot">&lt;-</span> init</span>
<span id="cb145-17"><a href="#cb145-17" tabindex="-1"></a>  </span>
<span id="cb145-18"><a href="#cb145-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb145-19"><a href="#cb145-19" tabindex="-1"></a>    current <span class="ot">&lt;-</span> sample[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb145-20"><a href="#cb145-20" tabindex="-1"></a>    proposed <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> current, <span class="at">sd =</span> sigma))  <span class="co"># Proposal from a normal distribution</span></span>
<span id="cb145-21"><a href="#cb145-21" tabindex="-1"></a>    </span>
<span id="cb145-22"><a href="#cb145-22" tabindex="-1"></a>    <span class="co"># Acceptance probability</span></span>
<span id="cb145-23"><a href="#cb145-23" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>, <span class="fu">rayleigh_pdf</span>(proposed, sigma) <span class="sc">/</span> <span class="fu">rayleigh_pdf</span>(current, sigma))</span>
<span id="cb145-24"><a href="#cb145-24" tabindex="-1"></a>    </span>
<span id="cb145-25"><a href="#cb145-25" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> alpha) {</span>
<span id="cb145-26"><a href="#cb145-26" tabindex="-1"></a>      sample[i] <span class="ot">&lt;-</span> proposed</span>
<span id="cb145-27"><a href="#cb145-27" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb145-28"><a href="#cb145-28" tabindex="-1"></a>      sample[i] <span class="ot">&lt;-</span> current</span>
<span id="cb145-29"><a href="#cb145-29" tabindex="-1"></a>    }</span>
<span id="cb145-30"><a href="#cb145-30" tabindex="-1"></a>  }</span>
<span id="cb145-31"><a href="#cb145-31" tabindex="-1"></a>  </span>
<span id="cb145-32"><a href="#cb145-32" tabindex="-1"></a>  <span class="fu">return</span>(sample)</span>
<span id="cb145-33"><a href="#cb145-33" tabindex="-1"></a>}</span>
<span id="cb145-34"><a href="#cb145-34" tabindex="-1"></a></span>
<span id="cb145-35"><a href="#cb145-35" tabindex="-1"></a></span>
<span id="cb145-36"><a href="#cb145-36" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb145-37"><a href="#cb145-37" tabindex="-1"></a>n_chains <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb145-38"><a href="#cb145-38" tabindex="-1"></a></span>
<span id="cb145-39"><a href="#cb145-39" tabindex="-1"></a><span class="co"># Initialize </span></span>
<span id="cb145-40"><a href="#cb145-40" tabindex="-1"></a>init_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">2</span>)  <span class="co"># Different starting points for each chain</span></span>
<span id="cb145-41"><a href="#cb145-41" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">lapply</span>(init_values, <span class="cf">function</span>(init) <span class="fu">MH</span>(n_samples, init))</span></code></pre></div>
<p>1.Use the Gelman-Rubin method</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a><span class="co"># compute variances of each chain</span></span>
<span id="cb146-2"><a href="#cb146-2" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">sapply</span>(chains, var)</span>
<span id="cb146-3"><a href="#cb146-3" tabindex="-1"></a></span>
<span id="cb146-4"><a href="#cb146-4" tabindex="-1"></a><span class="co"># compute the variance between chains</span></span>
<span id="cb146-5"><a href="#cb146-5" tabindex="-1"></a>chain_means <span class="ot">&lt;-</span> <span class="fu">sapply</span>(chains, mean)</span>
<span id="cb146-6"><a href="#cb146-6" tabindex="-1"></a>mean_of_chain_means <span class="ot">&lt;-</span> <span class="fu">mean</span>(chain_means)</span>
<span id="cb146-7"><a href="#cb146-7" tabindex="-1"></a>B_over_n <span class="ot">&lt;-</span> <span class="fu">sum</span>((chain_means <span class="sc">-</span> mean_of_chain_means)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n_chains <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb146-8"><a href="#cb146-8" tabindex="-1"></a></span>
<span id="cb146-9"><a href="#cb146-9" tabindex="-1"></a><span class="co"># var est</span></span>
<span id="cb146-10"><a href="#cb146-10" tabindex="-1"></a>sigma_hat_squared <span class="ot">&lt;-</span> ((n_samples <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n_samples) <span class="sc">*</span> <span class="fu">mean</span>(W) <span class="sc">+</span> B_over_n</span>
<span id="cb146-11"><a href="#cb146-11" tabindex="-1"></a></span>
<span id="cb146-12"><a href="#cb146-12" tabindex="-1"></a><span class="co"># GR diagnostic index</span></span>
<span id="cb146-13"><a href="#cb146-13" tabindex="-1"></a>R_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sigma_hat_squared <span class="sc">/</span> <span class="fu">mean</span>(W))</span>
<span id="cb146-14"><a href="#cb146-14" tabindex="-1"></a></span>
<span id="cb146-15"><a href="#cb146-15" tabindex="-1"></a>R_hat</span></code></pre></div>
<pre><code>## [1] 1.000024</code></pre>
<p>2.use the coda package to check for convergence of the chain by the
Gelman-Rubin method</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a><span class="co"># Convert to mcmc objects and combine into a mcmc.list</span></span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a>mcmc_samples <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(<span class="fu">lapply</span>(chains, as.mcmc))</span>
<span id="cb148-3"><a href="#cb148-3" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" tabindex="-1"></a><span class="co"># Run the GR diagnostic</span></span>
<span id="cb148-5"><a href="#cb148-5" tabindex="-1"></a>gr_diag <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(mcmc_samples)</span>
<span id="cb148-6"><a href="#cb148-6" tabindex="-1"></a></span>
<span id="cb148-7"><a href="#cb148-7" tabindex="-1"></a><span class="co"># Check if the GR statistic is less than 1.2</span></span>
<span id="cb148-8"><a href="#cb148-8" tabindex="-1"></a>converg <span class="ot">&lt;-</span> <span class="fu">all</span>(gr_diag<span class="sc">$</span>psrf[<span class="dv">1</span>, ] <span class="sc">&lt;</span> <span class="fl">1.2</span>)</span>
<span id="cb148-9"><a href="#cb148-9" tabindex="-1"></a></span>
<span id="cb148-10"><a href="#cb148-10" tabindex="-1"></a><span class="co"># Plot GR diagnostic</span></span>
<span id="cb148-11"><a href="#cb148-11" tabindex="-1"></a><span class="fu">gelman.plot</span>(mcmc_samples)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmkJBmtrZmtv+QOgCQOjqQOmaQZgCQkGaQkNuQ2/+2ZgC225C2/7a2///bkDrb/7bb///fU2v/tmb/25D//7b//9v////oC493AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJxElEQVR4nO2dDbuaNhiGOa12066ebZ10ZS0q//9HLt8iGB4IAWL63NfVHhQIcBvefBCgaMggxdY7kDoUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAgQWVDxMmwlKG5yy0FBAAoCbCvoZ9xEl4CCABQEoCAABQFYigFWFjS9gro1zEGAjQWlH4SmC7q9H+JtN0dB1+Mp3nZzFNTUH75H226Ogq5HUw7N8pSxoJW3uzUUBAgRdNmLE+ztvM52F6R+O+MSJyRIF7Kcr4pZhVkKMage8yOH14Oqjz8CdqqTXI6CbK6cV9qvJeiy/yJK3YOMCnK3KxEc1O8rJt6+2lOsLNTc61Eu2zkxcs9Bl73IJpWsklTyn/hw2Yv9L8WHujCCyl2j5lyPctlOtnrJGDThOpbSYf47XY9yz0XWF9NiotSCrp/Pam6jZutZvR0dfUR6o69Tiqnjtf/poCMnVHholWK1PLXUh265lns96FGQyWSn6kGQiEcfvu2jCVI5sokUpBfnSQ5q7L4bQW6RyIKqKIKWjtIPgtzB60BTaUHKVh3rFCvv0XBWt9AmgnQRVZqyypZiOvOIw4mcg4LoFTbrClL1IJXz2/UgOX02RVpyQTr5/o4QQaWoItbzzrCsBZWqCn097lbZ7tZs3BZLnxltMb8gU6Uf6pbNWJBphan2jQclSDVmvR1SOccg3BaTgowaX5s/a0EQKci0in2Raj1Blf4xXTvM7KGc3qkfW/6Et3df38RiglLJQaXqAjrZHTNF7+WTPgFEQL29i+9qb5EcIMheGBsK0ub3MeF6ILmlBekdsD+TK1hsxpaixMzbn96AEVYPqna9jqXejhWqueOL5GuVYroBb5rx94KlauUkIcifgYLqQYemFr9IlC7XxTGCdOgpXaYvf9etbXWKHQYyUGBF8fLbd/UvnFmCfkoG/rYwHRtK0P18vx7lr1seTJAeyECBFUXZoo8kaOkgpIO0EtS9zGMDkchAIiKA4hbSqiiKpIT8SKfY8sWYKE7+VV00ZWePbRgVGajc9eYaglrzu8ZvXOIGgPjLuvUESVRu75WopqxXGejgq7Et0x90e0ct2XUFqdzeKnf1pFFS75p4gkSEHtWjqGpfOLlmcUGqavhQ1ivktUIVpFUGauKdYkL1uC7X+vl1xfWHAcvTXZsxtUT925Wu1VHpCm2sIF3B6DIpufRZudN++na3ZutO++T7O5YW5Ot3pKCxyVEQSi5xQwFB+h/99/ZXnFIsP0G6xl6zmPctWKvr/MWs64ZZCxq+4CWZ0lhNnaAgDS/MT2is5heDJJ6W1p3xjdXMBI04eTRIYa6CFtguBYHk8hN0e2d3x+CC5SwzU7e7NcE16bW2uzXhI8zCNvekyzXtIBRy4XBeI6O33dwE4VrixO3mJijqbeGS3ARF3y4FrZDcclAQIODKauwYlDYp5KCkg1D4SPt4281MUNTnBykyExT1+UGalA1tW1E0ieYlKOZ2X6As27gUS9/Qxj2KWQqK2aOo/+QVg+L2KKq/uQmKWQ9KPgtt3aOYoSB0I9RwKr0+6dQNLXXpefR2Uy/HNm/N3wcrppmLNhdkz7E09QQJkuV8VRSz7obqCUqWkIrixx+X/U7fD+ID1raLp5MJElYPkpfGhno9KjsEzTsW7ZmgJM+yMEGleS6hh1anI7pvvj2diSBxbsl7Yocej9OqbKMnL7SnnwraOnoHBeni7TxYn56Yg7qG2ko2z1XLFPPuMZ1jYlBXUFJ+lqoH2Rq3ty5Q+D89kbKhp+0rit1PTkY7+mxnKA1B6mO7B/9nNzibs299UQsJmlJR1B9F+75oZRQ3VRQPX9hHUEzamzksFaQnVBTdZyuoUwV4eov0aooWETS1mL9/KY+70LlGebFd18+3voakRQRNrCi2vhWKCj2hHbXn2KzU6nNbIR8llYMab16xcx7Gx8rph0rT5Ng0IqKtXFEsXo9FBE2tKCZMIvWgdKEgwNKC4JMXUmezHPQybCRoVKJom/NWn5n6zMWjJEpBFDQv0WwFjb6C/6sKGvHkhVGJ5ito7CCiX1fQyNsSf2FBURKloJygIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgPiC6pBXjuuXO7hV+xN+5PsKTs9XCtqVDtEFyddcdN+2g1dSV/vdqv0JP/rtxafAtTGxBekhMoM3fPS5HqUgt2p/Ymh7O99KQbvSI7Yg816raXflVR//FoLcqv0J/6pOUNDaI4guSL15aNpzQMQ6Mga5VfsTAyvbUyxsbUxsQf337UDkqaDeM21X7U8MbtG8LjNsbUgCguRwvnBB8g4l+ZLDVxE0PV+rNYJPsXvEeZFTbHpktO9dOgWFWZdNXiVIB5atZWgx79659irFfGDtrAyuKNoY9CoVRfcS5mnopoZbtT8xsGpR6EHJQWtD2FgFUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggCLCnr6ro76dJ9X+++hFrO8r/rwzeh9H+FlIasLan83sP9Bhxbn5SmPUBBgeUGlGQl/2ethZOYRcWKema70+JXr56/yiSB6cTXrP3W8tZl9/HI0Q+pVuu3PepjaTnz3x15/ZzbaX3AyiwuSI7zkUF01FKwuTvZX1vt+sjMPjXweeuMWd7PlEF/5mPTrUXxb6eE+eub9s1nj4L57TKW14HSWFnT9fNbj5Oxgyq4g/VYqMVdNuMXtbD2Orn47q9nm9TpuPff50Li/4rtOKoc57+VZIwbVhcoF2lBXkB4jJ4/KBhCzuP6nj8zONsu47GU+28Nvf/eQyozotLggER0+fJMHoB61fOoLsoNc9Qy7+KMgmRWHBH06uzQfNvoCgtQBugxeylPlWQ4yXzRu8Vk5qJdKwoJU6HEP1bE5oWnHoPs8M+y7Lp7GIL+geww6PW70BQTp37E4uIG57YNR06qAsVnLLS5ndUoxvyCVxu19185BJpXkBemhuKW6JUcPyi1dPchMV/qRaC4G6cXLXj1oQJCrB50eN5q6oBygIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIA/wMj0cCj4FQqbwAAAABJRU5ErkJggg==" /><!-- -->
gelman.plot shows the evolution of GR shrink factor as the number of
iterations increases.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" tabindex="-1"></a><span class="co"># Output the results</span></span>
<span id="cb149-2"><a href="#cb149-2" tabindex="-1"></a><span class="fu">list</span>(<span class="at">convergence_diagnostic =</span> gr_diag, <span class="at">converged =</span> converg)</span></code></pre></div>
<pre><code>## $convergence_diagnostic
## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]          1          1
## 
## 
## $converged
## [1] TRUE</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" tabindex="-1"></a>gr_diag<span class="sc">$</span>psrf</span></code></pre></div>
<pre><code>##      Point est. Upper C.I.
## [1,]   1.000289   1.001199</code></pre>
<p>Based on the results of the plot and table above, we used two methods
to control the convergence of the chain and ensure that R&lt;1.2. The
functions provided by the coda package also verified the accuracy of our
GR method</p>
<p><a href="#directory">Back to the Directory</a></p>
</div>
<div id="question9ans" class="section level1">
<h1>Homework8</h1>
</div>
<div id="question-4" class="section level1">
<h1>Question</h1>
<p>Define that <span class="math inline">\(X_1, \cdots , X_n \sim
\text{Exp}(\lambda)\)</span>. For some reason, we just know that <span class="math inline">\(X_i\)</span> falls in an interval <span class="math inline">\((u_i,v_i)\)</span>, where <span class="math inline">\(u_i\)</span> and <span class="math inline">\(v_i\)</span> are two non-random known constants,
and <span class="math inline">\(u_i&lt;v_i\)</span>. This type of data
is called interval deleted data.</p>
<ol style="list-style-type: decimal">
<li><p>Try to directly maximize the likelihood function of the observed
data and use EM algorithm to solve the MLE of <span class="math inline">\(\lambda\)</span>, and prove that the two are
equal.</p></li>
<li><p>Let the observation data of <span class="math inline">\((u_i,v_i)\)</span>, <span class="math inline">\(i=1, \cdots n\)</span> <span class="math inline">\((n=10)\)</span> be <span class="math inline">\((11,12),\)</span> <span class="math inline">\((8,9),\)</span> <span class="math inline">\((27,28),\)</span> <span class="math inline">\((13,14),\)</span> <span class="math inline">\((16,17),\)</span> <span class="math inline">\((0,1),\)</span> <span class="math inline">\((23,24),\)</span> <span class="math inline">\((10,11),\)</span> <span class="math inline">\((24,25),\)</span> <span class="math inline">\((2,3)\)</span>. Try to program the numerical
solutions of MLE of <span class="math inline">\(\lambda\)</span> of the
above two algorithms respectively.</p></li>
</ol>
<p>Hint: The likelihood function of the observed data is <span class="math inline">\(L(\lambda)=\prod_{i=1}^n P_{\lambda} (u_i \le X_i
\le v_i)\)</span>.</p>
</div>
<div id="answer-4" class="section level1">
<h1>Answer</h1>
<p><strong>Two Methods for Solving Maximum Likelihood Estimation
(MLE)</strong></p>
<ol style="list-style-type: decimal">
<li><strong>Maximization of the Log-Likelihood Function of Observational
Data</strong></li>
</ol>
<ul>
<li>The expression for the likelihood function of observational data is:
<span class="math display">\[
   L_o(\lambda) = \prod_{i=1}^n \left( e^{-\lambda u_i} - e^{-\lambda
v_i} \right)
   \]</span></li>
<li>The corresponding log-likelihood function is: <span class="math display">\[
   \ln L_o(\lambda) = \sum_{i=1}^n \ln \left( e^{-\lambda u_i} -
e^{-\lambda v_i} \right)
   \]</span></li>
<li>The expression for the score function <span class="math inline">\(S(\lambda)\)</span> derived after differentiation
is: <span class="math display">\[
   S(\lambda) = \sum_{i=1}^n \frac{v_i e^{-\lambda v_i} - u_i
e^{-\lambda u_i}}{e^{-\lambda v_i} - e^{-\lambda u_i}}
   \]</span></li>
<li>MLE <span class="math inline">\(\hat{\lambda}\)</span> satisfies
<span class="math inline">\(S(\hat{\lambda}) = 0\)</span>.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Using the EM Algorithm to Solve MLE</strong></li>
</ol>
<ul>
<li>The expression for the log-likelihood function of complete data is:
<span class="math display">\[
   \ln L_c(\lambda) = n \ln \lambda - \lambda \sum_{i=1}^n X_i
   \]</span></li>
<li>In the <strong>E Step</strong>, compute <span class="math inline">\(Q(\lambda, \hat{\lambda}^{(t)})\)</span>: <span class="math display">\[
   Q(\lambda, \hat{\lambda}^{(t)}) = n \ln \lambda - \lambda
\sum_{i=1}^n \left[ \frac{1}{\lambda} + \frac{u_i e^{-\lambda u_i} - v_i
e^{-\lambda v_i}}{e^{-\lambda u_i} - e^{-\lambda v_i}} \right]
   \]</span>
<ul>
<li>In the <strong>M Step</strong>, update <span class="math inline">\(\lambda\)</span> by maximizing <span class="math inline">\(Q(\lambda, \hat{\lambda}^{(t)})\)</span>, to
obtain <span class="math inline">\(\hat{\lambda}^{(t+1)}\)</span>: <span class="math display">\[
\hat{\lambda}^{(t+1)} = n \Bigg/ \sum_{i=1}^n  \left(
\frac{1}{\hat{\lambda}^{(t)}} + \frac{u_i e^{-\hat{\lambda}^{(t)} u_i} -
v_i e^{-\hat{\lambda}^{(t)} v_i}}{e^{-\hat{\lambda}^{(t)} u_i} -
e^{-\hat{\lambda}^{(t)} v_i}} \right)
\]</span></li>
</ul></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><strong>Equivalence of the Two Methods</strong>:</li>
</ol>
<ul>
<li>Verify that the estimators obtained by both methods are actually the
same, both satisfying: <span class="math display">\[
   \sum_{i=1}^{n} \frac{v_i e^{-\hat{\lambda} v_i} - u_i
e^{-\hat{\lambda} u_i}}{e^{-\hat{\lambda} v_i} - e^{-\hat{\lambda} u_i}}
= 0
   \]</span></li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li><strong>Linear Convergence Rate of the EM Algorithm</strong></li>
</ol>
<ul>
<li>The EM algorithm actually defines a mapping</li>
</ul>
<p><span class="math display">\[
  \hat{\lambda}^{(t+1)} = \phi(\hat{\lambda}^{(t)})
\]</span> When the EM algorithm converges, it converges to a fixed point
of this mapping. Hence, if <span class="math inline">\(\hat{\lambda} =
\phi(\hat\lambda),\)</span> then <span class="math inline">\(\hat{\lambda}^{(t+1)}-\hat{\lambda}=\phi&#39;(\hat{\lambda}^{(t)})(\hat{\lambda}^{(t)}-\hat{\lambda})\)</span>,
indicating that the EM algorithm has a linear convergence rate.</p>
<ol start="5" style="list-style-type: decimal">
<li><strong>Plotting the Score Function <span class="math inline">\(S(\lambda)\)</span></strong>:
<ul>
<li>Using R language to plot the function graph of <span class="math inline">\(S(\lambda)\)</span>, the code is as follows:</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb153-2"><a href="#cb153-2" tabindex="-1"></a>V <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb153-3"><a href="#cb153-3" tabindex="-1"></a></span>
<span id="cb153-4"><a href="#cb153-4" tabindex="-1"></a>fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb153-5"><a href="#cb153-5" tabindex="-1"></a>  <span class="fu">sapply</span>(x, <span class="cf">function</span>(lambda) {</span>
<span id="cb153-6"><a href="#cb153-6" tabindex="-1"></a>    <span class="fu">sum</span>((V <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> V) <span class="sc">-</span> U <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> U)) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> V) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> U)))</span>
<span id="cb153-7"><a href="#cb153-7" tabindex="-1"></a>  })</span>
<span id="cb153-8"><a href="#cb153-8" tabindex="-1"></a>}</span>
<span id="cb153-9"><a href="#cb153-9" tabindex="-1"></a></span>
<span id="cb153-10"><a href="#cb153-10" tabindex="-1"></a><span class="fu">curve</span>(fun, <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>)</span>
<span id="cb153-11"><a href="#cb153-11" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
As the plot above, the null point is in the interval (0,0.2).</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" tabindex="-1"></a>mle1<span class="ot">&lt;-</span> <span class="fu">uniroot</span>(fun, <span class="at">lower =</span> <span class="fl">0.001</span>, <span class="at">upper =</span> <span class="fl">0.2</span>)</span>
<span id="cb154-2"><a href="#cb154-2" tabindex="-1"></a>mle1</span></code></pre></div>
<pre><code>## $root
## [1] 0.07197499
## 
## $f.root
## [1] 0.002881906
## 
## $iter
## [1] 8
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05</code></pre>
<p>Hence, the MLE of <span class="math inline">\(\lambda\)</span>
obtained by maximizing the observed data log-likelihood function is
0.071975.</p>
<p>the EM algorithm is as follows</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb156-2"><a href="#cb156-2" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb156-3"><a href="#cb156-3" tabindex="-1"></a>V <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb156-4"><a href="#cb156-4" tabindex="-1"></a></span>
<span id="cb156-5"><a href="#cb156-5" tabindex="-1"></a>EM <span class="ot">&lt;-</span> <span class="cf">function</span>(U,V,<span class="at">max.it=</span><span class="dv">10000</span>,<span class="at">eps=</span><span class="fl">1e-8</span>){</span>
<span id="cb156-6"><a href="#cb156-6" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(U)</span>
<span id="cb156-7"><a href="#cb156-7" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb156-8"><a href="#cb156-8" tabindex="-1"></a>  theta1 <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb156-9"><a href="#cb156-9" tabindex="-1"></a>  theta2 <span class="ot">&lt;-</span> <span class="fl">0.02</span></span>
<span id="cb156-10"><a href="#cb156-10" tabindex="-1"></a>  <span class="cf">while</span>( <span class="fu">abs</span>(theta1 <span class="sc">-</span> theta2) <span class="sc">&gt;=</span> eps){</span>
<span id="cb156-11"><a href="#cb156-11" tabindex="-1"></a>    theta1 <span class="ot">&lt;-</span> theta2</span>
<span id="cb156-12"><a href="#cb156-12" tabindex="-1"></a>   fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb156-13"><a href="#cb156-13" tabindex="-1"></a>  <span class="fu">sapply</span>(x, <span class="cf">function</span>(lambda) {</span>
<span id="cb156-14"><a href="#cb156-14" tabindex="-1"></a>    <span class="fu">sum</span>((V <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> V) <span class="sc">-</span> U <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> U)) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> V) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> U)))</span>
<span id="cb156-15"><a href="#cb156-15" tabindex="-1"></a>  })</span>
<span id="cb156-16"><a href="#cb156-16" tabindex="-1"></a>}</span>
<span id="cb156-17"><a href="#cb156-17" tabindex="-1"></a>    su <span class="ot">&lt;-</span> <span class="fu">fun</span>(theta1)</span>
<span id="cb156-18"><a href="#cb156-18" tabindex="-1"></a>    theta2 <span class="ot">&lt;-</span> n<span class="sc">/</span>(n<span class="sc">/</span>theta1 <span class="sc">+</span> su)</span>
<span id="cb156-19"><a href="#cb156-19" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(theta2),<span class="dv">9</span>))</span>
<span id="cb156-20"><a href="#cb156-20" tabindex="-1"></a>    <span class="cf">if</span>(i <span class="sc">==</span> max.it) <span class="cf">break</span></span>
<span id="cb156-21"><a href="#cb156-21" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span>    </span>
<span id="cb156-22"><a href="#cb156-22" tabindex="-1"></a>  }</span>
<span id="cb156-23"><a href="#cb156-23" tabindex="-1"></a>  <span class="fu">return</span>(theta2)</span>
<span id="cb156-24"><a href="#cb156-24" tabindex="-1"></a> <span class="co">#return(i)</span></span>
<span id="cb156-25"><a href="#cb156-25" tabindex="-1"></a>}</span>
<span id="cb156-26"><a href="#cb156-26" tabindex="-1"></a></span>
<span id="cb156-27"><a href="#cb156-27" tabindex="-1"></a>mle2 <span class="ot">&lt;-</span> <span class="fu">EM</span>(U,V,<span class="at">max.it=</span><span class="dv">10000</span>,<span class="at">eps=</span><span class="fl">1e-5</span>)</span></code></pre></div>
<pre><code>## [1] 0.07195107
## [1] 0.07197349
## [1] 0.0719735</code></pre>
<p>Hence, the MLE of <span class="math inline">\(\lambda\)</span>
obtained by EM algorithm is 0.0719735.</p>
<p>The two estimates obtained by two method are are theoretically
equivalent and the two values are numerically close.</p>
<p>And we have proven that the EM algorithm converges at a linear
speed</p>
</div>
<div id="question-5" class="section level1">
<h1>Question</h1>
<p>In the Morra game, the set of optimal strategies are not changed if a
constant is subtracted from every entry of the payoff matrix, or a
positive constant is multiplied times every entry of the payoff matrix.
However, the simplex algorithm may terminate at a different basic
feasible point (also optimal). Compute B &lt;- A + 2, find the solution
of game B, and verify that it is one of the extreme points
(11.12)–(11.15) of the original game A. Also find the value of game A
and game B</p>
</div>
<div id="ansewr" class="section level1">
<h1>Ansewr</h1>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" tabindex="-1"></a>calculate_game_solution <span class="ot">&lt;-</span> <span class="cf">function</span>(input_matrix) {</span>
<span id="cb158-2"><a href="#cb158-2" tabindex="-1"></a>    <span class="co"># Normalize the input matrix</span></span>
<span id="cb158-3"><a href="#cb158-3" tabindex="-1"></a>    min_val <span class="ot">&lt;-</span> <span class="fu">min</span>(input_matrix)</span>
<span id="cb158-4"><a href="#cb158-4" tabindex="-1"></a>    norm_matrix <span class="ot">&lt;-</span> input_matrix <span class="sc">-</span> min_val</span>
<span id="cb158-5"><a href="#cb158-5" tabindex="-1"></a>    max_val <span class="ot">&lt;-</span> <span class="fu">max</span>(norm_matrix)</span>
<span id="cb158-6"><a href="#cb158-6" tabindex="-1"></a>    norm_matrix <span class="ot">&lt;-</span> norm_matrix <span class="sc">/</span> max_val</span>
<span id="cb158-7"><a href="#cb158-7" tabindex="-1"></a></span>
<span id="cb158-8"><a href="#cb158-8" tabindex="-1"></a>    <span class="co"># Set up parameters for simplex method</span></span>
<span id="cb158-9"><a href="#cb158-9" tabindex="-1"></a>    rows <span class="ot">&lt;-</span> <span class="fu">nrow</span>(norm_matrix)</span>
<span id="cb158-10"><a href="#cb158-10" tabindex="-1"></a>    cols <span class="ot">&lt;-</span> <span class="fu">ncol</span>(norm_matrix)</span>
<span id="cb158-11"><a href="#cb158-11" tabindex="-1"></a>    iterations <span class="ot">&lt;-</span> cols<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb158-12"><a href="#cb158-12" tabindex="-1"></a></span>
<span id="cb158-13"><a href="#cb158-13" tabindex="-1"></a>    <span class="co"># Set up for player X</span></span>
<span id="cb158-14"><a href="#cb158-14" tabindex="-1"></a>    objective_x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, rows), <span class="dv">1</span>)</span>
<span id="cb158-15"><a href="#cb158-15" tabindex="-1"></a>    constraint_x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(norm_matrix), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, cols))</span>
<span id="cb158-16"><a href="#cb158-16" tabindex="-1"></a>    boundary_x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, cols)</span>
<span id="cb158-17"><a href="#cb158-17" tabindex="-1"></a>    equality_x <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, rows), <span class="dv">0</span>)))</span>
<span id="cb158-18"><a href="#cb158-18" tabindex="-1"></a>    eq_boundary_x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb158-19"><a href="#cb158-19" tabindex="-1"></a></span>
<span id="cb158-20"><a href="#cb158-20" tabindex="-1"></a>    <span class="co"># Solve for player X</span></span>
<span id="cb158-21"><a href="#cb158-21" tabindex="-1"></a>    solution_x <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> objective_x, <span class="at">A1 =</span> constraint_x, <span class="at">b1 =</span> boundary_x, <span class="at">A3 =</span> equality_x, <span class="at">b3 =</span> eq_boundary_x,</span>
<span id="cb158-22"><a href="#cb158-22" tabindex="-1"></a>                          <span class="at">maxi =</span> <span class="cn">TRUE</span>, <span class="at">n.iter =</span> iterations)</span>
<span id="cb158-23"><a href="#cb158-23" tabindex="-1"></a></span>
<span id="cb158-24"><a href="#cb158-24" tabindex="-1"></a>    <span class="co"># Set up for player Y</span></span>
<span id="cb158-25"><a href="#cb158-25" tabindex="-1"></a>    objective_y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, cols), <span class="dv">1</span>)</span>
<span id="cb158-26"><a href="#cb158-26" tabindex="-1"></a>    constraint_y <span class="ot">&lt;-</span> <span class="fu">cbind</span>(norm_matrix, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, rows))</span>
<span id="cb158-27"><a href="#cb158-27" tabindex="-1"></a>    boundary_y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, rows)</span>
<span id="cb158-28"><a href="#cb158-28" tabindex="-1"></a>    equality_y <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, cols), <span class="dv">0</span>)))</span>
<span id="cb158-29"><a href="#cb158-29" tabindex="-1"></a>    eq_boundary_y <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb158-30"><a href="#cb158-30" tabindex="-1"></a></span>
<span id="cb158-31"><a href="#cb158-31" tabindex="-1"></a>    <span class="co"># Solve for player Y</span></span>
<span id="cb158-32"><a href="#cb158-32" tabindex="-1"></a>    solution_y <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> objective_y, <span class="at">A1 =</span> constraint_y, <span class="at">b1 =</span> boundary_y, <span class="at">A3 =</span> equality_y, <span class="at">b3 =</span> eq_boundary_y,</span>
<span id="cb158-33"><a href="#cb158-33" tabindex="-1"></a>                          <span class="at">maxi =</span> <span class="cn">FALSE</span>, <span class="at">n.iter =</span> iterations)</span>
<span id="cb158-34"><a href="#cb158-34" tabindex="-1"></a></span>
<span id="cb158-35"><a href="#cb158-35" tabindex="-1"></a>    <span class="co"># Construct the final solution</span></span>
<span id="cb158-36"><a href="#cb158-36" tabindex="-1"></a>    final_solution <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb158-37"><a href="#cb158-37" tabindex="-1"></a>        <span class="at">NormalizedMatrix =</span> norm_matrix <span class="sc">*</span> max_val <span class="sc">+</span> min_val,</span>
<span id="cb158-38"><a href="#cb158-38" tabindex="-1"></a>        <span class="at">StrategyX =</span> solution_x<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>rows],</span>
<span id="cb158-39"><a href="#cb158-39" tabindex="-1"></a>        <span class="at">StrategyY =</span> solution_y<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>cols],</span>
<span id="cb158-40"><a href="#cb158-40" tabindex="-1"></a>        <span class="at">GameValue =</span> solution_x<span class="sc">$</span>soln[rows <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">*</span> max_val <span class="sc">+</span> min_val</span>
<span id="cb158-41"><a href="#cb158-41" tabindex="-1"></a>    )</span>
<span id="cb158-42"><a href="#cb158-42" tabindex="-1"></a></span>
<span id="cb158-43"><a href="#cb158-43" tabindex="-1"></a>    <span class="fu">return</span>(final_solution)</span>
<span id="cb158-44"><a href="#cb158-44" tabindex="-1"></a>}</span>
<span id="cb158-45"><a href="#cb158-45" tabindex="-1"></a></span>
<span id="cb158-46"><a href="#cb158-46" tabindex="-1"></a><span class="co"># Sample data and library call</span></span>
<span id="cb158-47"><a href="#cb158-47" tabindex="-1"></a>game_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb158-48"><a href="#cb158-48" tabindex="-1"></a>                        <span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">3</span>,</span>
<span id="cb158-49"><a href="#cb158-49" tabindex="-1"></a>                        <span class="dv">0</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">5</span>,</span>
<span id="cb158-50"><a href="#cb158-50" tabindex="-1"></a>                        <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb158-51"><a href="#cb158-51" tabindex="-1"></a>                        <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>,</span>
<span id="cb158-52"><a href="#cb158-52" tabindex="-1"></a>                        <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">6</span>, <span class="sc">-</span><span class="dv">6</span>, <span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb158-53"><a href="#cb158-53" tabindex="-1"></a></span>
<span id="cb158-54"><a href="#cb158-54" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb158-55"><a href="#cb158-55" tabindex="-1"></a>adjusted_matrix <span class="ot">&lt;-</span> game_matrix <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb158-56"><a href="#cb158-56" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">calculate_game_solution</span>(adjusted_matrix)</span>
<span id="cb158-57"><a href="#cb158-57" tabindex="-1"></a><span class="fu">print</span>(solution<span class="sc">$</span>GameValue)</span></code></pre></div>
<pre><code>## x10 
##   2</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(solution<span class="sc">$</span>StrategyX, solution<span class="sc">$</span>StrategyY), <span class="dv">7</span>))</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(solution<span class="sc">$</span>StrategyX <span class="sc">*</span> <span class="dv">61</span>, <span class="dv">7</span>))</span></code></pre></div>
<pre><code>## x1 x2 x3 x4 x5 x6 x7 x8 x9 
##  0  0 25  0 20  0 16  0  0</code></pre>
<p>(0, 0, 5/12, 0, 4/12, 0, 3/12,0, 0), (11.12) (0, 0, 16/37, 0, 12/37,
0, 9/37, 0, 0), (11.13) (0, 0, 20/47, 0, 15/47, 0, 12/47, 0,0), (11.14)
(0, 0, 25/61, 0, 20/61, 0, 16/61, 0,0). (11.15)</p>
<p>The game’s value is v=2 with the original’s value is v=0, and the
simplex algorithm concludes at the extremal point presented in (11.15).
<a href="#directory">Back to the Directory</a></p>
</div>
<div id="question10ans" class="section level1">
<h1>Homework9</h1>
</div>
<div id="question-2.1.3-ex4" class="section level1">
<h1>Question 2.1.3 EX4</h1>
<p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work</p>
</div>
<div id="answer-5" class="section level1">
<h1>Answer</h1>
<p>The unlist() is specifically designed to flatten a list into an
atomic vector. as.vector() is used to convert an object into a specific
vector</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" tabindex="-1"></a><span class="fu">require</span>(graphics)</span>
<span id="cb164-2"><a href="#cb164-2" tabindex="-1"></a><span class="co"># create a list</span></span>
<span id="cb164-3"><a href="#cb164-3" tabindex="-1"></a>pts <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> cars[,<span class="dv">1</span>], <span class="at">y =</span> cars[,<span class="dv">2</span>])</span></code></pre></div>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" tabindex="-1"></a>vec_pts1 <span class="ot">&lt;-</span> <span class="fu">unlist</span>(pts)</span>
<span id="cb165-2"><a href="#cb165-2" tabindex="-1"></a><span class="fu">is</span>(vec_pts1)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot; &quot;vector&quot;</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" tabindex="-1"></a>vec_pts2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(pts)</span>
<span id="cb167-2"><a href="#cb167-2" tabindex="-1"></a><span class="fu">is</span>(vec_pts2)</span></code></pre></div>
<pre><code>## [1] &quot;list&quot;   &quot;vector&quot;</code></pre>
</div>
<div id="question-2.3.1-ex-1" class="section level1">
<h1>Question 2.3.1 EX 1</h1>
<p>What does dim() return when applied to a vector?</p>
</div>
<div id="answer-6" class="section level1">
<h1>Answer</h1>
<p>creat a vector x ,then apply the dim() to x;</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>)</span>
<span id="cb169-2"><a href="#cb169-2" tabindex="-1"></a><span class="fu">is.vector</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" tabindex="-1"></a><span class="fu">dim</span>(x)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>dim() return NULL when applied to a vector?</p>
</div>
<div id="question-2.3.1-ex-2" class="section level1">
<h1>Question 2.3.1 EX 2</h1>
<p>If is.matrix(x) is TRUE, what will is.array(x) return?</p>
</div>
<div id="answer-7" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb173-2"><a href="#cb173-2" tabindex="-1"></a><span class="fu">is.matrix</span>(m)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" tabindex="-1"></a><span class="fu">is.array</span>(m)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" tabindex="-1"></a>mdat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb177-2"><a href="#cb177-2" tabindex="-1"></a>               <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;row1&quot;</span>, <span class="st">&quot;row2&quot;</span>),</span>
<span id="cb177-3"><a href="#cb177-3" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="st">&quot;C.1&quot;</span>, <span class="st">&quot;C.2&quot;</span>, <span class="st">&quot;C.3&quot;</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" tabindex="-1"></a><span class="fu">is.matrix</span>(mdat)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" tabindex="-1"></a><span class="fu">is.array</span>(mdat)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>It was found that both the 1 * 10 matrix and the 2 * 3 matrix
is.array return true when is.matrix is true</p>
</div>
<div id="question-2.4.5-ex-2" class="section level1">
<h1>Question 2.4.5 EX 2</h1>
<p>What does as.matrix() do when applied to a data frame with columns of
different types?</p>
</div>
<div id="answer-8" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" tabindex="-1"></a>L3 <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb182-2"><a href="#cb182-2" tabindex="-1"></a>char <span class="ot">&lt;-</span> <span class="fu">sample</span>(L3, <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb182-3"><a href="#cb182-3" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">char =</span> char)</span>
<span id="cb182-4"><a href="#cb182-4" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>##    x  y char
## 1  1  1    B
## 2  1  2    C
## 3  1  3    A
## 4  1  4    A
## 5  1  5    C
## 6  1  6    B
## 7  1  7    B
## 8  1  8    A
## 9  1  9    B
## 10 1 10    A</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" tabindex="-1"></a>d_asmtrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(d)</span></code></pre></div>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb185-2"><a href="#cb185-2" tabindex="-1"></a>  <span class="at">Numeric =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb185-3"><a href="#cb185-3" tabindex="-1"></a>  <span class="at">Character =</span> <span class="fu">as.character</span>(<span class="fu">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;d&#39;</span>, <span class="st">&#39;e&#39;</span>)),</span>
<span id="cb185-4"><a href="#cb185-4" tabindex="-1"></a>  <span class="at">Boolean =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>),</span>
<span id="cb185-5"><a href="#cb185-5" tabindex="-1"></a>  <span class="at">Factor =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&#39;apple&#39;</span>, <span class="st">&#39;banana&#39;</span>, <span class="st">&#39;orange&#39;</span>, <span class="st">&#39;apple&#39;</span>, <span class="st">&#39;banana&#39;</span>))</span>
<span id="cb185-6"><a href="#cb185-6" tabindex="-1"></a>)</span>
<span id="cb185-7"><a href="#cb185-7" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##   Numeric Character Boolean Factor
## 1       1         a    TRUE  apple
## 2       2         b   FALSE banana
## 3       3         c    TRUE orange
## 4       4         d   FALSE  apple
## 5       5         e    TRUE banana</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" tabindex="-1"></a>df_asmtrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(df)</span></code></pre></div>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" tabindex="-1"></a><span class="fu">class</span>(d[,<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" tabindex="-1"></a><span class="fu">class</span>(df[,<span class="dv">3</span>])</span></code></pre></div>
<pre><code>## [1] &quot;logical&quot;</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" tabindex="-1"></a><span class="fu">class</span>(d_asmtrix[,<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" tabindex="-1"></a><span class="fu">class</span>(df_asmtrix[,<span class="dv">3</span>])</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>we find that as.matrix() will coerce all columns into a single common
type following specific rules:</p>
</div>
<div id="question-2.4.5-ex-3" class="section level1">
<h1>Question 2.4.5 EX 3</h1>
<p>Can you have a data frame with 0 rows? What about 0 columns?</p>
</div>
<div id="answer-9" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">1</span>)</span>
<span id="cb196-2"><a href="#cb196-2" tabindex="-1"></a>d2</span></code></pre></div>
<pre><code>##   x y
## 1 1 1</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d2[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb198-2"><a href="#cb198-2" tabindex="-1"></a>d2</span></code></pre></div>
<pre><code>## [1] x y
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<p>here we have a data frame with 0 rows. 0 rows dataframe is often the
result of subsetting operations where no rows meet the criteria.</p>
</div>
<div id="question-p204-ex-2" class="section level1">
<h1>Question P204 EX 2</h1>
<p>The function below scales a vector so it falls in the range [0, 1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame? scale01 &lt;-
function(x) { rng &lt;- range(x, na.rm = TRUE) (x - rng[1]) / (rng[2] -
rng[1]) } # Answer</p>
<p>apply it to every column of a data frame</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb200-2"><a href="#cb200-2" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb200-3"><a href="#cb200-3" tabindex="-1"></a>(x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb200-4"><a href="#cb200-4" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">9</span>,<span class="dv">2</span>,<span class="dv">6</span>),<span class="at">z=</span><span class="fu">as.character</span>(<span class="fu">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;d&#39;</span>, <span class="st">&#39;e&#39;</span>)))</span>
<span id="cb201-2"><a href="#cb201-2" tabindex="-1"></a><span class="co">#df_scaled &lt;- data.frame(lapply(df, scale01))</span></span>
<span id="cb201-3"><a href="#cb201-3" tabindex="-1"></a><span class="co">#df_scaled</span></span></code></pre></div>
<p>cause errors if the columns are not numeric;</p>
<p>apply it to every numeric column in a data frame: first identify
which columns are numeric and then apply the function only to those
columns.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" tabindex="-1"></a>numeric_cols <span class="ot">&lt;-</span> <span class="fu">sapply</span>(df, is.numeric)</span>
<span id="cb202-2"><a href="#cb202-2" tabindex="-1"></a>df[, numeric_cols] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df[, numeric_cols], scale01)</span>
<span id="cb202-3"><a href="#cb202-3" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##      x         y z
## 1 0.00 0.7142857 a
## 2 0.25 0.1428571 b
## 3 0.50 1.0000000 c
## 4 0.75 0.0000000 d
## 5 1.00 0.5714286 e</code></pre>
</div>
<div id="question-p213-ex-1" class="section level1">
<h1>Question P213 EX 1</h1>
<p>Use vapply() to: a) Compute the standard deviation of every column in
a numeric data frame. b) Compute the standard deviation of every numeric
column in a mixed data frame. (Hint: you’ll need to use vapply()
twice.)</p>
</div>
<div id="answer-10" class="section level1">
<h1>Answer</h1>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>))</span>
<span id="cb204-2"><a href="#cb204-2" tabindex="-1"></a><span class="fu">vapply</span>(df, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        x        y 
## 1.290994 1.290994</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>first identifies the numeric columns in the data frame using
vapply() with the is_numeric function , then calculates the sd for each
of those numeric columns using vapply() with the sd function</li>
</ol>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" tabindex="-1"></a>df2<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">10</span>),<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">7</span>,<span class="dv">9</span>),<span class="at">z =</span> <span class="fu">as.character</span>(<span class="fu">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;d&#39;</span>, <span class="st">&#39;e&#39;</span>)))</span>
<span id="cb206-2"><a href="#cb206-2" tabindex="-1"></a>num_cols <span class="ot">&lt;-</span> <span class="fu">vapply</span>(df2,is.numeric,<span class="fu">logical</span>(<span class="dv">1</span>))</span>
<span id="cb206-3"><a href="#cb206-3" tabindex="-1"></a><span class="fu">vapply</span>(df2[num_cols], sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        x        y 
## 3.563706 2.588436</code></pre>
</div>
<div id="question-ex-9.8" class="section level1">
<h1>Question EX 9.8</h1>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[f(x, y) \propto C^x_ny^{x+a+1}(1-y)^{n-x+b-1} , x
= 0, 1, . . . , n, 0 ≤ y ≤ 1.\]</span> It can be shown (see e.g. [23])
that for fixed a, b, n, the conditional distributions are Binomial(n, y)
and Beta(x+ a, n − x+ b). Use the Gibbs sampler to generate a chain with
target joint density f(x, y). (Hint: Refer to the first example of Case
studies section) • Write an R function. • Write an Rcpp function. •
Compare the computation time of the two functions with the function
“microbenchmark” # Answer</p>
<p>Write an R function</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" tabindex="-1"></a>gibbs_sampler_R <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b, num_iterations) {</span>
<span id="cb208-2"><a href="#cb208-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iterations)</span>
<span id="cb208-3"><a href="#cb208-3" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iterations)</span>
<span id="cb208-4"><a href="#cb208-4" tabindex="-1"></a>  y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)  <span class="co"># Initial value for y</span></span>
<span id="cb208-5"><a href="#cb208-5" tabindex="-1"></a></span>
<span id="cb208-6"><a href="#cb208-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>num_iterations) {</span>
<span id="cb208-7"><a href="#cb208-7" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y[i<span class="dv">-1</span>])</span>
<span id="cb208-8"><a href="#cb208-8" tabindex="-1"></a>    y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x[i] <span class="sc">+</span> a, n <span class="sc">-</span> x[i] <span class="sc">+</span> b)</span>
<span id="cb208-9"><a href="#cb208-9" tabindex="-1"></a>  }</span>
<span id="cb208-10"><a href="#cb208-10" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(x, y))</span>
<span id="cb208-11"><a href="#cb208-11" tabindex="-1"></a>}</span></code></pre></div>
<p>Write an Rcpp function.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb209-2"><a href="#cb209-2" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb209-3"><a href="#cb209-3" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;</span></span>
<span id="cb209-4"><a href="#cb209-4" tabindex="-1"></a><span class="st">  DataFrame gibbs_sampler_Rcpp(int n, double a, double b, int num_iterations) {</span></span>
<span id="cb209-5"><a href="#cb209-5" tabindex="-1"></a><span class="st">    NumericVector x(num_iterations);</span></span>
<span id="cb209-6"><a href="#cb209-6" tabindex="-1"></a><span class="st">    NumericVector y(num_iterations);</span></span>
<span id="cb209-7"><a href="#cb209-7" tabindex="-1"></a><span class="st">    y[0] = R::runif(0, 1);  // Initial value for y</span></span>
<span id="cb209-8"><a href="#cb209-8" tabindex="-1"></a></span>
<span id="cb209-9"><a href="#cb209-9" tabindex="-1"></a><span class="st">    for(int i = 1; i &lt; num_iterations; i++) {</span></span>
<span id="cb209-10"><a href="#cb209-10" tabindex="-1"></a><span class="st">      x[i] = R::rbinom(n, y[i-1]);</span></span>
<span id="cb209-11"><a href="#cb209-11" tabindex="-1"></a><span class="st">      y[i] = R::rbeta(x[i] + a, n - x[i] + b);</span></span>
<span id="cb209-12"><a href="#cb209-12" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb209-13"><a href="#cb209-13" tabindex="-1"></a><span class="st">    return DataFrame::create(Named(&quot;x&quot;)=x, Named(&quot;y&quot;)=y);</span></span>
<span id="cb209-14"><a href="#cb209-14" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb209-15"><a href="#cb209-15" tabindex="-1"></a><span class="st">&#39;</span>)</span></code></pre></div>
<p>Compare the computation time of the two functions with the function
“microbenchmark”</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" tabindex="-1"></a><span class="co"># Define parameters</span></span>
<span id="cb210-2"><a href="#cb210-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>  <span class="co"># Set your desired values for n, a, b, and num_iterations</span></span>
<span id="cb210-3"><a href="#cb210-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb210-4"><a href="#cb210-4" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb210-5"><a href="#cb210-5" tabindex="-1"></a>num_iterations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb210-6"><a href="#cb210-6" tabindex="-1"></a></span>
<span id="cb210-7"><a href="#cb210-7" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">R=</span><span class="fu">gibbs_sampler_R</span>(n, a, b, num_iterations),<span class="at">Rcpp=</span><span class="fu">gibbs_sampler_Rcpp</span>(n, a, b, num_iterations),<span class="at">times=</span><span class="dv">10</span>)</span>
<span id="cb210-8"><a href="#cb210-8" tabindex="-1"></a><span class="fu">summary</span>(ts)</span></code></pre></div>
<pre><code>##   expr     min      lq     mean   median      uq     max neval
## 1    R 48.3291 51.7307 62.64946 59.98215 70.9078 86.3584    10
## 2 Rcpp  3.4496  4.0428  7.62529  4.91290 14.3681 15.3421    10</code></pre>
<p>The average execution time of the Rcpp/C++implementation
(gibbs_sampler_cpp) is significantly lower than that of the R
implementation (gibbs_sampler_R), indicating that the C++implementation
is faster.</p>
<p><a href="#directory">Back to the Directory</a></p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" tabindex="-1"></a><span class="co"># all packages used</span></span>
<span id="cb212-2"><a href="#cb212-2" tabindex="-1"></a><span class="co"># [1] &quot;library(knitr)&quot;                      </span></span>
<span id="cb212-3"><a href="#cb212-3" tabindex="-1"></a><span class="co">#[2] &quot;library(ggplot2)&quot;                    </span></span>
<span id="cb212-4"><a href="#cb212-4" tabindex="-1"></a><span class="co">#[3] &quot;library(DAAG)&quot;                       </span></span>
<span id="cb212-5"><a href="#cb212-5" tabindex="-1"></a><span class="co">#[4] &quot;library(boot)&quot;                       </span></span>
<span id="cb212-6"><a href="#cb212-6" tabindex="-1"></a><span class="co">#[5] &quot;library(bootstrap)&quot;                  </span></span>
<span id="cb212-7"><a href="#cb212-7" tabindex="-1"></a><span class="co">#[6] &quot;library(coda)&quot;                       </span></span>
<span id="cb212-8"><a href="#cb212-8" tabindex="-1"></a><span class="co">#[7] &quot;library(dplyr)&quot;                      </span></span>
<span id="cb212-9"><a href="#cb212-9" tabindex="-1"></a><span class="co">#[8] &quot;library(stats)&quot;                      </span></span>
<span id="cb212-10"><a href="#cb212-10" tabindex="-1"></a><span class="co">#[9] &quot;require(graphics)&quot;                   </span></span>
<span id="cb212-11"><a href="#cb212-11" tabindex="-1"></a><span class="co">#[10] &quot;library(Rcpp)&quot;                       </span></span>
<span id="cb212-12"><a href="#cb212-12" tabindex="-1"></a><span class="co">#[11] &quot;library(microbenchmark)&quot; </span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
